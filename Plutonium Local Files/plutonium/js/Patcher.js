const _0x52b028=_0x1c60;(function(_0x44833d,_0x36c208){const _0x71045b=_0x1c60,_0x46888d=_0x44833d();while(!![]){try{const _0x4214f3=-parseInt(_0x71045b(0x207))/0x1*(-parseInt(_0x71045b(0x208))/0x2)+parseInt(_0x71045b(0x1f8))/0x3*(parseInt(_0x71045b(0x215))/0x4)+-parseInt(_0x71045b(0x1f2))/0x5+-parseInt(_0x71045b(0x1f3))/0x6+-parseInt(_0x71045b(0x1ed))/0x7+-parseInt(_0x71045b(0x229))/0x8+-parseInt(_0x71045b(0x209))/0x9*(-parseInt(_0x71045b(0x237))/0xa);if(_0x4214f3===_0x36c208)break;else _0x46888d['push'](_0x46888d['shift']());}catch(_0x564a2b){_0x46888d['push'](_0x46888d['shift']());}}}(_0x5d84,0xb05f8));import{SharedConsts}from'../shared/SharedConsts.js';import{Consts}from'./Consts.js';import{Config}from'./Config.js';import{Patcher_Token}from'./PatcherToken.js';import{Patcher_TextEditor}from'./PatcherTextEditor.js';import{Patcher_ChatMessage}from'./PatcherChatMessage.js';import{Patcher_SettingsConfig}from'./PatcherSettingsConfig.js';function _0x5d84(){const _0x1ddf9b=['pGetUserString','2270312qFgOGy','_handleConfigUpdate_folderMaxDepth','handleFailedInitConfigApplication','journalEntries','name','isVersionNinePlus','forEach','contents','sceneId','deleteDialog','prepareData','actors','active','render','430frjsDe','error','FLAG_IFRAME_URL','isAddDeleteToSceneNavOptions','getFlag','isEnableIncreasedFolderDepth','_handleConfigUpdate','Set\x20URL','getJournalDirectoryEntryContext','Versions','isGM','2164897NkBqpM','close','SIDEBAR.Delete','startsWith','trim','5586935IhjvVb','300378ssJXpo','<i\x20class=\x22fas\x20fa-fw\x20fa-trash\x22></i>','findIndex','<i\x20class=\x22fas\x20fa-fw\x20fa-hammer\x22></i>','STR_SEE_CONSOLE','3ISuGcS','<iframe','copy','Set\x20as\x20Rivet\x20Target','init','setRivetTargetActor','Scene','entityId','handleConfigUpdate','nav','innerHeight','SCENES.Configure','push','values','data','379MYAZHX','3134IQzjCW','173115SqBKMY','instance','<i\x20class=\x22fas\x20fa-fw\x20fa-link\x22></i>','element','setFlag','MODULE_NAME','bind','innerWidth','isOwner','_handleConfigUpdate_folderMaxDepth_','collection','documentId','4247744BzrcMz','forceClose','scenes','FOLDER_MAX_DEPTH','CONST','_CONST_ORIGINAL','splice','_doPatchNavContextMenuOptions','get','_doPatchJournalContextMenuOptions','getSceneNavigationContext','isUseExtendedActiveEffectsParser','getCoreVersion','preInit','_doPatchActorContextMenuOptions','handleHookApplyActiveEffect','isBetterRolltablesActive','FOLDER_MAX_DEPTH__ORIGINAL','_FOLDER_MAX_DEPTH'];_0x5d84=function(){return _0x1ddf9b;};return _0x5d84();}import{Patcher_CanvasAnimation}from'./PatcherCanvasAnimation.js';function _0x1c60(_0x39e5be,_0x3b1926){const _0x5d8457=_0x5d84();return _0x1c60=function(_0x1c60ae,_0x420814){_0x1c60ae=_0x1c60ae-0x1eb;let _0x3a5dc7=_0x5d8457[_0x1c60ae];return _0x3a5dc7;},_0x1c60(_0x39e5be,_0x3b1926);}import{Patcher_Jquery}from'./PatcherJquery.js';import{Patcher_GameKeyboard}from'./PatcherGameKeyboard.js';import{Patcher_ActiveEffectConfig}from'./PatcherActiveEffectConfig.js';import{Patcher_Actor}from'./PatcherActor.js';import{Patcher_Drawing}from'./PatcherDrawing.js';import{JournalSheet_Plutonium}from'./PatcherJournalSheet.js';import{LGT,Util}from'./Util.js';import{Patcher_Item}from'./PatcherItem.js';import{Patcher_ModuleManagement}from'./PatcherModuleManagement.js';import{Patcher_Application}from'./PatcherApplication.js';import{UtilHooks}from'./UtilHooks.js';import{Patcher_RollData}from'./PatcherRollData.js';import{Patcher_ChatLog}from'./PatcherChatLog.js';import{UtilCompat}from'./UtilCompat.js';import{Patcher_ActorSheet}from'./PatcherActorSheet.js';import{Patcher_Notifications}from'./PatcherNotifications.js';import{Patcher_KeybindingsConfig}from'./PatcherKeybindingsConfig.js';class Patcher{static[_0x52b028(0x222)](){const _0x20c12b=_0x52b028;Patcher_ChatLog['preInit'](),Patcher_GameKeyboard[_0x20c12b(0x222)]();}static[_0x52b028(0x1fc)](){const _0x2103f8=_0x52b028;Patcher_Notifications[_0x2103f8(0x1fc)](),Hooks['on']('applyActiveEffect',Patcher_Actor[_0x2103f8(0x224)][_0x2103f8(0x20f)](Patcher_Actor)),this[_0x2103f8(0x21c)](),this['_doPatchActorContextMenuOptions'](),this[_0x2103f8(0x21e)](),Patcher_Application['init'](),Patcher_Token['init'](),Patcher_TextEditor[_0x2103f8(0x1fc)](),Patcher_ChatMessage[_0x2103f8(0x1fc)](),Patcher_SettingsConfig[_0x2103f8(0x1fc)](),Patcher_CanvasAnimation[_0x2103f8(0x1fc)](),Patcher_Jquery[_0x2103f8(0x1fc)](),Patcher_GameKeyboard[_0x2103f8(0x1fc)](),Patcher_ActiveEffectConfig[_0x2103f8(0x1fc)](),Patcher_Actor[_0x2103f8(0x1fc)](),Patcher_ActorSheet[_0x2103f8(0x1fc)](),Patcher_Item[_0x2103f8(0x1fc)](),Patcher_RollData['init'](),Patcher_ModuleManagement[_0x2103f8(0x1fc)](),Patcher_KeybindingsConfig['init'](),UtilHooks['on'](UtilHooks['HK_CONFIG_UPDATE'],_0x2fabdb=>this[_0x2103f8(0x23d)](_0x2fabdb)),this['_handleConfigUpdate']({'isInit':!![]}),this['_doInitActorData'](),Hooks['on']('canvasReady',()=>{const _0x51d6f6=_0x2103f8;Patcher_Drawing[_0x51d6f6(0x200)]();});}static['_handleConfigUpdate']({isInit:isInit=![],..._0x50d1f6}={}){const _0xddefaa=_0x52b028;this[_0xddefaa(0x22a)]({'isInit':isInit}),Patcher_Token[_0xddefaa(0x200)]({'isInit':isInit,..._0x50d1f6}),Patcher_Drawing[_0xddefaa(0x200)]({'isInit':isInit}),Patcher_ChatMessage[_0xddefaa(0x200)]({'isInit':isInit}),JournalSheet_Plutonium['handleConfigUpdate']({'isInit':isInit});if(ui[_0xddefaa(0x201)]?.[_0xddefaa(0x20c)])ui[_0xddefaa(0x201)][_0xddefaa(0x236)]();}static['_doInitActorData'](){const _0x46fb20=_0x52b028;if(!Config[_0x46fb20(0x21d)]('actor',_0x46fb20(0x220)))return;(CONFIG['Actor']['collection'][_0x46fb20(0x20a)][_0x46fb20(0x230)]||[])[_0x46fb20(0x22f)](_0x400b8c=>{const _0x2b21f0=_0x46fb20;try{_0x400b8c[_0x2b21f0(0x233)]();}catch(_0x2d8c43){const _0x1abe77='Failed\x20to\x20apply\x20custom\x20active\x20effect\x20parsing\x20to\x20actor\x20\x22'+_0x400b8c['id']+'\x22!';ui['notifications'][_0x2b21f0(0x238)](_0x1abe77+'\x20'+VeCt[_0x2b21f0(0x1f7)]),console[_0x2b21f0(0x238)](...LGT,_0x1abe77),console[_0x2b21f0(0x238)](_0x2d8c43);}});}static[_0x52b028(0x21c)](){const _0x549a24=_0x52b028;Hooks['on'](_0x549a24(0x21f),(_0x490217,_0x7e25dd)=>{const _0x563621=_0x549a24;if(!Config[_0x563621(0x21d)]('ui',_0x563621(0x23a)))return;const _0x2b650f=_0x7e25dd['findIndex'](_0x1b6589=>_0x1b6589[_0x563621(0x22d)]===_0x563621(0x203)),_0x51edfd={'name':_0x563621(0x1ef),'icon':_0x563621(0x1f4),'condition':_0x507cd0=>{const _0x2865b7=_0x563621,_0x3ab550=game[_0x2865b7(0x217)][_0x2865b7(0x21d)](_0x507cd0['data'](_0x2865b7(0x231)));return game['user'][_0x2865b7(0x1ec)]&&!_0x3ab550['data'][_0x2865b7(0x235)];},'callback':_0x15dd0d=>{const _0xbeb4c4=_0x563621,_0x4403dc=CONFIG[_0xbeb4c4(0x1fe)][_0xbeb4c4(0x213)][_0xbeb4c4(0x20a)]['get'](_0x15dd0d[_0xbeb4c4(0x206)](_0xbeb4c4(0x231)));if(!_0x4403dc)return;const {top:_0x352590,left:_0xdc3f41}=_0x15dd0d[0x0]['getBoundingClientRect']();return _0x4403dc[_0xbeb4c4(0x232)]({'top':Math['min'](_0x352590+0x46,window[_0xbeb4c4(0x202)]-0x15e),'left':Math['min'](_0xdc3f41,window[_0xbeb4c4(0x210)]-0x2d0)});}};if(~_0x2b650f)_0x7e25dd[_0x563621(0x21b)](_0x2b650f+0x1,0x0,_0x51edfd);else _0x7e25dd['push'](_0x51edfd);return _0x7e25dd;});}static[_0x52b028(0x223)](){Hooks['on']('getActorDirectoryEntryContext',(_0x58cbf4,_0x1f0ea8)=>{const _0x17fcd2=_0x1c60;return _0x1f0ea8[_0x17fcd2(0x204)]({'name':_0x17fcd2(0x1fb),'icon':_0x17fcd2(0x1f6),'condition':_0x40bd67=>{const _0x3e2ca6=_0x17fcd2,_0x3bcde4=ActorDirectory[_0x3e2ca6(0x213)][_0x3e2ca6(0x21d)](_0x40bd67[_0x3e2ca6(0x206)](Util[_0x3e2ca6(0x1eb)][_0x3e2ca6(0x221)]()[_0x3e2ca6(0x22e)]?_0x3e2ca6(0x214):_0x3e2ca6(0x1ff)));return _0x3bcde4[_0x3e2ca6(0x211)];},'callback':_0x19c700=>{const _0x2b6bbf=_0x17fcd2,_0x1cf933=ActorDirectory['collection'][_0x2b6bbf(0x21d)](_0x19c700[_0x2b6bbf(0x206)](Util[_0x2b6bbf(0x1eb)][_0x2b6bbf(0x221)]()[_0x2b6bbf(0x22e)]?_0x2b6bbf(0x214):_0x2b6bbf(0x1ff))),_0x595729=game[_0x2b6bbf(0x234)]['get'](_0x1cf933['id']);Config[_0x2b6bbf(0x1fd)](_0x595729);}}),_0x1f0ea8;});}static[_0x52b028(0x21e)](){const _0x19ec5a=_0x52b028;Hooks['on'](_0x19ec5a(0x23f),(_0x1b0821,_0x3b5a36)=>{const _0x35ae04=_0x19ec5a,_0x1fb2a4=_0x3b5a36[_0x35ae04(0x1f5)](_0x1f191d=>_0x1f191d[_0x35ae04(0x22d)]==='PERMISSION.Configure');if(!~_0x1fb2a4)return _0x3b5a36;return _0x3b5a36['splice'](_0x1fb2a4+0x1,0x0,{'name':_0x35ae04(0x23e),'icon':_0x35ae04(0x20b),'condition':_0x1a4f69=>{const _0x4e60d5=_0x35ae04;if(!Config[_0x4e60d5(0x21d)](_0x4e60d5(0x22c),'isEnableUrlEmbeds'))return![];const _0x24a6b4=JournalDirectory[_0x4e60d5(0x213)][_0x4e60d5(0x21d)](_0x1a4f69[_0x4e60d5(0x206)](Util[_0x4e60d5(0x1eb)][_0x4e60d5(0x221)]()[_0x4e60d5(0x22e)]?_0x4e60d5(0x214):_0x4e60d5(0x1ff)));return _0x24a6b4[_0x4e60d5(0x211)];},'callback':async _0x57f90e=>{const _0x51fbd8=_0x35ae04,_0x3e379c=JournalDirectory[_0x51fbd8(0x213)]['get'](_0x57f90e['data'](Util[_0x51fbd8(0x1eb)][_0x51fbd8(0x221)]()[_0x51fbd8(0x22e)]?_0x51fbd8(0x214):'entityId')),_0x10e516=await _0x3e379c[_0x51fbd8(0x23b)](SharedConsts[_0x51fbd8(0x20e)],Consts[_0x51fbd8(0x239)]);let _0x5e75db=await InputUiUtil[_0x51fbd8(0x228)]({'title':'Enter\x20iframe\x20or\x20URL','default':_0x10e516||''});if(_0x5e75db==null)return;Object[_0x51fbd8(0x205)](_0x3e379c['apps'])[_0x51fbd8(0x22f)](_0x311059=>{const _0xe735e2=_0x51fbd8;_0x311059[_0xe735e2(0x216)]?_0x311059['forceClose']():_0x311059[_0xe735e2(0x1ee)]();});if(!_0x5e75db)await _0x3e379c[_0x51fbd8(0x20d)](SharedConsts[_0x51fbd8(0x20e)],Consts['FLAG_IFRAME_URL'],'');else{_0x5e75db=_0x5e75db[_0x51fbd8(0x1f1)]();if(_0x5e75db[_0x51fbd8(0x1f0)](_0x51fbd8(0x1f9)))_0x5e75db=$(_0x5e75db)['attr']('src');!_0x5e75db&&(ui['notifications']['warn']('URL/iframe\x20\x22'+_0x5e75db+'\x22\x20was\x20not\x20valid!'),await _0x3e379c[_0x51fbd8(0x20d)](SharedConsts[_0x51fbd8(0x20e)],Consts['FLAG_IFRAME_URL'],'')),await _0x3e379c['setFlag'](SharedConsts[_0x51fbd8(0x20e)],Consts[_0x51fbd8(0x239)],_0x5e75db);}}}),_0x3b5a36;});}static[_0x52b028(0x22a)]({isInit:isInit=![]}={}){const _0x14b0e2=_0x52b028;try{return this[_0x14b0e2(0x212)]();}catch(_0x20936d){if(!isInit)throw _0x20936d;Config[_0x14b0e2(0x22b)]('ui',_0x14b0e2(0x23c),_0x20936d);}}static[_0x52b028(0x212)](){const _0x275539=_0x52b028;if(Patcher[_0x275539(0x21a)]==null)Patcher[_0x275539(0x21a)]=window[_0x275539(0x219)];if(Config['get']('ui',_0x275539(0x23c))&&!UtilCompat[_0x275539(0x225)]()){if(CONST[_0x275539(0x218)]>=Patcher[_0x275539(0x227)])return;window['CONST']=MiscUtil[_0x275539(0x1fa)](Patcher[_0x275539(0x21a)]),CONST[_0x275539(0x226)]=CONST[_0x275539(0x218)],CONST[_0x275539(0x218)]=Patcher[_0x275539(0x227)];}else window[_0x275539(0x219)]=Patcher[_0x275539(0x21a)];}}Patcher[_0x52b028(0x21a)]=null,Patcher[_0x52b028(0x227)]=0x9;export{Patcher};