const _0x51c4ca=_0x16bb;(function(_0x15c946,_0x3b7258){const _0x2009a0=_0x16bb,_0x105ad6=_0x15c946();while(!![]){try{const _0x136fed=-parseInt(_0x2009a0(0x14d))/0x1*(-parseInt(_0x2009a0(0x112))/0x2)+parseInt(_0x2009a0(0x12f))/0x3+-parseInt(_0x2009a0(0x159))/0x4*(-parseInt(_0x2009a0(0x15a))/0x5)+-parseInt(_0x2009a0(0x13f))/0x6+-parseInt(_0x2009a0(0x111))/0x7*(parseInt(_0x2009a0(0x13e))/0x8)+parseInt(_0x2009a0(0x142))/0x9+parseInt(_0x2009a0(0x10e))/0xa*(-parseInt(_0x2009a0(0x126))/0xb);if(_0x136fed===_0x3b7258)break;else _0x105ad6['push'](_0x105ad6['shift']());}catch(_0x42ff04){_0x105ad6['push'](_0x105ad6['shift']());}}}(_0x5243,0x89bd4));import{UtilApplications}from'./UtilApplications.js';import{Config}from'./Config.js';import{DataConverter}from'./DataConverter.js';import{Vetools}from'./Vetools.js';function _0x5243(){const _0x54f477=['render','_getFoundryDiceTagged','colLabels','pSerialAwaitMap','roll','map','pGetTableRollableTable','splitTagByPipe','_getHighestRoll','rows','_getTableDescription','row','_getRollRange','getTableGroupJournal','248jVWFkb','5148570ZLzRMh','_pGetSaveImagePath','now','5571945WZDnxu','SYM_AT','_isRollableTable','permission','walk','Only\x20one\x20of\x20\x22rangeExact\x22\x20and\x20\x22rangeLow/rangeHigh\x22\x20may\x20be\x20specified!','exact','stripTags','isAddPermission','<div>','getMaxTableRange','23TweWQY','getConvertedTagLinkEntries','importTable','_IMG_FALLBACK','getCleanEntityName','modules/','getCleanDiceString','_pGetTableRollableTable_pOtherTable','setFirstSection','<div>\x0a\x09\x09\x09\x09<p>The\x20following\x20tables\x20belong\x20to\x20this\x20group:</p>\x0a\x09\x09\x09\x09','isImportAsJournalEntry','getAutoConvertedTableRollMode','4sEdFqv','2582995lYxlcu','copy','range','TEXT','toLowerCase','\x0a\x09\x09\x09\x09</div>','max','pOptionallySaveImageToServerAndGetUrl','\x20|\x20','10AOtkaI','_isRollableTable_getEntriesTableRollMode','getWalker','111349zvavpd','27682vNakvx','type','_pGetResultText','getColRollType','trim','min','defaultPermission','RollTable[','cell','exec','length','flat','ROLL_COL_NONE','pGetTableResult','table','TABLE_RESULT_TYPES','pGetTableJournal','results','pGetWithDescriptionPlugins','get','3194257VXNwgu','slice','permissions','caption','name','[[/r\x20','replace','getNameWithSourcePart','icons/svg/d20-black.svg','2255196KnlLTr'];_0x5243=function(){return _0x54f477;};return _0x5243();}import{UtilDataConverter}from'./UtilDataConverter.js';import{SharedConsts}from'../shared/SharedConsts.js';class DataConverterTable extends DataConverter{static [_0x51c4ca(0x150)]=_0x51c4ca(0x152)+SharedConsts['MODULE_NAME']+'/media/icon/hamburger-menu.svg';static[_0x51c4ca(0x13d)](_0x2fe19c,_0x462fe1,_0x5446b0){const _0x3c670a=_0x51c4ca;_0x5446b0=_0x5446b0||{};const _0x514c88={'type':'list','items':_0x462fe1[_0x3c670a(0x135)](_0x18e0fd=>DataConverter[_0x3c670a(0x143)]+_0x3c670a(0x119)+_0x18e0fd['id']+']{'+(_0x18e0fd[_0x3c670a(0x129)]||_0x18e0fd[_0x3c670a(0x12a)])+'}')},_0x490710={'name':UtilApplications[_0x3c670a(0x151)](_0x2fe19c['name']),'permission':{'default':0x0},'entryTime':Date[_0x3c670a(0x141)](),'content':_0x3c670a(0x156)+Renderer[_0x3c670a(0x125)]()[_0x3c670a(0x155)](!![])['render'](_0x514c88)['replace'](new RegExp(DataConverter[_0x3c670a(0x143)],'g'),'@')+_0x3c670a(0x10a)};if(_0x5446b0['defaultPermission']!=null)_0x490710['permission']={'default':_0x5446b0['defaultPermission']};else{if(_0x5446b0[_0x3c670a(0x14a)])_0x490710[_0x3c670a(0x145)]={'default':Config['get'](_0x3c670a(0x14f),_0x3c670a(0x128))};}return _0x490710;}static[_0x51c4ca(0x136)](_0x4546e3,_0x13d843){const _0x2a25d4=_0x51c4ca;_0x13d843=_0x13d843||{};if(_0x13d843[_0x2a25d4(0x157)])return this['pGetTableJournal'](_0x4546e3,_0x13d843);if(this[_0x2a25d4(0x144)](_0x4546e3))return this['_pGetTableRollableTable_pRollTable'](_0x4546e3,_0x13d843);else return this[_0x2a25d4(0x154)](_0x4546e3,_0x13d843);}static['_isRollableTable'](_0x1a0c88){const _0x2528d9=_0x51c4ca;return this['_isRollableTable_getEntriesTableRollMode'](_0x1a0c88)||Renderer[_0x2528d9(0x158)](_0x1a0c88);}static[_0x51c4ca(0x10f)](_0x424531){const _0xf4439e=_0x51c4ca;if(!_0x424531[_0xf4439e(0x132)]||_0x424531[_0xf4439e(0x132)]['length']<0x2)return RollerUtil[_0xf4439e(0x11e)];const _0x7e3922=RollerUtil[_0xf4439e(0x115)](_0x424531[_0xf4439e(0x132)][0x0]);if(!_0x7e3922)return RollerUtil[_0xf4439e(0x11e)];if(_0x424531[_0xf4439e(0x139)]['some'](_0x5e875e=>_0x5e875e[0x0]?.[_0xf4439e(0x113)]!==_0xf4439e(0x11a)||_0x5e875e[0x0][_0xf4439e(0x134)]==null||_0x5e875e[0x0][_0xf4439e(0x134)][_0xf4439e(0x148)]==null&&_0x5e875e[0x0][_0xf4439e(0x134)]['min']==null&&_0x5e875e[0x0][_0xf4439e(0x134)]['max']==null))return RollerUtil[_0xf4439e(0x11e)];return _0x7e3922;}static['_getTableDescription'](_0x15e235){const _0x555735=_0x51c4ca;return _0x15e235[_0x555735(0x132)]?.[_0x555735(0x11c)]?'Table\x20columns:\x20'+_0x15e235[_0x555735(0x132)][_0x555735(0x135)](_0xef3b27=>Renderer[_0x555735(0x149)](_0xef3b27))['join']('\x20|\x20'):'';}static async['_pGetTableRollableTable_pRollTable'](_0x49efe0,_0x582701){const _0x3c71db=_0x51c4ca;_0x582701=_0x582701||{};const _0x195015=(_0x49efe0['colLabels'][0x0]||'')[_0x3c71db(0x116)]()[_0x3c71db(0x12c)](/{@dice ([^}]+)}/,'$1'),_0x231b58={'name':UtilApplications[_0x3c71db(0x151)](_0x49efe0[_0x3c71db(0x12a)]),'formula':_0x195015,'description':this['_getTableDescription'](_0x49efe0),'results':await _0x49efe0[_0x3c71db(0x139)]['pSerialAwaitMap'](async(_0x2f9f5b,_0x416819)=>{const _0x97cc76=_0x3c71db,{rangeLow:_0x115630,rangeHigh:_0x57affb}=this[_0x97cc76(0x13c)](_0x195015,_0x2f9f5b[0x0]);return this['pGetTableResult']({'type':CONST[_0x97cc76(0x121)][_0x97cc76(0x108)],'text':await this[_0x97cc76(0x114)](_0x2f9f5b[_0x97cc76(0x127)](0x1)),'rangeLow':_0x115630,'rangeHigh':_0x57affb});}),'replacement':!![],'displayRoll':!![]};if(_0x582701['defaultPermission']!=null)_0x231b58[_0x3c71db(0x145)]={'default':_0x582701['defaultPermission']};else{if(_0x582701[_0x3c71db(0x14a)])_0x231b58[_0x3c71db(0x145)]={'default':Config[_0x3c71db(0x125)](_0x3c71db(0x14f),_0x3c71db(0x128))};}return _0x231b58;}static[_0x51c4ca(0x13c)](_0x4d4e7b,_0x547dd5){const _0x3ffe7a=_0x51c4ca;if(_0x547dd5[_0x3ffe7a(0x113)]===_0x3ffe7a(0x11a)&&_0x547dd5['roll']!=null)return _0x547dd5[_0x3ffe7a(0x134)][_0x3ffe7a(0x148)]!=null?{'rangeLow':_0x547dd5[_0x3ffe7a(0x134)][_0x3ffe7a(0x148)],'rangeHigh':_0x547dd5[_0x3ffe7a(0x134)]['exact']}:{'rangeLow':_0x547dd5[_0x3ffe7a(0x134)][_0x3ffe7a(0x117)],'rangeHigh':_0x547dd5[_0x3ffe7a(0x134)][_0x3ffe7a(0x10b)]};let _0x1e9fe6,_0x4c376e;const _0x49744c=String(_0x547dd5)[_0x3ffe7a(0x116)](),_0x28e8eb=/^(\d+)([-\u2013](\d+))?$/['exec'](_0x49744c);if(_0x28e8eb){if(_0x28e8eb[0x1]&&!_0x28e8eb[0x2]){_0x1e9fe6=Number(_0x28e8eb[0x1]);if(_0x1e9fe6===0x0)_0x1e9fe6=this[_0x3ffe7a(0x138)](_0x4d4e7b);_0x4c376e=_0x1e9fe6;}else _0x1e9fe6=Number(_0x28e8eb[0x1]),_0x4c376e=Number(_0x28e8eb[0x3]),_0x4c376e<_0x1e9fe6&&(_0x4c376e=this[_0x3ffe7a(0x138)](_0x4d4e7b));return{'rangeLow':_0x1e9fe6,'rangeHigh':_0x4c376e};}const _0x52f228=/^(\d+) or less$/i[_0x3ffe7a(0x11b)](_0x49744c);if(_0x52f228)return _0x1e9fe6=0x1,_0x4c376e=Number(_0x52f228[0x1]),{'rangeLow':_0x1e9fe6,'rangeHigh':_0x4c376e};const _0x10d585=/^(\d+)\+$/[_0x3ffe7a(0x11b)](_0x49744c);return _0x1e9fe6=Number(_0x10d585[0x1]),_0x4c376e=_0x1e9fe6,{'rangeLow':_0x1e9fe6,'rangeHigh':_0x4c376e};}static async[_0x51c4ca(0x114)](_0x4127db){const _0x112645=_0x51c4ca,_0x5e9d5a=MiscUtil[_0x112645(0x110)]({'keyBlacklist':MiscUtil['GENERIC_WALKER_ENTRIES_KEY_BLACKLIST']});let _0xe5fcea=UtilDataConverter[_0x112645(0x14e)](MiscUtil[_0x112645(0x15b)](_0x4127db));return _0xe5fcea=_0x5e9d5a[_0x112645(0x146)](_0xe5fcea,{'string':_0x31452a=>{const _0x5c2361=_0x112645;return Renderer[_0x5c2361(0x149)](this['_getFoundryDiceTagged'](_0x31452a));}}),_0xe5fcea[_0x112645(0x135)](_0x4c1887=>Renderer['get']()['setFirstSection'](!![])[_0x112645(0x130)](_0x4c1887))['join'](_0x112645(0x10d));}static[_0x51c4ca(0x138)](_0x53aede){const _0x4f66ff=_0x51c4ca,_0xa7ea1c=/\d+/[_0x4f66ff(0x11b)](_0x53aede);if(_0xa7ea1c)return Number(_0xa7ea1c[0x0]);return 0x64;}static async['_pGetTableRollableTable_pOtherTable'](_0x571d9c,_0x5e7415){const _0x3b9d5b=_0x51c4ca;_0x5e7415=_0x5e7415||{};const _0x13896d={'name':UtilApplications[_0x3b9d5b(0x151)](_0x571d9c[_0x3b9d5b(0x12a)]),'formula':'1d'+(_0x571d9c[_0x3b9d5b(0x139)]?_0x571d9c[_0x3b9d5b(0x139)][_0x3b9d5b(0x11c)]:'1'),'description':this[_0x3b9d5b(0x13a)](_0x571d9c),'results':await _0x571d9c[_0x3b9d5b(0x139)][_0x3b9d5b(0x133)](async(_0x3eb51c,_0x37009e)=>{const _0x425e4f=_0x3b9d5b;return _0x3eb51c=_0x3eb51c[_0x425e4f(0x13b)]||_0x3eb51c,this[_0x425e4f(0x11f)]({'type':CONST[_0x425e4f(0x121)]['TEXT'],'text':await this[_0x425e4f(0x114)](_0x3eb51c),'rangeExact':_0x37009e+0x1});}),'replacement':!![],'displayRoll':!![]};if(_0x5e7415[_0x3b9d5b(0x118)]!=null)_0x13896d[_0x3b9d5b(0x145)]={'default':_0x5e7415[_0x3b9d5b(0x118)]};else{if(_0x5e7415[_0x3b9d5b(0x14a)])_0x13896d[_0x3b9d5b(0x145)]={'default':Config[_0x3b9d5b(0x125)](_0x3b9d5b(0x14f),_0x3b9d5b(0x128))};}return _0x13896d;}static async[_0x51c4ca(0x11f)]({type:_0x357da6,text:_0x4987f7,resultId:_0x195f1f,collection:_0x34304b,rangeLow:_0x322235,rangeHigh:_0x2f990c,rangeExact:_0x5239fa,img:img=_0x51c4ca(0x12e),flags:flags={}}){const _0xd39ec8=_0x51c4ca;if(_0x5239fa!=null&&(_0x322235!=null||_0x2f990c!=null))throw new Error(_0xd39ec8(0x147));return{'id':foundry['utils']['randomID'](),'resultId':_0x195f1f,'collection':_0x34304b,'flags':flags,'type':_0x357da6,'text':_0x4987f7,'img':await Vetools[_0xd39ec8(0x10c)](img),'weight':0x1,'range':[_0x322235??_0x5239fa,_0x2f990c??_0x5239fa],'drawn':![]};}static[_0x51c4ca(0x14c)](_0x11753c){const _0x1eb39c=_0x51c4ca;return Math[_0x1eb39c(0x10b)](0x0,..._0x11753c[_0x1eb39c(0x123)][_0x1eb39c(0x135)](_0x45a9ec=>_0x45a9ec['data'][_0x1eb39c(0x107)])[_0x1eb39c(0x11d)]());}static[_0x51c4ca(0x131)](_0x6a38d2){const _0xa14b9=_0x51c4ca;return _0x6a38d2[_0xa14b9(0x12c)](/{@(?:dice|damage) ([^}]+)}/gi,(..._0x1ccfea)=>{const _0x10e4ae=_0xa14b9,[_0x109714,_0x2b6258]=Renderer[_0x10e4ae(0x137)](_0x1ccfea[0x1]),_0x3e9b4e=Vetools[_0x10e4ae(0x153)](_0x109714);return _0x10e4ae(0x12b)+_0x3e9b4e+']]'+(_0x2b6258&&_0x3e9b4e[_0x10e4ae(0x109)]()[_0x10e4ae(0x116)]()!==_0x2b6258[_0x10e4ae(0x109)]()['trim']()?'\x20('+_0x2b6258+')':'');});}static async[_0x51c4ca(0x122)](_0x114887,_0x41c263){const _0x44185d=_0x51c4ca;_0x41c263=_0x41c263||{};const _0x1a444f=MiscUtil[_0x44185d(0x15b)](_0x114887);delete _0x1a444f[_0x44185d(0x12a)],_0x1a444f['type']=_0x1a444f[_0x44185d(0x113)]||_0x44185d(0x120);const _0x3475f9=await UtilDataConverter[_0x44185d(0x124)](()=>{const _0x1323c6=_0x44185d;return _0x1323c6(0x14b)+Renderer['get']()[_0x1323c6(0x155)](!![])['render'](_0x1a444f)+'</div>';}),_0x2e4af9=await this[_0x44185d(0x140)](_0x114887),_0x14e08d={'name':UtilApplications[_0x44185d(0x151)](UtilDataConverter[_0x44185d(0x12d)](_0x114887)),'permission':{'default':0x0},'entryTime':Date[_0x44185d(0x141)](),'content':_0x3475f9,'img':_0x2e4af9};if(_0x41c263[_0x44185d(0x118)]!=null)_0x14e08d[_0x44185d(0x145)]={'default':_0x41c263[_0x44185d(0x118)]};else{if(_0x41c263[_0x44185d(0x14a)])_0x14e08d[_0x44185d(0x145)]={'default':Config['get'](_0x44185d(0x14f),_0x44185d(0x128))};}return _0x14e08d;}}function _0x16bb(_0x21daa1,_0xafed9e){const _0x524364=_0x5243();return _0x16bb=function(_0x16bb05,_0x1a7023){_0x16bb05=_0x16bb05-0x107;let _0x1bdec1=_0x524364[_0x16bb05];return _0x1bdec1;},_0x16bb(_0x21daa1,_0xafed9e);}export{DataConverterTable};