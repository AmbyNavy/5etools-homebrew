const _0xed2c86=_0x25b2;(function(_0x356f2c,_0x1911db){const _0x30256b=_0x25b2,_0x8bfe27=_0x356f2c();while(!![]){try{const _0x1c616e=parseInt(_0x30256b(0xe3))/0x1*(-parseInt(_0x30256b(0xfe))/0x2)+-parseInt(_0x30256b(0xff))/0x3*(parseInt(_0x30256b(0xdc))/0x4)+-parseInt(_0x30256b(0xc4))/0x5*(parseInt(_0x30256b(0xf8))/0x6)+-parseInt(_0x30256b(0x113))/0x7*(-parseInt(_0x30256b(0x103))/0x8)+parseInt(_0x30256b(0xef))/0x9+-parseInt(_0x30256b(0xc9))/0xa+-parseInt(_0x30256b(0xb5))/0xb*(-parseInt(_0x30256b(0xb1))/0xc);if(_0x1c616e===_0x1911db)break;else _0x8bfe27['push'](_0x8bfe27['shift']());}catch(_0x325b72){_0x8bfe27['push'](_0x8bfe27['shift']());}}}(_0xcff6,0x5e679));function _0x25b2(_0x504bc5,_0x1e82c6){const _0xcff6a6=_0xcff6();return _0x25b2=function(_0x25b229,_0x62cf88){_0x25b229=_0x25b229-0xae;let _0x2159a3=_0xcff6a6[_0x25b229];return _0x2159a3;},_0x25b2(_0x504bc5,_0x1e82c6);}import{SharedConsts}from'../shared/SharedConsts.js';import{GameStorage}from'./GameStorage.js';import{UtilFolders}from'./UtilFolders.js';const MixinFolderPathBuilder=_0x314cd9=>class extends _0x314cd9{[_0xed2c86(0xb6)](){const _0x48802f=_0xed2c86;throw new Error(_0x48802f(0xaf));}['getFolderPathMeta'](){const _0x557dc6=_0xed2c86;throw new Error(_0x557dc6(0xaf));}constructor(..._0x51e104){const _0x50d02e=_0xed2c86;super(..._0x51e104),this['_folderPathSpec']=[],this[_0x50d02e(0x102)]=[],this[_0x50d02e(0xf3)]=![];}get['folderPathSpec'](){const _0x140fe2=_0xed2c86;return this[_0x140fe2(0x10e)];}async['_pInit_folderPathSpec'](){const _0x55bc23=_0xed2c86;this[_0x55bc23(0x10e)]=MiscUtil[_0x55bc23(0xed)](await GameStorage['pGetClient'](this[_0x55bc23(0xb6)]()),'path');if(this['_folderPathSpec']==null){const _0x31e56c=this[_0x55bc23(0xd0)](),_0x531789=(this['_defaultFolderPath']||[])[_0x55bc23(0x10c)](_0x4a25ee=>(this[_0x55bc23(0xf3)]?FolderPathBuilderRowTextOnly:FolderPathBuilderRow)[_0x55bc23(0x110)](_0x4a25ee,{'folderPathMeta':_0x31e56c}));await this['pSetFolderPathSpec'](_0x531789);}}async['pSetFolderPathSpec'](_0x48ccd9){const _0xebe2d=_0xed2c86;return this['_folderPathSpec']=_0x48ccd9,GameStorage['pSetClient'](this['_getFullFolderPathSpecKey'](),{'path':this[_0xebe2d(0x10e)]});}async[_0xed2c86(0x107)](){const _0x4587f8=_0xed2c86;await this[_0x4587f8(0xf6)]();const _0x1f6384=new FolderPathBuilderApp(this);_0x1f6384['render'](!![]);}async[_0xed2c86(0xba)]({folderType:_0x2d025b,obj:_0x9f2ac4,sorting:sorting='a'}){const _0x20fd6c=_0xed2c86;if(!this[_0x20fd6c(0x10e)]['length']||!_0x2d025b)return null;const _0x181986=this[_0x20fd6c(0x114)]({'obj':_0x9f2ac4});return UtilFolders[_0x20fd6c(0xf4)]({'folderType':_0x2d025b,'folderNames':_0x181986,'sorting':sorting});}static async[_0xed2c86(0xf9)]({folderType:_0x56e65b,pathStrings:_0x27c3b6,sorting:sorting='a'}){const _0x517a17=_0xed2c86;return UtilFolders[_0x517a17(0xf4)]({'folderType':_0x56e65b,'folderNames':_0x27c3b6,'sorting':sorting});}[_0xed2c86(0x114)]({obj:_0x30d601}){const _0xe17522=_0xed2c86;return FolderPathBuilder[_0xe17522(0xd7)]({'obj':_0x30d601,'folderPathSpec':this[_0xe17522(0x10e)],'folderPathMeta':this['getFolderPathMeta']()});}};class FolderPathBuilder extends BaseComponent{constructor({fpApp:fpApp=null,defaultFolderPathSpec:defaultFolderPathSpec=null,fnOnRowKeydown:fnOnRowKeydown=null}){const _0xec2c31=_0xed2c86;super(),this[_0xec2c31(0xe9)]=fpApp,this[_0xec2c31(0xb9)]=fpApp?FolderPathBuilderRow:FolderPathBuilderRowTextOnly,this[_0xec2c31(0xf1)]=FolderPathBuilder[_0xec2c31(0xce)]({'fpApp':fpApp,'ClsRow':this[_0xec2c31(0xb9)],'defaultFolderPathSpec':defaultFolderPathSpec,'fnOnRowKeydown':fnOnRowKeydown}),this['_fnOnRowKeydown']=fnOnRowKeydown,this[_0xec2c31(0xeb)]=new VeLock(),this[_0xec2c31(0x10f)]=[],this[_0xec2c31(0x101)]=null;}static['_getInitialFolderPathSpec']({fpApp:_0x903244,defaultFolderPathSpec:_0x5cbeca,ClsRow:_0x45866d,fnOnRowKeydown:_0x551a59}){const _0x5413cd=_0xed2c86;if(_0x5cbeca)return _0x5cbeca[_0x5413cd(0x10c)](_0x15e0e5=>_0x45866d[_0x5413cd(0x110)](_0x15e0e5,{'fnOnKeydown':_0x551a59}));return _0x903244?MiscUtil[_0x5413cd(0xe2)](_0x903244[_0x5413cd(0xdb)]):[];}[_0xed2c86(0xae)](_0x2c3772){const _0x5dab91=_0xed2c86;_0x2c3772['empty']();const _0x149c36=this[_0x5dab91(0xf7)]();this[_0x5dab91(0x101)]=$$`<div class="ve-flex-col w-100 h-100 overflow-y-auto relative"></div>`,this[_0x5dab91(0x10f)][_0x5dab91(0x105)](_0x21b4b1=>_0x21b4b1[_0x5dab91(0xae)](this[_0x5dab91(0x101)],_0x149c36)),this[_0x5dab91(0x111)]();const _0x566b0a=$('<button\x20class=\x22btn\x20btn-5et\x20btn-xs\x22><span\x20class=\x22fas\x20fa-fw\x20fa-folder-plus\x22></span>\x20Add\x20Path\x20Part</button>')[_0x5dab91(0xf2)](()=>{const _0x497cef=_0x5dab91,_0x24ad57=CONST['FOLDER_MAX_DEPTH__ORIGINAL']??CONST['FOLDER_MAX_DEPTH'];if(this['_childComps']['length']>=_0x24ad57)return ui[_0x497cef(0xc6)]['warn'](_0x497cef(0xde)+Parser[_0x497cef(0xca)](_0x24ad57)+_0x497cef(0xbb));this[_0x497cef(0xfc)](_0x149c36);});this[_0x5dab91(0xf1)][_0x5dab91(0x105)](_0x78ab6=>this[_0x5dab91(0xfc)](_0x149c36,_0x78ab6)),$$(_0x2c3772)`
			<div class="w-100 split-v-center mb-1"><div>Folder Path:</div>${_0x566b0a}</div>
			${this[_0x5dab91(0x101)]}
		`;}[_0xed2c86(0xfa)](){const _0x157bba=_0xed2c86;return this['_childComps'][_0x157bba(0x10c)](_0x1c555c=>MiscUtil[_0x157bba(0xe2)](_0x1c555c[_0x157bba(0xf0)]));}static[_0xed2c86(0xd7)]({obj:obj=null,folderPathSpec:folderPathSpec=null,folderPathMeta:folderPathMeta=null}={}){const _0x5f2eea=_0xed2c86;return folderPathSpec['filter'](_0x106820=>_0x106820[_0x5f2eea(0xdf)]?_0x106820[_0x5f2eea(0xd9)]&&_0x106820['text']['trim']():_0x106820[_0x5f2eea(0xe0)])[_0x5f2eea(0x10c)](_0x57fc15=>_0x57fc15['isFreeText']?_0x57fc15[_0x5f2eea(0xd9)]:folderPathMeta[_0x57fc15['selectedProp']][_0x5f2eea(0xb8)](obj));}[_0xed2c86(0xd7)]({obj:obj=null,folderPathSpec:folderPathSpec=null,folderPathMeta:folderPathMeta=null}={}){const _0xbaa672=_0xed2c86;return folderPathSpec=folderPathSpec||this[_0xbaa672(0xfa)](),folderPathMeta=folderPathMeta||(this[_0xbaa672(0xe9)]?this[_0xbaa672(0xe9)]['getFolderPathMeta']():null),this[_0xbaa672(0xbf)]['getFolderPathStrings']({'obj':obj,'folderPathSpec':folderPathSpec,'folderPathMeta':folderPathMeta});}async[_0xed2c86(0xc2)](){const _0x3ea97a=_0xed2c86;if(!this[_0x3ea97a(0xe9)])return;await this[_0x3ea97a(0xeb)][_0x3ea97a(0xb4)](),await this[_0x3ea97a(0xe9)][_0x3ea97a(0xd1)](this[_0x3ea97a(0xfa)]()),this['_lock'][_0x3ea97a(0x104)]();}[_0xed2c86(0xfc)](_0x5637fd,_0x17ff0e){const _0x37f77b=_0xed2c86,_0x3e0e40=this['_fpApp']?this[_0x37f77b(0xe9)][_0x37f77b(0xd0)]():{},_0x4b04b0=new this[(_0x37f77b(0xb9))](_0x3e0e40,{'fnOnKeydown':this[_0x37f77b(0xe6)]});if(_0x17ff0e)Object[_0x37f77b(0xfb)](_0x4b04b0[_0x37f77b(0xd6)],_0x17ff0e);_0x4b04b0[_0x37f77b(0xc5)]('state',()=>this[_0x37f77b(0xc2)]());if(!this[_0x37f77b(0x10f)][_0x37f77b(0xec)])this[_0x37f77b(0x101)][_0x37f77b(0xb0)]();this['_childComps']['push'](_0x4b04b0),_0x4b04b0[_0x37f77b(0xae)](this['_$wrpRows'],_0x5637fd),this['_render_updateParentPath']();}[_0xed2c86(0xfd)](_0x443783,_0x17d0e0){const _0x5bd8eb=_0xed2c86,_0x591749=this['_childComps'][_0x443783];this['_childComps'][_0x443783]=this[_0x5bd8eb(0x10f)][_0x17d0e0],this[_0x5bd8eb(0x10f)][_0x17d0e0]=_0x591749,this[_0x5bd8eb(0x10f)][_0x5bd8eb(0x105)](_0x9c7872=>_0x9c7872[_0x5bd8eb(0xb2)][_0x5bd8eb(0xdd)]()['appendTo'](this['_$wrpRows'])),this[_0x5bd8eb(0xc2)]();}[_0xed2c86(0xcd)](_0xe795d8){const _0x405902=_0xed2c86,_0x26a73b=this[_0x405902(0x10f)][_0x405902(0xc3)](_0xe795d8);~_0x26a73b&&(this['_childComps'][_0x405902(0xd8)](_0x26a73b,0x1),_0xe795d8['$row'][_0x405902(0xcb)](),this[_0x405902(0xc2)]()),this[_0x405902(0x111)]();}[_0xed2c86(0x111)](){const _0x87ca92=_0xed2c86;if(!this['_childComps'][_0x87ca92(0xec)])this[_0x87ca92(0x101)]['append'](_0x87ca92(0xcf));}[_0xed2c86(0xf7)](){const _0x3feeaf=_0xed2c86,_0x58b0ea=super[_0x3feeaf(0xf7)]();return _0x58b0ea['swapRowPositions']=this['_swapRowPositions']['bind'](this),_0x58b0ea[_0x3feeaf(0xe1)]=this[_0x3feeaf(0xcd)]['bind'](this),_0x58b0ea[_0x3feeaf(0x10b)]=()=>this[_0x3feeaf(0x10f)][_0x3feeaf(0x10c)](_0x39f321=>_0x39f321['$row']),_0x58b0ea;}}function _0xcff6(){const _0x597e1c=['toggleClass','_render_updateParentPath','indexOf','10NDKRbv','_addHookAll','notifications','appendTo','ascSortLower','7396710qakJom','numberToText','remove','$getBtnBool','_removeRow','_getInitialFolderPathSpec','<div\x20class=\x22ve-flex-v-center\x20w-100\x20my-1\x22><i>(Directory\x20root)</i></div>','getFolderPathMeta','pSetFolderPathSpec','activateListeners','ve-hidden','Folder\x20path\x20meta\x20key\x20\x22','type','__state','getFolderPathStrings','splice','text','MODULE_LOCATION','folderPathSpec','20VUUnLA','detach','Foundry\x20currently\x20supports\x20a\x20maximum\x20of\x20','isFreeText','selectedProp','removeRow','copy','180541oTxVyA','_$row','keydown','_fnOnRowKeydown','mr-2','Edit\x20Folder\x20Path','_fpApp','_DEFAULT_STATE','_lock','length','get','label','5794308EZeBXa','_state','_initialFolderPathSpec','click','_mxFolderPathBuilder_textOnlyMode','pCreateFoldersGetId','\x22\x20was\x20not\x20found\x20in\x20the\x20available\x20values!','_pInit_folderPathSpec','getPod','67128FQMoQU','pGetCreateFoldersGetIdFromPathStrings','_getFolderPathSpec','assign','_render_addRow','_swapRowPositions','2cCldKi','66633GNCxeA','_comp','_$wrpRows','_defaultFolderPath','693352FJCKyE','unlock','forEach','attr','pHandleEditFolderPathClick','_getDefaultState','$getIptStr','_folderMeta','$getChildren','map','$getDragPad2','_folderPathSpec','_childComps','getStateFromDefault_','_render_checkAddEmptyMessage','keys','35noJzzZ','_getFolderPathStrings','render','Unimplemented!','empty','150276GnyimV','$row','addClass','pLock','319Rritih','_getFullFolderPathSpecKey','metaKey','getter','_ClsRow','_pGetCreateFoldersGetIdFromObject','\x20levels\x20of\x20directory\x20nesting.\x20T-too\x20deep!','_fnOnKeydown','<button\x20class=\x22btn\x20btn-danger\x20btn-xs\x22><span\x20class=\x22fas\x20fa-fw\x20fa-trash\x22></span></button>','$getSelEnum','constructor','_parent'];_0xcff6=function(){return _0x597e1c;};return _0xcff6();}class FolderPathBuilderRowTextOnly extends BaseComponent{constructor(_0x46b01c,{fnOnKeydown:_0xab08b9}={}){const _0x3a8e4f=_0xed2c86;super(),this[_0x3a8e4f(0x10a)]=_0x46b01c,this[_0x3a8e4f(0xe4)]=null,this[_0x3a8e4f(0xbc)]=_0xab08b9;}get[_0xed2c86(0xb2)](){const _0x1e21ee=_0xed2c86;return this[_0x1e21ee(0xe4)];}['render'](_0x33f4b5,_0x4fac60){const _0x47ad13=_0xed2c86;this[_0x47ad13(0xc0)]=_0x4fac60;const _0x4f17b2=ComponentUiUtil[_0x47ad13(0x109)](this,_0x47ad13(0xd9))[_0x47ad13(0x106)](_0x47ad13(0xd5),_0x47ad13(0xd9))[_0x47ad13(0xb3)](_0x47ad13(0xe7));if(this[_0x47ad13(0xbc)])_0x4f17b2[_0x47ad13(0xe5)](_0x287970=>this[_0x47ad13(0xbc)](_0x287970));const _0x4d029d=$(_0x47ad13(0xbd))['click'](()=>{const {removeRow:_0x308542}=this['_parent'];_0x308542(this);});this[_0x47ad13(0xe4)]=$$`<div class="ve-flex-v-center w-100 my-1 imp-folder__row">
			${_0x4f17b2}
			${DragReorderUiUtil[_0x47ad13(0x10d)](()=>this[_0x47ad13(0xe4)],_0x33f4b5,this[_0x47ad13(0xc0)])}
			${_0x4d029d}
		</div>`[_0x47ad13(0xc7)](_0x33f4b5);}[_0xed2c86(0x108)](){const _0x3b7a12=_0xed2c86;return{...FolderPathBuilderRowTextOnly[_0x3b7a12(0xea)]};}static[_0xed2c86(0x110)](_0x2ad323,{..._0xac489f}={}){const _0x1f00f3=_0xed2c86,_0x21ee27=new FolderPathBuilderRowTextOnly({..._0xac489f});return _0x21ee27[_0x1f00f3(0xd6)][_0x1f00f3(0xd9)]=_0x2ad323,_0x21ee27[_0x1f00f3(0xd6)];}}FolderPathBuilderRowTextOnly[_0xed2c86(0xea)]={'text':'','isFreeText':!![]};class FolderPathBuilderRow extends FolderPathBuilderRowTextOnly{[_0xed2c86(0xae)](_0x5a471d,_0x30aebe){const _0x4fc96b=_0xed2c86;this[_0x4fc96b(0xc0)]=_0x30aebe;const _0x1a3bf7=ComponentUiUtil[_0x4fc96b(0xcc)](this,_0x4fc96b(0xdf),{'$ele':$('<button\x20class=\x22btn\x20btn-xs\x20mr-1\x20imp-folder__btn-mode\x22>Custom</button>')}),_0xb368f3=ComponentUiUtil[_0x4fc96b(0x109)](this,_0x4fc96b(0xd9))[_0x4fc96b(0x106)](_0x4fc96b(0xd5),_0x4fc96b(0xd9));if(this[_0x4fc96b(0xbc)])_0xb368f3[_0x4fc96b(0xe5)](_0x374d21=>this['_fnOnKeydown'](_0x374d21));const _0x3ad007=$$`<div class="ve-flex mr-1 w-100">${_0xb368f3}</div>`,_0x94712a=Object[_0x4fc96b(0x112)](this['_folderMeta'])['sort']((_0x6b0d57,_0x161d0e)=>SortUtil[_0x4fc96b(0xc8)](this[_0x4fc96b(0x10a)][_0x6b0d57]['label'],this[_0x4fc96b(0x10a)][_0x161d0e][_0x4fc96b(0xee)])),_0x3c07a5=ComponentUiUtil[_0x4fc96b(0xbe)](this,'selectedProp',{'values':_0x94712a,'isAllowNull':!![],'fnDisplay':_0x21a645=>this[_0x4fc96b(0x10a)][_0x21a645][_0x4fc96b(0xee)]}),_0x3bb9d5=$$`<div class="ve-flex mr-1 w-100">${_0x3c07a5}</div>`,_0x1f128f=()=>{const _0x16848f=_0x4fc96b;_0x3ad007[_0x16848f(0xc1)](_0x16848f(0xd3),!this['_state']['isFreeText']),_0x3bb9d5['toggleClass'](_0x16848f(0xd3),this['_state']['isFreeText']);};_0x1f128f(),this['_addHookBase'](_0x4fc96b(0xdf),_0x1f128f);const _0x4d4b36=$(_0x4fc96b(0xbd))['click'](()=>{const _0x1fadaa=_0x4fc96b,{removeRow:_0x4e229a}=this[_0x1fadaa(0xc0)];_0x4e229a(this);});this[_0x4fc96b(0xe4)]=$$`<div class="ve-flex-v-center w-100 my-1 imp-folder__row">
			${_0x1a3bf7}
			${_0x3ad007}
			${_0x3bb9d5}
			${DragReorderUiUtil['$getDragPad2'](()=>this[_0x4fc96b(0xe4)],_0x5a471d,this['_parent'])}
			${_0x4d4b36}
		</div>`[_0x4fc96b(0xc7)](_0x5a471d);}[_0xed2c86(0x108)](){const _0x574326=_0xed2c86;return{...FolderPathBuilderRow[_0x574326(0xea)]};}static[_0xed2c86(0x110)](_0xb3fea1,{folderPathMeta:_0x58c30d,..._0x467551}={}){const _0x1202a2=_0xed2c86,_0xcf3bb5=new FolderPathBuilderRow({..._0x467551});if(_0xb3fea1?.[_0x1202a2(0xb7)]){if(!_0x58c30d?.[_0xb3fea1['metaKey']])throw new Error(_0x1202a2(0xd4)+_0xb3fea1['metaKey']+_0x1202a2(0xf5));_0xcf3bb5[_0x1202a2(0xd6)]['isFreeText']=![],_0xcf3bb5[_0x1202a2(0xd6)][_0x1202a2(0xe0)]=_0xb3fea1[_0x1202a2(0xb7)];}else _0xcf3bb5[_0x1202a2(0xd6)][_0x1202a2(0xd9)]=_0xb3fea1;return _0xcf3bb5[_0x1202a2(0xd6)];}}FolderPathBuilderRow[_0xed2c86(0xea)]={'isFreeText':!![],'text':'','selectedProp':null};class FolderPathBuilderApp extends Application{constructor(_0x353911){const _0x4f6ef3=_0xed2c86;super({'width':0x1e0,'height':0x1e0,'title':_0x4f6ef3(0xe8),'template':SharedConsts[_0x4f6ef3(0xda)]+'/template/FolderPathBuilder.hbs','resizable':!![]}),this['_comp']=new FolderPathBuilder({'fpApp':_0x353911});}[_0xed2c86(0xd2)](_0x52edb3){const _0x1985a3=_0xed2c86;super['activateListeners'](_0x52edb3),this[_0x1985a3(0x100)]['render'](_0x52edb3);}}export{MixinFolderPathBuilder,FolderPathBuilder};