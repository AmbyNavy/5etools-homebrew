const _0xda16c8=_0x19c0;(function(_0x19f718,_0x22cde5){const _0x28f442=_0x19c0,_0x4c4c95=_0x19f718();while(!![]){try{const _0x22a5d6=-parseInt(_0x28f442(0x1a1))/0x1+-parseInt(_0x28f442(0x1be))/0x2*(-parseInt(_0x28f442(0x1ec))/0x3)+-parseInt(_0x28f442(0x23e))/0x4*(-parseInt(_0x28f442(0x1d8))/0x5)+-parseInt(_0x28f442(0x1b4))/0x6*(-parseInt(_0x28f442(0x210))/0x7)+-parseInt(_0x28f442(0x1c6))/0x8+-parseInt(_0x28f442(0x1c9))/0x9+-parseInt(_0x28f442(0x1f3))/0xa;if(_0x22a5d6===_0x22cde5)break;else _0x4c4c95['push'](_0x4c4c95['shift']());}catch(_0x290a60){_0x4c4c95['push'](_0x4c4c95['shift']());}}}(_0x1304,0x483de));import{Vetools}from'./Vetools.js';function _0x1304(){const _0x52f1c4=['damageTuples','text','miscTags','pGetEntryDescription','_pGetSaveImagePath','spellPointsItemId','2IvgPrG','timed','filter','icons/magic/defensive/shield-barrier-blue.webp','isPrepared','touch','spec','week','2917744hwfyaE','npc','slice','1285092AXUHEM','entriesHigherLevel','condition','isActorItem','findIndex','find','walk','_getImgFallback','savingThrow','none','modules/','usesMax','VET_SPELL_SCHOOL_TO_ABV','importSpell','permission','1865CgJIIa','MODULE_NAME','get','pUpdateDocument','/media/icon/scroll-unfurled.svg','isStrictMatching','label','pSetSpellItemIsPrepared','msak','consumeType','data','getMetricUnitDistance','getSrdCompendiumEntity','durationAmount','unit','pHasSpellSideLoadedEffects','isAllowSpellPoints','durationUnit','self','isActorItemNpc','1611636KjrwYH','PG_SPELLS','trim','_getReDiceYourSpellcastingMod','foundrySpell','addPerLevel','concentration','3876560utMDlQ','_pGetFlagsSideLoaded','name','school','ranged\x20spell\x20attack','VALID_DAMAGE_TYPES','melee\x20spell\x20attack','forEach','source','consumeTarget','icons/magic/movement/abstract-ribbons-red-orange.webp','cost','permanent','replace','substring','length','isAddPermission','split','usesCurrent','options','defaultPermission','meta','vetConsumes','_pGetEffectsRawSideLoaded_','getExpandedEffects','inst','hour','parts','MODULE_NAME_FAKE','7kSjaKM','minute','min','perm','icons/magic/unholy/hand-fire-skeleton-pink.webp','getWalker','_SIDE_LOAD_OPTS','special','preparationMode','_pGetSpellEffects','abilityAbv','healing','push','isCustomDamageParts','spClassesToCurrentAndLegacy','getMetricNumberDistance','range','icons/magic/unholy/silhouette-evil-horned-giant.webp','icons/magic/air/wind-vortex-swirl-purple.webp','getSourceWithPagePart','_getConfigKeyIsSpellPoints','entries','_pGetDescription','duration','type','getNameWithSourcePart','_pGetSpellItem_parseAndAddDamage','spLevelToSpellPoints','day','consumeAmount','instant','sphere','_pGetImgCustom','parentClassSource','round','target','add','clamped','getCombinedClasses','icons/magic/defensive/illusion-evasion-echo-purple.webp','target.value','_pGetDataSideLoaded','icons/magic/fire/projectile-fireball-orange-yellow.webp','_pGetSpellItem_getHigherLevelMeta','save','exec','4604YKFlFN','\x20+\x20@mod','copy','last','effects','target.units','components','time','rsak','level','permissions','distance','units','icons/magic/perception/orb-eye-scrying.webp','toLowerCase','prepared','damage','ritual','getConsumedSheetItem','turn','always','join','cantrip','URL_TO_HASH_BUILDER','getItemSource','charges','atwill','import','number','scalingLevelDice','pGetSpellSideData','util','splitFirstSpace','275497tMHSFq','@mod','castAtLevel','spell','parentClassName','keys','actor','map','some','pGetSpellItem','<div><span\x20class=\x22bold\x22>Classes:\x20</span>','includes','usesPer','amount','_pGetSpellItem_getLevel','year','scaling','consume','pGetSpellItemEffects','3000156JWCQEV','damageInflict','fromClassList','items'];_0x1304=function(){return _0x52f1c4;};return _0x1304();}import{UtilActors}from'./UtilActors.js';import{Config}from'./Config.js';import{SharedConsts}from'../shared/SharedConsts.js';import{UtilApplications}from'./UtilApplications.js';import{DataConverter}from'./DataConverter.js';import{UtilCompendium}from'./UtilCompendium.js';import{UtilActiveEffects}from'./UtilActiveEffects.js';function _0x19c0(_0x21f6db,_0x4bf3e1){const _0x130448=_0x1304();return _0x19c0=function(_0x19c0de,_0x86c403){_0x19c0de=_0x19c0de-0x18d;let _0x1d4305=_0x130448[_0x19c0de];return _0x1d4305;},_0x19c0(_0x21f6db,_0x4bf3e1);}import{UtilDataConverter}from'./UtilDataConverter.js';import{ConfigConsts}from'./ConfigConsts.js';import{UtilDocuments}from'./UtilDocuments.js';class DataConverterSpell extends DataConverter{static [_0xda16c8(0x216)]={'propBrew':_0xda16c8(0x1f0),'fnLoadJson':Vetools[_0xda16c8(0x19e)],'propJson':_0xda16c8(0x1a4)};static ['_IMG_FALLBACK']=_0xda16c8(0x1d3)+SharedConsts[_0xda16c8(0x1d9)]+_0xda16c8(0x1dc);static[_0xda16c8(0x224)](_0x252a59){const _0x43de88=_0xda16c8;if(_0x252a59[_0x43de88(0x1a7)]?.[_0x43de88(0x228)]===_0x43de88(0x1c7)||_0x252a59[_0x43de88(0x1eb)])return'isSpellPointsNpc';return'isSpellPoints';}static[_0xda16c8(0x1e8)](_0x26252b,_0x5a6ea4){const _0x20c559=_0xda16c8;return _0x5a6ea4[_0x20c559(0x233)]==null&&_0x5a6ea4[_0x20c559(0x209)]==null&&Config[_0x20c559(0x1da)](_0x20c559(0x1d6),this['_getConfigKeyIsSpellPoints'](_0x5a6ea4))&&_0x26252b[_0x20c559(0x247)]!==0x0;}static async[_0xda16c8(0x1aa)](_0x122ba1,_0xfb842b){const _0x5138a7=_0xda16c8;_0xfb842b=_0xfb842b||{};const _0x22d384=await UtilCompendium[_0x5138a7(0x1e4)](_0x5138a7(0x1a4),_0x122ba1),_0x55c973=await this[_0x5138a7(0x226)](_0x122ba1),_0x28b566=JSON['stringify'](_0x122ba1[_0x5138a7(0x225)]);let _0x463aaf=_0x122ba1[_0x5138a7(0x247)]===0x0?_0x5138a7(0x194):_0xfb842b[_0x5138a7(0x218)]||_0x5138a7(0x18f),_0x2914c4=_0x122ba1[_0x5138a7(0x247)]===0x0?!![]:!!_0xfb842b[_0x5138a7(0x1c2)];Config['get']('importSpell',this['_getConfigKeyIsSpellPoints'](_0xfb842b))&&_0x122ba1['level']!==0x0&&(_0x463aaf===_0x5138a7(0x18f)||_0x463aaf===_0x5138a7(0x194))&&(_0x463aaf=_0x5138a7(0x19a));let _0x49cce1='';if(_0x122ba1[_0x5138a7(0x1ba)]&&_0x122ba1['miscTags'][_0x5138a7(0x1ac)]('HL'))_0x49cce1='heal';if(_0x122ba1[_0x5138a7(0x1d1)]&&_0x122ba1['savingThrow'][_0x5138a7(0x202)])_0x49cce1=_0x5138a7(0x23c);if(_0x28b566[_0x5138a7(0x18e)]()['includes'](_0x5138a7(0x1f9)))_0x49cce1=_0x5138a7(0x1e0);if(_0x28b566[_0x5138a7(0x18e)]()['includes'](_0x5138a7(0x1f7)))_0x49cce1=_0x5138a7(0x246);_0x49cce1=_0x49cce1||_0x5138a7(0x19f);const _0x27b350=UtilActors[_0x5138a7(0x1d5)][_0x122ba1[_0x5138a7(0x1f6)]]||'',_0x8c8ba=_0x122ba1[_0x5138a7(0x244)]&&_0x122ba1[_0x5138a7(0x244)]['m']?_0x122ba1[_0x5138a7(0x244)]['m']!==!![]?''+(_0x122ba1[_0x5138a7(0x244)]['m'][_0x5138a7(0x1b9)]||_0x122ba1['components']['m']):'':'';let _0x40c9bf=0x0,_0x3e6cbb='';const _0x22a254=_0x122ba1['duration'][0x0];switch(_0x22a254[_0x5138a7(0x228)]){case _0x5138a7(0x22e):_0x3e6cbb=_0x5138a7(0x20c);break;case _0x5138a7(0x1bf):{switch(_0x22a254['duration'][_0x5138a7(0x228)]){case _0x5138a7(0x193):_0x3e6cbb=_0x5138a7(0x193),_0x40c9bf=_0x22a254['duration']['amount'];break;case _0x5138a7(0x232):_0x3e6cbb=_0x5138a7(0x232),_0x40c9bf=_0x22a254[_0x5138a7(0x227)][_0x5138a7(0x1ae)];break;case _0x5138a7(0x211):_0x3e6cbb='minute',_0x40c9bf=_0x22a254[_0x5138a7(0x227)][_0x5138a7(0x1ae)];break;case _0x5138a7(0x20d):_0x3e6cbb=_0x5138a7(0x20d),_0x40c9bf=_0x22a254[_0x5138a7(0x227)][_0x5138a7(0x1ae)];break;case _0x5138a7(0x22c):_0x3e6cbb=_0x5138a7(0x22c),_0x40c9bf=_0x22a254[_0x5138a7(0x227)][_0x5138a7(0x1ae)];break;case _0x5138a7(0x1c5):_0x3e6cbb=_0x5138a7(0x22c),_0x40c9bf=_0x22a254[_0x5138a7(0x227)][_0x5138a7(0x1ae)]*0x7;break;case _0x5138a7(0x1b0):_0x3e6cbb=_0x5138a7(0x1b0),_0x40c9bf=_0x22a254[_0x5138a7(0x227)][_0x5138a7(0x1ae)];break;}break;}case _0x5138a7(0x1ff):_0x3e6cbb=_0x5138a7(0x213);break;case _0x5138a7(0x217):_0x3e6cbb=_0x5138a7(0x1c4);break;}let _0x74e0ef=0x0,_0x32e832='',_0x4bfe7b=0x0,_0x352b5f='',_0x5a3d89='';switch(_0x122ba1['range'][_0x5138a7(0x228)]){case RNG_SPECIAL:_0x32e832=_0x5138a7(0x1c4);break;case RNG_POINT:{const _0x539928=_0x122ba1[_0x5138a7(0x220)][_0x5138a7(0x249)];switch(_0x539928['type']){case RNG_SELF:{_0x352b5f='self',_0x5a3d89=_0x5138a7(0x1ea),_0x32e832=_0x5138a7(0x1ea);break;}case RNG_UNLIMITED:case RNG_UNLIMITED_SAME_PLANE:case RNG_SIGHT:case RNG_SPECIAL:{_0x352b5f=_0x5138a7(0x1c4),_0x32e832=_0x5138a7(0x1c4);break;}case RNG_TOUCH:{_0x352b5f=_0x5138a7(0x1c3),_0x32e832=_0x5138a7(0x1c3);break;}case UNT_MILES:{_0x74e0ef=Config[_0x5138a7(0x21f)]({'configGroup':'importSpell','originalValue':_0x539928[_0x5138a7(0x1ae)],'originalUnit':UNT_MILES}),_0x32e832=Config['getMetricUnitDistance']({'configGroup':'importSpell','originalUnit':UNT_MILES});break;}case UNT_FEET:default:{_0x74e0ef=Config[_0x5138a7(0x21f)]({'configGroup':_0x5138a7(0x1d6),'originalValue':_0x539928[_0x5138a7(0x1ae)],'originalUnit':UNT_FEET}),_0x32e832=Config[_0x5138a7(0x1e3)]({'configGroup':_0x5138a7(0x1d6),'originalUnit':UNT_FEET});break;}}break;}case RNG_LINE:case RNG_CUBE:case RNG_CONE:case RNG_RADIUS:case RNG_SPHERE:case RNG_HEMISPHERE:case RNG_CYLINDER:{_0x4bfe7b=Config['getMetricNumberDistance']({'configGroup':_0x5138a7(0x1d6),'originalValue':_0x122ba1[_0x5138a7(0x220)][_0x5138a7(0x249)][_0x5138a7(0x1ae)],'originalUnit':_0x122ba1[_0x5138a7(0x220)][_0x5138a7(0x249)][_0x5138a7(0x228)]}),_0x352b5f=Config[_0x5138a7(0x1e3)]({'configGroup':_0x5138a7(0x1d6),'originalUnit':_0x122ba1[_0x5138a7(0x220)][_0x5138a7(0x249)][_0x5138a7(0x228)]});if(_0x122ba1['range'][_0x5138a7(0x228)]===RNG_HEMISPHERE)_0x5a3d89=_0x5138a7(0x22f);else _0x5a3d89=_0x122ba1[_0x5138a7(0x220)][_0x5138a7(0x228)];}}let _0x27cb07=[],_0x5b7adc=null,_0x4f0569=null,_0x20b5b9=![];if(_0x122ba1[_0x5138a7(0x19d)]){const _0x21c986=[_0x122ba1[_0x5138a7(0x19d)]]['flat'](),_0x693d19=_0xdbd0a7=>Math[_0x5138a7(0x212)](...Object[_0x5138a7(0x1a6)](_0xdbd0a7)[_0x5138a7(0x1a8)](_0x4241d4=>Number(_0x4241d4))),_0x3fbab4=new RegExp('('+UtilActors[_0x5138a7(0x1f8)]['join']('|')+')','i');_0x27cb07['push'](..._0x21c986['map'](_0x1abe7a=>{const _0x3787e6=_0x5138a7,_0x41e7e8=_0x693d19(_0x1abe7a[_0x3787e6(0x1b1)]),_0x34cd1e=_0x1abe7a[_0x3787e6(0x1b1)][_0x41e7e8],_0x1d5aa3=_0x3fbab4[_0x3787e6(0x23d)](_0x1abe7a[_0x3787e6(0x1de)]||'');return[(_0x34cd1e||'')['replace'](/{{spellcasting_mod}}/g,_0x3787e6(0x1a2)),_0x1d5aa3?_0x1d5aa3[0x1][_0x3787e6(0x18e)]():null];}));const _0x38ed74=_0x21c986[0x0],_0xf2b97a=_0x693d19(_0x38ed74[_0x5138a7(0x1b1)]);_0x5b7adc=_0x38ed74[_0x5138a7(0x1b1)][_0xf2b97a];}else{let _0x1f85dc=[];if(_0x122ba1[_0x5138a7(0x1b5)]&&_0x122ba1[_0x5138a7(0x1b5)][_0x5138a7(0x202)]){if(_0x28b566['toLowerCase']()[_0x5138a7(0x1ac)]('when\x20you\x20reach\x205th\x20level')){const _0x44d9dd=[];_0x28b566['replace'](/\({@damage ([^}]+)}\)/g,(..._0x6be3ad)=>_0x44d9dd['push'](_0x6be3ad[0x1]));if(_0x44d9dd[_0x5138a7(0x202)]===0x3){const _0x4cbc75=/(?:^|[^(]){@damage ([^}]+)}(?:[^)]|$)/[_0x5138a7(0x23d)](_0x28b566);if(_0x4cbc75)_0x5b7adc=_0x4cbc75[0x1];else _0x5b7adc=_0x44d9dd[0x0];}}this[_0x5138a7(0x22a)](_0x28b566,_0x1f85dc);}if(_0x122ba1['miscTags']&&_0x122ba1[_0x5138a7(0x1ba)][_0x5138a7(0x1a9)](_0x5d89d9=>_0x5d89d9==='HL')){const _0x3d4e7a=['',_0x5138a7(0x21b)];_0x28b566['replace'](this[_0x5138a7(0x1ef)](),(..._0x672026)=>{const _0x2427e7=_0x5138a7,[,_0x32d8c1,_0x4e559a]=_0x672026;_0x3d4e7a[0x0]=_0x32d8c1;if(_0x4e559a)_0x3d4e7a[0x0]=_0x3d4e7a[0x0]+_0x2427e7(0x23f);}),_0x1f85dc[_0x5138a7(0x21c)](_0x3d4e7a);}const _0x30d31a=this[_0x5138a7(0x23b)]({'spell':_0x122ba1,'opts':_0xfb842b,'damageTuples':_0x1f85dc,'isCustomDamageParts':_0x20b5b9,'scaling':_0x4f0569,'preparationMode':_0x463aaf});_0x30d31a&&(_0x1f85dc=_0x30d31a[_0x5138a7(0x1b8)],_0x20b5b9=_0x30d31a[_0x5138a7(0x21d)],_0x4f0569=_0x30d31a[_0x5138a7(0x1b1)]);if(!_0x1f85dc['length'])this[_0x5138a7(0x22a)](_0x28b566,_0x1f85dc);_0x27cb07['push'](..._0x1f85dc);}_0x27cb07=_0x27cb07[_0x5138a7(0x1c0)](Boolean);let _0x5ba13c='';!_0x27cb07[_0x5138a7(0x202)]&&!_0x20b5b9&&!MiscUtil['get'](_0x22d384,_0x5138a7(0x1e2),'damage',_0x5138a7(0x20e))&&_0x28b566[_0x5138a7(0x200)](this[_0x5138a7(0x1ef)](),(..._0x1202b5)=>{const _0xf66b5e=_0x5138a7,[,_0x38e23b,_0x135a53]=_0x1202b5;_0x5ba13c=_0x38e23b;if(_0x135a53)_0x5ba13c=_0x5ba13c+_0xf66b5e(0x23f);});let _0x16002b='';if(_0x122ba1['savingThrow']&&_0x122ba1[_0x5138a7(0x1d1)]['length'])_0x16002b=_0x122ba1[_0x5138a7(0x1d1)][0x0][_0x5138a7(0x201)](0x0,0x3)[_0x5138a7(0x18e)]();let _0x342a97=_0x5138a7(0x1a4);if(_0xfb842b[_0x5138a7(0x21a)])_0x342a97=_0xfb842b[_0x5138a7(0x21a)];const {type:_0x8e4d01,amount:_0x7111e8,target:_0x30a0f3}=this['_pGetSpellItem_getConsumes']({'spell':_0x122ba1,'opts':_0xfb842b}),_0x5a32c5=await this[_0x5138a7(0x1bc)](_0x122ba1,{'propCompendium':_0x5138a7(0x1a4)});if(_0x22d384){_0x4bfe7b=Config[_0x5138a7(0x21f)]({'configGroup':'importSpell','originalValue':MiscUtil[_0x5138a7(0x1da)](_0x22d384,_0x5138a7(0x1e2),'target','value'),'originalUnit':MiscUtil[_0x5138a7(0x1da)](_0x22d384,'data','target',_0x5138a7(0x24a))})||_0x4bfe7b,_0x352b5f=Config[_0x5138a7(0x1e3)]({'configGroup':_0x5138a7(0x1d6),'originalUnit':MiscUtil[_0x5138a7(0x1da)](_0x22d384,_0x5138a7(0x1e2),'target',_0x5138a7(0x24a))})||_0x352b5f,_0x5a3d89=MiscUtil[_0x5138a7(0x1da)](_0x22d384,_0x5138a7(0x1e2),_0x5138a7(0x233),_0x5138a7(0x228))||_0x5a3d89;if(!_0x20b5b9)_0x27cb07=MiscUtil[_0x5138a7(0x1da)](_0x22d384,_0x5138a7(0x1e2),_0x5138a7(0x190),'parts')||_0x27cb07;if(!_0x5b7adc&&!_0x4f0569)_0x4f0569=MiscUtil[_0x5138a7(0x1da)](_0x22d384,_0x5138a7(0x1e2),_0x5138a7(0x1b1),'formula');}const _0x516be1=await this[_0x5138a7(0x239)](_0x122ba1,{'targetUnits':_0x352b5f}),_0x379995=await this[_0x5138a7(0x1f4)](_0x122ba1);if(_0xfb842b['durationAmount']!==undefined)_0x40c9bf=_0xfb842b[_0x5138a7(0x1e5)];if(_0xfb842b[_0x5138a7(0x1e9)]!==undefined)_0x3e6cbb=_0xfb842b[_0x5138a7(0x1e9)];const _0x506ffb={'name':UtilApplications['getCleanEntityName'](''+UtilDataConverter[_0x5138a7(0x229)](_0x122ba1,{'isActorItem':_0xfb842b[_0x5138a7(0x1cc)]})+(_0xfb842b['nameSuffix']||'')),'type':'spell','data':{'source':UtilDataConverter[_0x5138a7(0x223)](_0x122ba1),'description':{'value':_0x55c973,'chat':'','unidentified':''},'actionType':_0x49cce1,'level':this[_0x5138a7(0x1af)](_0x122ba1),'school':_0x27b350,'components':{'value':'','vocal':_0x122ba1['components']&&_0x122ba1[_0x5138a7(0x244)]['v'],'somatic':_0x122ba1[_0x5138a7(0x244)]&&_0x122ba1[_0x5138a7(0x244)]['s'],'material':!!(_0x122ba1['components']&&_0x122ba1['components']['m']),'ritual':_0x122ba1[_0x5138a7(0x208)]&&_0x122ba1['meta'][_0x5138a7(0x191)],'concentration':!!MiscUtil['get'](_0x122ba1,'duration','0',_0x5138a7(0x1f2))},'materials':{'value':_0x8c8ba,'consumed':!!MiscUtil['get'](_0x122ba1,_0x5138a7(0x244),'m',_0x5138a7(0x1b2)),'cost':Math['round']((MiscUtil[_0x5138a7(0x1da)](_0x122ba1,_0x5138a7(0x244),'m',_0x5138a7(0x1fe))||0x0)/0x64),'supply':0x0},'target':{'value':_0x4bfe7b,'units':_0x352b5f,'type':_0x5a3d89},'range':{'value':_0x74e0ef,'units':_0x32e832,'long':null},'activation':{'type':_0x122ba1[_0x5138a7(0x245)][0x0][_0x5138a7(0x1e6)],'cost':_0x122ba1[_0x5138a7(0x245)][0x0][_0x5138a7(0x19c)],'condition':Renderer['stripTags'](_0x122ba1[_0x5138a7(0x245)][0x0][_0x5138a7(0x1cb)]||'')},'duration':{'value':_0x40c9bf,'units':_0x3e6cbb},'damage':{'parts':_0x27cb07,'versatile':''},'scaling':{'mode':_0x5b7adc?_0x5138a7(0x196):_0x4f0569?_0x5138a7(0x247):_0x5138a7(0x1d2),'formula':_0x5b7adc||_0x4f0569||''},'save':{'ability':_0x16002b,'dc':null,'scaling':_0x342a97},'ability':_0xfb842b[_0x5138a7(0x21a)]||'','uses':{'value':_0xfb842b[_0x5138a7(0x205)]||0x0,'max':_0xfb842b[_0x5138a7(0x1d4)]||0x0,'per':_0xfb842b[_0x5138a7(0x1ad)]||''},'attackBonus':null,'chatFlavor':'','critical':{'threshold':null,'damage':''},'formula':_0x5ba13c,'preparation':{'mode':_0x463aaf,'prepared':_0x2914c4},'consume':{'type':_0x8e4d01,'target':_0x30a0f3,'amount':_0x7111e8},..._0x516be1||{}},'img':_0x5a32c5,'flags':{...this['_getSpellFlags'](_0x122ba1,_0xfb842b),..._0x379995},'effects':await this[_0x5138a7(0x219)](_0x122ba1,_0x22d384,_0x5a32c5)};if(_0xfb842b[_0x5138a7(0x207)]!=null)_0x506ffb[_0x5138a7(0x1d7)]={'default':_0xfb842b[_0x5138a7(0x207)]};else{if(_0xfb842b[_0x5138a7(0x203)])_0x506ffb[_0x5138a7(0x1d7)]={'default':Config[_0x5138a7(0x1da)](_0x5138a7(0x1d6),_0x5138a7(0x248))};}return _0x506ffb;}static['_pGetSpellItem_getConsumes']({spell:_0x3da043,opts:_0x235a7a}){const _0x38c9fc=_0xda16c8,_0x313506={'type':_0x235a7a[_0x38c9fc(0x1e1)]??'','target':_0x235a7a[_0x38c9fc(0x1fc)]??null,'amount':_0x235a7a[_0x38c9fc(0x22d)]??null};if(_0x235a7a[_0x38c9fc(0x209)]){_0x313506['type']=_0x38c9fc(0x199),_0x313506[_0x38c9fc(0x1ae)]=_0x235a7a['vetConsumes']['amount']??0x1;const _0x251f94=DataConverter[_0x38c9fc(0x192)]({'consumes':_0x235a7a[_0x38c9fc(0x209)],'actor':_0x235a7a[_0x38c9fc(0x1a7)]});if(!_0x251f94)return _0x313506;return _0x313506[_0x38c9fc(0x233)]=_0x251f94['id'],_0x313506;}if(this[_0x38c9fc(0x1e8)](_0x3da043,_0x235a7a)){const _0x248c7d=Config['getSpellPointsResource']({'isValueKey':!![]});_0x313506['amount']=Parser[_0x38c9fc(0x22b)](_0x3da043[_0x38c9fc(0x247)]),_0x248c7d===ConfigConsts['C_SPELL_POINTS_RESOURCE__SHEET_ITEM']?(_0x313506['type']=_0x38c9fc(0x199),_0x313506[_0x38c9fc(0x233)]=_0x235a7a[_0x38c9fc(0x1bd)]):(_0x313506[_0x38c9fc(0x228)]='attribute',_0x313506['target']=_0x248c7d);}return _0x313506;}static[_0xda16c8(0x1af)](_0x3f9fad){const _0x1f15e7=_0xda16c8;if(!isNaN(_0x3f9fad['level'])&&_0x3f9fad[_0x1f15e7(0x247)]>=0x0&&_0x3f9fad[_0x1f15e7(0x247)]<=0x9)return Math[_0x1f15e7(0x232)](_0x3f9fad['level']);if(!isNaN(_0x3f9fad[_0x1f15e7(0x247)]))return Math[_0x1f15e7(0x235)](Math[_0x1f15e7(0x232)](_0x3f9fad[_0x1f15e7(0x247)]),0x0,0x9);return 0x0;}static async[_0xda16c8(0x230)](_0x150520){const _0x253331=_0xda16c8;return DataConverter['pGetIconImage'](_0x253331(0x1a4),_0x150520);}static[_0xda16c8(0x1d0)](_0x2b7bb2){const _0x3357db=_0xda16c8;switch(_0x2b7bb2[_0x3357db(0x1f6)]){case'A':return _0x3357db(0x1c1);case'C':return _0x3357db(0x221);case'D':return _0x3357db(0x18d);case'E':return _0x3357db(0x222);case'V':return _0x3357db(0x23a);case'I':return _0x3357db(0x237);case'N':return _0x3357db(0x214);case'T':return _0x3357db(0x1fd);}}static['_getSpellFlags'](_0x5a1f69,{parentClassName:_0x4d2733,parentClassSource:_0x3b2f56,parentSubclassName:_0x3a5152,parentSubclassSource:_0x4dfb6a}={}){const _0x3490fe=_0xda16c8,_0x4d1a7e={[SharedConsts[_0x3490fe(0x20f)]]:{'page':UrlUtil[_0x3490fe(0x1ed)],'source':_0x5a1f69['source'],'hash':UrlUtil[_0x3490fe(0x197)][UrlUtil[_0x3490fe(0x1ed)]](_0x5a1f69),'propDroppable':'spell'}};if(!_0x4d2733&&!_0x3b2f56&&!_0x3a5152&&!_0x4dfb6a)return _0x4d1a7e;return _0x4d1a7e[SharedConsts[_0x3490fe(0x20f)]][_0x3490fe(0x1a5)]=_0x4d2733,_0x4d1a7e[SharedConsts[_0x3490fe(0x20f)]][_0x3490fe(0x231)]=_0x3b2f56,_0x4d1a7e[SharedConsts[_0x3490fe(0x20f)]]['parentSubclassName']=_0x3a5152,_0x4d1a7e[SharedConsts[_0x3490fe(0x20f)]]['parentSubclassSource']=_0x4dfb6a,_0x4d1a7e;}static async['_pGetSpellEffects'](_0x1500d4,_0x46a91a,_0x3df82b){const _0xc4811a=_0xda16c8,_0x2e77d8=MiscUtil[_0xc4811a(0x240)](_0x46a91a?.[_0xc4811a(0x242)]||[]);return _0x2e77d8[_0xc4811a(0x1fa)](_0x455372=>_0x455372['icon']=_0x3df82b),await this[_0xc4811a(0x1e7)](null,_0x1500d4)&&_0x2e77d8['push'](...await this[_0xc4811a(0x1b3)](null,_0x1500d4,null,{'img':_0x3df82b})),DataConverter['mutEffectsDisabledTransfer'](_0x2e77d8,_0xc4811a(0x1d6)),_0x2e77d8;}static[_0xda16c8(0x22a)](_0xb99c3f,_0x405978){const _0x334a77=_0xda16c8;_0xb99c3f[_0x334a77(0x200)](/{@damage ([^}]+)} ([^ ]+)(, [^ ]+)*(,? or [^ ]+)? damage/ig,(..._0x55da8b)=>{const _0x180f5b=_0x334a77;_0x405978[_0x180f5b(0x21c)]([_0x55da8b[0x1],_0x55da8b[0x2]]);});}static[_0xda16c8(0x1ef)](){return/{@dice ([^}]+)}(\s*\+\s*your\s+spellcasting\s+ability\s+modifier)?/i;}static[_0xda16c8(0x23b)]({spell:_0x5246d0,opts:_0x14651c,damageTuples:_0xef79d9,isCustomDamageParts:_0x2a6edb,scaling:_0x341e6d,preparationMode:_0x537905}){const _0x10db91=_0xda16c8;if(!_0x5246d0['entriesHigherLevel'])return;const _0x1cd02f={'damageTuples':MiscUtil[_0x10db91(0x240)](_0xef79d9),'isCustomDamageParts':_0x2a6edb,'scaling':_0x341e6d},_0x20f099=/{@(?:scaledice|scaledamage) ([^}]+)}/gi,_0x1a9182=[/\badditional (?<addPerLevel>\d+) for each (?:slot )?level\b/gi,/\bincreases by (?<addPerLevel>\d+) for each (?:slot )?level\b/gi];let _0x324505=null;const _0xa1f937=new Set(),_0x4eb6ff=_0x569360=>{const _0x169945=_0x10db91;_0x569360[_0x169945(0x200)](_0x20f099,(..._0x3835b0)=>{const _0x4261df=_0x169945,[_0x4f4315]=_0x3835b0[0x1][_0x4261df(0x204)]('|')[_0x4261df(0x1a8)](_0x56d455=>_0x56d455[_0x4261df(0x1ee)]()),[_0x3b6d08,_0x31ed90]=Renderer[_0x4261df(0x1a0)](_0x3835b0[0x0][_0x4261df(0x1c8)](0x1,-0x1)),_0x365a36=Renderer['parseScaleDice'](_0x3b6d08,_0x31ed90),_0x5c3737=_0x1cd02f['damageTuples'][_0x4261df(0x1cd)](_0x86b9bf=>(_0x86b9bf[0x0]||'')[_0x4261df(0x1ee)]()['toLowerCase']()===_0x4f4315[_0x4261df(0x18e)]());if(!_0xa1f937['has'](_0x5c3737)&&~_0x5c3737){const _0x5a0678=_0x365a36?.['prompt']?.[_0x4261df(0x206)]?.[_0x14651c[_0x4261df(0x1a3)]];_0x5a0678&&(_0xa1f937[_0x4261df(0x234)](_0x5c3737),_0x1cd02f[_0x4261df(0x1b8)][_0x5c3737][0x0]+='+\x20'+_0x5a0678,_0x1cd02f[_0x4261df(0x21d)]=!![]);}}),_0x1a9182[_0x169945(0x1fa)](_0x31cda8=>{const _0x522d8e=_0x169945;_0x569360[_0x522d8e(0x200)](_0x31cda8,(..._0x15b0ad)=>{const _0x3bd750=_0x522d8e;if(!_0x1cd02f[_0x3bd750(0x1b8)][_0x3bd750(0x202)])return;const _0x5c728b=_0x14651c[_0x3bd750(0x1a3)]*Number(_0x15b0ad['last']()[_0x3bd750(0x1f1)]);_0x1cd02f[_0x3bd750(0x1b8)][0x0][0x0]+='+\x20'+_0x5c728b,_0x1cd02f[_0x3bd750(0x21d)]=!![];});});},_0x1e8231=_0x10a388=>{const _0x19ed7a=_0x10db91;if(_0x1cd02f['scaling'])return;_0x10a388[_0x19ed7a(0x200)](_0x20f099,(..._0x193407)=>{const _0x2ca8d=_0x19ed7a;if(_0x1cd02f['scaling'])return;const [,,_0x317974]=_0x193407[0x1][_0x2ca8d(0x204)]('|');_0x1cd02f['scaling']=_0x317974;}),_0x1a9182['forEach'](_0x404d3b=>{_0x10a388['replace'](_0x404d3b,(..._0x38d259)=>{const _0x188b72=_0x19c0;if(_0x1cd02f['scaling'])return;_0x1cd02f[_0x188b72(0x1b1)]=_0x38d259[_0x188b72(0x241)]()[_0x188b72(0x1f1)];});});};return _0x14651c[_0x10db91(0x1a3)]!=null&&_0x14651c['castAtLevel']!==_0x5246d0[_0x10db91(0x247)]&&_0x1cd02f[_0x10db91(0x1b8)][_0x10db91(0x202)]&&_0x537905==='innate'?_0x324505=_0x4eb6ff:_0x324505=_0x1e8231,MiscUtil[_0x10db91(0x215)]({'isNoModification':!![]})[_0x10db91(0x1cf)](_0x5246d0[_0x10db91(0x1ca)],{'string':_0x11e573=>_0x324505(_0x11e573)}),_0x1cd02f;}static[_0xda16c8(0x226)](_0x5a27b2){const _0x357f75=_0xda16c8;if(!Config[_0x357f75(0x1da)](_0x357f75(0x1d6),'isImportDescription'))return'';return UtilDataConverter['pGetWithDescriptionPlugins'](async()=>{const _0x1aa6aa=_0x357f75,_0x6a4515=await DataConverter[_0x1aa6aa(0x1bb)](_0x5a27b2),_0x339332=_0x5a27b2[_0x1aa6aa(0x1ca)]?await DataConverter[_0x1aa6aa(0x1bb)](_0x5a27b2,{'prop':_0x1aa6aa(0x1ca)}):'',_0x4a2865=[_0x6a4515,_0x339332];if(Config[_0x1aa6aa(0x1da)](_0x1aa6aa(0x1d6),'isIncludeClassesInDescription')){const _0x2d2c3b=Renderer[_0x1aa6aa(0x1a4)][_0x1aa6aa(0x236)](_0x5a27b2,_0x1aa6aa(0x1b6));if(_0x2d2c3b?.[_0x1aa6aa(0x202)]){const [_0x17d052]=Parser[_0x1aa6aa(0x21e)](_0x2d2c3b);_0x4a2865['push'](_0x1aa6aa(0x1ab)+Parser['spMainClassesToFull'](_0x17d052,{'isTextOnly':!![]})+'</div>');}}return _0x4a2865[_0x1aa6aa(0x1c0)](Boolean)[_0x1aa6aa(0x195)]('');});}static async[_0xda16c8(0x239)](_0x263609,{targetUnits:_0x574c61}={}){const _0x21d574=_0xda16c8,_0x559901=await super[_0x21d574(0x239)](_0x263609);if(!_0x559901)return _0x559901;if(_0x559901[_0x21d574(0x238)])_0x559901[_0x21d574(0x238)]=Config[_0x21d574(0x21f)]({'configGroup':_0x21d574(0x1d6),'originalValue':_0x559901['target.value'],'originalUnit':_0x559901[_0x21d574(0x243)]||_0x574c61});if(_0x559901[_0x21d574(0x243)])_0x559901[_0x21d574(0x243)]=Config[_0x21d574(0x1e3)]({'configGroup':_0x21d574(0x1d6),'originalUnit':_0x559901[_0x21d574(0x243)]||_0x574c61});return _0x559901;}static['getActorSpell'](_0x4d644b,_0x5a6fba,_0x5223ff){const _0x586600=_0xda16c8;if(!_0x5a6fba||!_0x5223ff)return null;return _0x4d644b[_0x586600(0x1b7)]&&_0x4d644b['items'][_0x586600(0x1ce)](_0x3758b9=>(_0x3758b9['name']||'')['toLowerCase']()===_0x5a6fba[_0x586600(0x18e)]()&&(!Config[_0x586600(0x1da)](_0x586600(0x19b),_0x586600(0x1dd))||(UtilDataConverter[_0x586600(0x198)](_0x3758b9)[_0x586600(0x1fb)]||'')['toLowerCase']()===_0x5223ff[_0x586600(0x18e)]()));}static async[_0xda16c8(0x1df)](_0x43c855,_0x5f3831){const _0x2c5783=_0xda16c8;if(!_0x43c855)return;await UtilDocuments[_0x2c5783(0x1db)](_0x43c855,{'data':{'preparation':{'prepared':_0x5f3831}}});}static async['pHasSpellSideLoadedEffects'](_0x1683fd,_0x3682ac){const _0x3f2621=_0xda16c8;return(await DataConverter[_0x3f2621(0x20a)](_0x3682ac,this[_0x3f2621(0x216)]))?.['length']>0x0;}static async['pGetSpellItemEffects'](_0x479fe2,_0x279107,_0x1b01cf,{additionalData:_0x5eb12d,img:_0x24ab20}={}){const _0x5b4e37=_0xda16c8,_0x454af4=await DataConverter[_0x5b4e37(0x20a)](_0x279107,this['_SIDE_LOAD_OPTS']);return UtilActiveEffects[_0x5b4e37(0x20b)](_0x454af4||[],{'actor':_0x479fe2,'sheetItem':_0x1b01cf,'parentName':_0x279107[_0x5b4e37(0x1f5)],'additionalData':_0x5eb12d,'img':_0x24ab20});}}export{DataConverterSpell};