const _0x56adf3=_0x1aee;(function(_0x3c240b,_0x291324){const _0x125ec6=_0x1aee,_0x30fa94=_0x3c240b();while(!![]){try{const _0x229aa2=-parseInt(_0x125ec6(0x20e))/0x1*(-parseInt(_0x125ec6(0x201))/0x2)+-parseInt(_0x125ec6(0x1de))/0x3+-parseInt(_0x125ec6(0x1fc))/0x4*(parseInt(_0x125ec6(0x239))/0x5)+-parseInt(_0x125ec6(0x1c9))/0x6*(parseInt(_0x125ec6(0x269))/0x7)+parseInt(_0x125ec6(0x213))/0x8+parseInt(_0x125ec6(0x1e0))/0x9+parseInt(_0x125ec6(0x288))/0xa;if(_0x229aa2===_0x291324)break;else _0x30fa94['push'](_0x30fa94['shift']());}catch(_0x18b312){_0x30fa94['push'](_0x30fa94['shift']());}}}(_0x48b7,0x4217b));import{SharedConsts}from'../shared/SharedConsts.js';import{Util,LGT}from'./Util.js';import{Config}from'./Config.js';import{UtilCanvas}from'./UtilCanvas.js';import{ArtBrowser}from'../art-js/ArtBrowser.js';import{UtilApplications}from'./UtilApplications.js';import{ConfigConsts}from'./ConfigConsts.js';function _0x48b7(){const _0x3c6fbb=['bind','host','_handleConfigUpdate','closest','1553826Rwwdig','getPosCanvasSpace','json','isSceneAddToNavigation','HK_CONFIG_UPDATE','foreground','getElementById','artBrowser','_textDownloadMode','STR_SEE_CONSOLE','control','round','.window-content','then','get','Hi!\x20You\x20shouldn\x27t\x20be\x20able\x20to\x20click\x20this,\x20something\x20has\x20gone\x20wrong.','notes','C_ART_IMAGE_MODE_SCENE','getDropJson','create','_active','1353504dJqsVI','<div\x20class=\x22artr__item__menu_item\x22\x20title=\x22Download\x20Image\x22><span\x20class=\x22fas\x20fa-fw\x20fa-download\x22></span></div>','3601287DiyWXZ','_pPingImage','importImagesAs','plutonium__art__hide-main-button','<span\x20class=\x22fas\x20fa-fw\x20fa-bookmark\x22></span>','icons/svg/book.svg','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22><span\x20class=\x22fas\x20fa-fw\x20fa-spinner\x22></span></button>','_pDoLoadAndPlaceImage_pGetImageMeta','pLoadImage','_pLoadImageViaBackend','Image\x20downloaded\x20to\x20your\x20Art\x20Directory\x20(\x22','currentTarget','createEmbeddedDocuments','register','_handleConfigUpdate_isRefreshControls','p-0','displayProgressBar','\x20-\x20Tokens','getSafe','backendEndpoint','C_ART_IMAGE_SAVE_MODE__DEFAULT','error','NotesLayer','_$btnCycleImportMode','token','Close','artBrowserCancelDownloadPack','setApplicationTitle','590756BZennU','replace','close','render','notifications','23416GkyLof','\x20-\x20Scenes','_pOpen','_handleCustomDrop','_BLOCKED_HOSTS','preventDefault','_INSTANCE','dataset','unshift','_preInit_addNotesButton','Could\x20not\x20directly\x20load\x20image\x20from\x20','imageSaveMode','_preInit_addSubmenuButton','39pNuDPn','Config\x20window\x22><span\x20class=\x22fas\x20fa-fw\x20fa-cogs\x22></span></button>','MODULE_TITLE_FAKE','_preInit_getInnerToolMeta','Plutonium\x20','3491512nnGzoy','application/json','scenePadding','board','catch','_handleInstanceConfigUpdate','socket','max','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x20mr-1\x22\x20title=\x22Cancel\x20running\x20downloads\x22><span\x20class=\x22fas\x20fa-fw\x20fa-stop\x22></span></button>','C_ART_IMAGE_MODE_TILE','uri','<i\x20class=\x22fas\x20fa-fw\x20fa-times\x22></i>','_preInit_addTileButton','_pCopyImageToLocalViaBackend','Drag-Drop\x20Images\x20as\x20Tiles','split','some','last','getMaxWindowHeight','plutonium__art__hide-token-button','isStreamerMode','<span\x20class=\x22fas\x20fa-fw\x20fa-user\x22></span>','C_ART_IMAGE_MODE_NOTE','isSwitchToCreatedScene','Unhandled\x20drop\x20mode\x20\x22','_ID_HIDE_NOTES_BUTTON','preInit','pct','artBrowserCopyToLocal','_preInit_registerKeybinds','push','body','appendTo','name','tokenSize','Drag-Drop\x20Images\x20as\x20Notes','MODULE_LOCATION','find','10QmYGoz','init','pInit','MODULE_TITLE','set','draw','_preInit_addMainButton','\x20backend\x20mod.\x20See\x20the\x20&quot;How\x20to\x20Modify\x20the\x20Backend&quot;\x20section\x20on\x20the\x20<a\x20href=\x22https://wiki.tercept.net/en/Plutonium/Plutonium_Installation\x22\x20target=\x22_blank\x22\x20rel=\x22noopener\x20noreferrer\x22>wiki</a>\x20for\x20more\x20information.</p>\x0a\x09\x09\x09\x09\x09<p><b>Note\x20that\x20this\x20is\x20not\x20possible\x20on\x20managed\x20Foundry\x20hosting\x20services,\x20such\x20as\x20The\x20Forge.</b></p>\x0a\x09\x09\x09\x09</div>','tools','_pDoLoadAndPlaceImage','fas\x20fa-fw\x20fa-palette','activateListeners','Drag-Drop\x20Images\x20as\x20Scenes','stringify','MODULE_NAME','dragstart','getData','_handleInstanceConfigUpdate_cycleImportModeButton','buttonDisplay','doDownloadSingleImage_','_BASE_TITLE','scale','BackgroundLayer','Failed\x20to\x20download\x20image!\x20','__bound__handleInstanceConfigUpdate','_activateListeners_pHandleDownloadAssets','<span\x20class=\x22fas\x20fa-fw\x20fa-map\x22></span>','.artr__search','html','_doCancelPackDownload','isSceneGridMetric','_pDownloadPack','_ART_SCENE_CONTROLS_NAME','type','_onClickLayer','â€”falling\x20back\x20on\x20alternate\x20loader\x20(backend\x20mod).','constructor','off','C_ART_IMAGE_SAVE_MODE__ALWAYS','addClass','_isDownloadingPack','C_ART_IMAGE_SAVE_MODE__NEVER','ve-art__btn-scene','P_GET_BACKEND_VERSION','_pDoLoadAndPlaceImage_pDoLoadViaBackend','stopPropagation','_p$getBtnsItemThumbnail','post','14mAEHTP','progress','Download\x20complete!\x20Images\x20will\x20be\x20available\x20in\x20your\x20\x22User\x20Data\x22\x20directory.','Foundry\x20Assets','getMetricNumberDistance','<button\x20class=\x22artr__btn-lg\x20artr__btn-lg--search-controls\x22\x20title=\x22Open\x20','maximize','naturalWidth','_pGetDownloadModes','controls','C_ART_IMAGE_MODE_TOKEN','info','getMaxWindowWidth','tiles','addEventListener','scene','title','plutonium__art__hide-notes-button','isInit','click','artDirectoryPath','Open\x20Art\x20Browser','text','_jsonDownloadMode','getSceneControlButtons','/template/ArtBrowserApp.hbs','Failed\x20to\x20load\x20image!\x20','_parent','Art\x20Browser','sceneBackgroundColor','\x20-\x20Notes','2420090XOAxHP','isSceneFogExploration'];_0x48b7=function(){return _0x3c6fbb;};return _0x48b7();}import{UtilEvents}from'./UtilEvents.js';import{UtilHooks}from'./UtilHooks.js';import{UtilImage}from'./UtilImage.js';import{UtilGameSettings}from'./UtilGameSettings.js';class ArtBrowserFvtt extends ArtBrowser{constructor(_0x35c85e,{app:_0x3ea714}){const _0x8944da=_0x1aee;super(_0x35c85e),this[_0x8944da(0x284)]=_0x3ea714;}async[_0x56adf3(0x271)](){const _0x35ead0=_0x56adf3,_0x6061c0=[this[_0x35ead0(0x1d1)],this[_0x35ead0(0x280)]];return await Config[_0x35ead0(0x264)]&&_0x6061c0[_0x35ead0(0x209)]({'name':_0x35ead0(0x26c),'isMultipleFilesOnly':!![],'pDownloadAsMultipleFiles':(_0x5ec544,_0x5d5af7,_0x4d06a6)=>this[_0x35ead0(0x284)]['_activateListeners_pHandleDownloadAssets'](_0x5ec544,_0x5d5af7,_0x4d06a6)}),_0x6061c0;}async['_p$getBtnsItemThumbnail'](_0x52200f){const _0x176e39=_0x56adf3,_0x5162f4=await super[_0x176e39(0x267)](_0x52200f);if(!await Config[_0x176e39(0x264)])return _0x5162f4;const _0xe23305=$(_0x176e39(0x1df))[_0x176e39(0x27c)](async _0x2250df=>{const _0x5407cf=_0x176e39;_0x2250df['stopPropagation'](),_0x2250df[_0x5407cf(0x206)](),await this[_0x5407cf(0x284)][_0x5407cf(0x24c)](_0x52200f);});return[..._0x5162f4,_0xe23305];}}function _0x1aee(_0x4ef947,_0x493bbb){const _0x48b70a=_0x48b7();return _0x1aee=function(_0x1aeeb2,_0x377b41){_0x1aeeb2=_0x1aeeb2-0x1c4;let _0x1f36c4=_0x48b70a[_0x1aeeb2];return _0x1f36c4;},_0x1aee(_0x4ef947,_0x493bbb);}class ArtBrowserApp extends Application{static[_0x56adf3(0x22d)](){const _0x23659d=_0x56adf3;Hooks['on'](_0x23659d(0x281),_0x188035=>{const _0x211807=_0x23659d;if(!game['user']['isGM'])return;this[_0x211807(0x23f)](_0x188035),this[_0x211807(0x21f)](_0x188035),this['_preInit_addTokenButton'](_0x188035),this['_preInit_addNotesButton'](_0x188035);}),this['_preInit_registerKeybinds']();}static[_0x56adf3(0x230)](){const _0x39f2a1=_0x56adf3;game['keybindings'][_0x39f2a1(0x1ed)](SharedConsts[_0x39f2a1(0x247)],'ArtBrowserApp__open',{'name':_0x39f2a1(0x27e),'editable':[],'onDown':()=>{const _0x1830bd=_0x39f2a1;return this[_0x1830bd(0x203)](),!![];},'restricted':!![]});}static['_pOpen'](){const _0x33ad3b=_0x56adf3;if(ArtBrowserApp[_0x33ad3b(0x207)]){ArtBrowserApp[_0x33ad3b(0x207)][_0x33ad3b(0x1ff)](!![]),ArtBrowserApp[_0x33ad3b(0x207)][_0x33ad3b(0x26f)](),UtilApplications['bringToFront'](ArtBrowserApp[_0x33ad3b(0x207)]);return;}ArtBrowserApp['_INSTANCE']=new ArtBrowserApp(),ArtBrowserApp[_0x33ad3b(0x207)]['render'](!![]);}static['_preInit_addMainButton'](_0x4f5b07){const _0x44975a=_0x56adf3,_0x4b5e04=_0x4f5b07['find'](_0xdc054c=>_0xdc054c['name']===ArtBrowserApp[_0x44975a(0x259)]);if(_0x4b5e04)return;_0x4f5b07[_0x44975a(0x231)]({'name':ArtBrowserApp['_ART_SCENE_CONTROLS_NAME'],'title':_0x44975a(0x285),'icon':_0x44975a(0x243),'tools':[{'name':ArtBrowserApp['_ART_SCENE_CONTROLS_NAME'],'title':_0x44975a(0x285),'icon':'fas\x20fa-fw\x20fa-palette','onClick':()=>ui[_0x44975a(0x200)]['info'](_0x44975a(0x1d8)),'button':!![]}],'visible':Config[_0x44975a(0x27b)]&&Config[_0x44975a(0x1d7)](_0x44975a(0x1d0),_0x44975a(0x24b))[ConfigConsts[_0x44975a(0x1da)]],'activeTool':'open'});}static[_0x56adf3(0x211)](_0x68f51a){const _0x333f44=_0x56adf3;return{'name':ArtBrowserApp[_0x333f44(0x259)],'title':_0x333f44(0x285),'icon':'fas\x20fa-fw\x20fa-palette','onClick':()=>{const _0x488d37=_0x333f44;Config['set'](_0x488d37(0x1d0),_0x488d37(0x1e2),_0x68f51a),ArtBrowserApp['_pOpen']();},'visible':Config[_0x333f44(0x27b)]&&Config[_0x333f44(0x1d7)]('artBrowser','buttonDisplay')[_0x68f51a],'button':!![]};}static[_0x56adf3(0x21f)](_0x48eca4){const _0x49d9c5=_0x56adf3;this[_0x49d9c5(0x20d)](_0x48eca4,_0x49d9c5(0x276),ConfigConsts[_0x49d9c5(0x21c)]);}static['_preInit_addTokenButton'](_0x2f58b0){const _0x826d6a=_0x56adf3;this[_0x826d6a(0x20d)](_0x2f58b0,_0x826d6a(0x1f8),ConfigConsts[_0x826d6a(0x273)]);}static[_0x56adf3(0x20a)](_0x4fd95d){const _0x3ba6d2=_0x56adf3;this[_0x3ba6d2(0x20d)](_0x4fd95d,_0x3ba6d2(0x1d9),ConfigConsts['C_ART_IMAGE_MODE_NOTE']);}static[_0x56adf3(0x20d)](_0x3c6fdd,_0x23ea23,_0xb9effc){const _0x42ab42=_0x56adf3,_0xb6f714=_0x3c6fdd[_0x42ab42(0x238)](_0x117849=>_0x117849[_0x42ab42(0x234)]===_0x23ea23),_0x4307f0=_0xb6f714[_0x42ab42(0x241)][_0x42ab42(0x223)](_0x30e28d=>_0x30e28d[_0x42ab42(0x234)]===ArtBrowserApp[_0x42ab42(0x259)]);if(_0x4307f0)return;_0xb6f714[_0x42ab42(0x241)][_0x42ab42(0x231)](this[_0x42ab42(0x211)](_0xb9effc));}static async[_0x56adf3(0x258)](_0x330774){const _0x3090a7=_0x56adf3;await fetch(Config[_0x3090a7(0x1f3)],{'method':_0x3090a7(0x268),'headers':{'Content-Type':_0x3090a7(0x214)},'body':JSON[_0x3090a7(0x246)]({'type':'artBrowserDownloadPack','json':_0x330774,'directoryPath':Config[_0x3090a7(0x1d7)](_0x3090a7(0x1d0),_0x3090a7(0x27d))})});}static[_0x56adf3(0x23a)](){const _0x2240c0=_0x56adf3,_0x1cc867=ui[_0x2240c0(0x272)][_0x2240c0(0x25b)][_0x2240c0(0x1c5)](ui[_0x2240c0(0x272)]);ui['controls'][_0x2240c0(0x25b)]=function(_0xe704d8){const _0x1a95ac=_0x2240c0;if(_0xe704d8[_0x1a95ac(0x1eb)][_0x1a95ac(0x208)][_0x1a95ac(0x1d3)]===ArtBrowserApp['_ART_SCENE_CONTROLS_NAME']){ArtBrowserApp[_0x1a95ac(0x203)]();return;}_0x1cc867(_0xe704d8);},$(document[_0x2240c0(0x232)])['on'](_0x2240c0(0x248),'.artr__item__lnk-fullsize',_0x190877=>{const _0x558145=_0x2240c0;_0x190877[_0x558145(0x266)]();}),!UtilGameSettings[_0x2240c0(0x1f2)]('core','noCanvas')&&document[_0x2240c0(0x1cf)](_0x2240c0(0x216))[_0x2240c0(0x277)]('drop',this[_0x2240c0(0x204)][_0x2240c0(0x1c5)](this)),game[_0x2240c0(0x219)]['on'](_0x2240c0(0x26a),_0x50a566=>{const _0x10f181=_0x2240c0;if(_0x50a566[_0x10f181(0x25a)]!=='plutoniumDownloadPackImage')return;if(!ArtBrowserApp[_0x10f181(0x207)])return;if(!ArtBrowserApp['_INSTANCE'][_0x10f181(0x261)])return;SceneNavigation[_0x10f181(0x1f0)]({'label':_0x50a566[_0x10f181(0x27f)],'pct':_0x50a566[_0x10f181(0x22e)]});}),UtilHooks['on'](UtilHooks[_0x2240c0(0x1cd)],_0x1c29d1=>this[_0x2240c0(0x1c7)](_0x1c29d1)),this[_0x2240c0(0x1c7)]({'isInit':!![]});}constructor(){const _0x4ae7bb=_0x56adf3;super({'title':ArtBrowserApp[_0x4ae7bb(0x24d)],'template':SharedConsts[_0x4ae7bb(0x237)]+_0x4ae7bb(0x282),'height':Util[_0x4ae7bb(0x225)](),'width':Math[_0x4ae7bb(0x21a)](0x30c,Util[_0x4ae7bb(0x275)]()/0x2),'resizable':!![]}),this[_0x4ae7bb(0x261)]=![],this[_0x4ae7bb(0x1f7)]=null,this['__bound__handleInstanceConfigUpdate']=null;}static['_handleConfigUpdate']({isInit:isInit=![],current:_0x5edb0d,previous:_0x14945f}={}){const _0x4761ce=_0x56adf3;if(!this[_0x4761ce(0x1ee)]({'isInit':isInit,'current':_0x5edb0d,'previous':_0x14945f}))return;if(ui['controls'])ui['controls']['initialize']();}static[_0x56adf3(0x1ee)]({isInit:isInit=![],current:_0xc83dbf,previous:_0x104fed}={}){const _0x339d47=_0x56adf3;if(isInit)return!![];if(!_0xc83dbf||!_0x104fed)return![];const _0x26c869=[_0x339d47(0x1d0),_0x339d47(0x24b)];return!CollectionUtil['deepEquals'](MiscUtil[_0x339d47(0x1d7)](_0xc83dbf,..._0x26c869),MiscUtil[_0x339d47(0x1d7)](_0x104fed,..._0x26c869));}[_0x56adf3(0x218)](){this['_handleInstanceConfigUpdate_cycleImportModeButton']();}[_0x56adf3(0x24a)](){const _0x4f0117=_0x56adf3,_0x58873b=Config[_0x4f0117(0x1d7)](_0x4f0117(0x1d0),_0x4f0117(0x1e2))??0x0;switch(_0x58873b){case ConfigConsts['C_ART_IMAGE_MODE_TOKEN']:this['_$btnCycleImportMode'][_0x4f0117(0x255)](_0x4f0117(0x228))['title']('Drag-Drop\x20Images\x20as\x20Tokens'),UtilApplications['setApplicationTitle'](this,ArtBrowserApp[_0x4f0117(0x24d)]+_0x4f0117(0x1f1));break;case ConfigConsts['C_ART_IMAGE_MODE_TILE']:this[_0x4f0117(0x1f7)][_0x4f0117(0x255)]('<span\x20class=\x22fas\x20fa-fw\x20fa-cubes\x22></span>')[_0x4f0117(0x279)](_0x4f0117(0x221)),UtilApplications['setApplicationTitle'](this,ArtBrowserApp[_0x4f0117(0x24d)]+'\x20-\x20Tiles');break;case ConfigConsts[_0x4f0117(0x229)]:this[_0x4f0117(0x1f7)]['html'](_0x4f0117(0x1e4))['title'](_0x4f0117(0x236)),UtilApplications[_0x4f0117(0x1fb)](this,ArtBrowserApp[_0x4f0117(0x24d)]+_0x4f0117(0x287));break;case ConfigConsts['C_ART_IMAGE_MODE_SCENE']:this[_0x4f0117(0x1f7)]['html'](_0x4f0117(0x253))[_0x4f0117(0x279)](_0x4f0117(0x245)),UtilApplications[_0x4f0117(0x1fb)](this,ArtBrowserApp['_BASE_TITLE']+_0x4f0117(0x202));break;default:throw new Error(_0x4f0117(0x22b)+_0x58873b+'\x22');}}[_0x56adf3(0x249)](){const _0x4b97d7=_0x56adf3;return{'owner':!![],'entity':{'name':_0x4b97d7(0x285)}};}[_0x56adf3(0x244)](_0x5e584d){const _0x35a045=_0x56adf3;this[_0x35a045(0x251)]=this[_0x35a045(0x218)][_0x35a045(0x1c5)](this),UtilHooks['on'](UtilHooks[_0x35a045(0x1cd)],this[_0x35a045(0x251)]),_0x5e584d[_0x35a045(0x1c8)](_0x35a045(0x1d5))['addClass'](_0x35a045(0x1ef))[_0x35a045(0x260)]('artb__window-outer');const _0x3ea28e=new ArtBrowserFvtt(_0x5e584d,{'app':this});_0x3ea28e[_0x35a045(0x23b)]()[_0x35a045(0x1d6)](()=>{const _0x5a578c=_0x35a045,_0x470402=_0x5e584d[_0x5a578c(0x238)](_0x5a578c(0x254)),_0x2e65c7=$(_0x5a578c(0x21b))[_0x5a578c(0x27c)](()=>ArtBrowserApp[_0x5a578c(0x256)]());this['_$btnCycleImportMode']=$(_0x5a578c(0x1e6))[_0x5a578c(0x27c)](()=>{const _0x270eee=_0x5a578c,_0x5450d5=Config[_0x270eee(0x1d7)]('artBrowser',_0x270eee(0x1e2))||0x0,_0x375ab6=_0x5450d5===ConfigConsts[_0x270eee(0x1da)]?ConfigConsts[_0x270eee(0x273)]:_0x5450d5+0x1;Config[_0x270eee(0x23d)](_0x270eee(0x1d0),'importImagesAs',_0x375ab6);});const _0x49b7a7=$(_0x5a578c(0x26e)+(Config[_0x5a578c(0x1d7)]('ui',_0x5a578c(0x227))?'':_0x5a578c(0x212))+_0x5a578c(0x20f))[_0x5a578c(0x27c)](_0x258894=>Config['pHandleButtonClick'](_0x258894,'artBrowser'));$$`<div class="ve-flex-v-center h-100">
					<div class="artr__search__divider mx-2"></div>
					<div class="ve-flex-v-center">${_0x2e65c7}</div>
					<div class="ve-flex-v-center">${this['_$btnCycleImportMode']}</div>
					<div class="ve-flex-v-center">${_0x49b7a7}</div>
				</div>`[_0x5a578c(0x233)](_0x470402),this[_0x5a578c(0x251)]();});}static async[_0x56adf3(0x256)](){const _0x5afe1c=_0x56adf3;await fetch(Config[_0x5afe1c(0x1f3)],{'method':'post','headers':{'Content-Type':'application/json'},'body':JSON['stringify']({'type':_0x5afe1c(0x1fa)})});}async[_0x56adf3(0x252)](_0x1322c5,_0xd7f58d,_0x231c73){const _0x733ffe=_0x56adf3;try{ArtBrowserApp['_INSTANCE'][_0x733ffe(0x261)]=!![],await ArtBrowserApp['_pDownloadPack'](_0x1322c5);}catch(_0x259df2){ArtBrowserApp[_0x733ffe(0x207)]['_isDownloadingPack']=![];}_0xd7f58d+0x1===_0x231c73&&(ArtBrowserApp[_0x733ffe(0x207)]['_isDownloadingPack']=![],ui[_0x733ffe(0x200)]['info'](_0x733ffe(0x26b)));}async[_0x56adf3(0x24c)](_0x4dab1a){const _0x3a8829=_0x56adf3;try{await this[_0x3a8829(0x25d)][_0x3a8829(0x1e9)](_0x4dab1a[_0x3a8829(0x21d)]),ui[_0x3a8829(0x200)][_0x3a8829(0x274)](_0x3a8829(0x1ea)+Config[_0x3a8829(0x1d7)](_0x3a8829(0x1d0),_0x3a8829(0x27d))+'\x22)');}catch(_0x1bf3bb){ui[_0x3a8829(0x200)]['error'](_0x3a8829(0x250)+VeCt[_0x3a8829(0x1d2)]);}}static['_handleCustomDrop'](_0x464ced){const _0x2d0474=_0x56adf3,_0x1f617f=UtilEvents[_0x2d0474(0x1db)](_0x464ced);if(_0x1f617f?.[_0x2d0474(0x25a)]!=='ve-Art')return;return this[_0x2d0474(0x242)](_0x464ced,_0x1f617f)[_0x2d0474(0x217)](_0x57ab04=>{const _0x104acb=_0x2d0474;ui[_0x104acb(0x200)][_0x104acb(0x1f5)](_0x104acb(0x283)+VeCt['STR_SEE_CONSOLE']),setTimeout(()=>{throw _0x57ab04;});}),![];}static async['_pDoLoadAndPlaceImage'](_0x5aa426,_0x2ce328){const _0x18b35f=_0x56adf3,_0x16cd0f=Config[_0x18b35f(0x1d7)](_0x18b35f(0x1d0),'importImagesAs')??0x0,_0x37920e=await this[_0x18b35f(0x1e7)]({'url':_0x2ce328[_0x18b35f(0x21d)]});if(!_0x37920e)return;const {url:_0x3f6d31,image:_0x553cde}=_0x37920e,_0x277a67=()=>{const _0x234491=_0x18b35f;let _0x41bbc1=_0x3f6d31['split']('/')[_0x234491(0x224)]();try{_0x41bbc1=decodeURIComponent(_0x41bbc1),_0x41bbc1=_0x41bbc1[_0x234491(0x222)]('.')[0x0],_0x41bbc1=_0x41bbc1[_0x234491(0x1fd)](/_/g,'\x20')[_0x234491(0x1fd)](/\s+/g,'\x20')[_0x234491(0x1fd)](/\d+\s*[xX*]\s*\d+/g,'');}catch(_0x317e4b){}return _0x41bbc1;},_0xe9e482=_0x553cde[_0x18b35f(0x270)],_0x5c74f9=_0x553cde['naturalHeight'],_0x1f727a=Config['get']('artBrowser',_0x18b35f(0x24e));switch(_0x16cd0f){case ConfigConsts['C_ART_IMAGE_MODE_TOKEN']:{const _0x423223=UtilCanvas[_0x18b35f(0x1ca)](_0x5aa426,'TokenLayer'),_0x562150=Config[_0x18b35f(0x1d7)]('artBrowser',_0x18b35f(0x235))||0x1;TokenDocument[_0x18b35f(0x1dc)]({'name':'-','x':_0x423223['x'],'y':_0x423223['y'],'img':encodeURL(_0x3f6d31),'width':_0x562150,'height':_0x562150,'scale':0x1},{'parent':canvas[_0x18b35f(0x278)]});break;}case ConfigConsts[_0x18b35f(0x21c)]:{const _0x379f2c=UtilCanvas[_0x18b35f(0x1ca)](_0x5aa426,_0x18b35f(0x24f));await canvas[_0x18b35f(0x278)][_0x18b35f(0x1ec)]('Tile',[{'img':encodeURL(_0x3f6d31),'width':Math['round'](_0xe9e482*_0x1f727a),'height':Math[_0x18b35f(0x1d4)](_0x5c74f9*_0x1f727a),'hidden':![],'scale':_0x1f727a,'x':_0x379f2c['x'],'y':_0x379f2c['y'],'overhead':canvas[_0x18b35f(0x1ce)]?.[_0x18b35f(0x1dd)]??![]}]);break;}case ConfigConsts[_0x18b35f(0x229)]:{const _0x5568b3=UtilCanvas[_0x18b35f(0x1ca)](_0x5aa426,_0x18b35f(0x1f6)),_0x2bd2da=await JournalEntry['create']({'name':_0x277a67(),'img':encodeURL(_0x3f6d31)});await canvas[_0x18b35f(0x278)][_0x18b35f(0x1ec)]('Note',[{'entryId':_0x2bd2da['id'],'icon':_0x18b35f(0x1e5),'iconSize':0x28,'text':'','x':_0x5568b3['x'],'y':_0x5568b3['y']}]);break;}case ConfigConsts[_0x18b35f(0x1da)]:{const _0x2d5b00=Config[_0x18b35f(0x1d7)]('artBrowser',_0x18b35f(0x22a)),_0x46275c={'name':_0x277a67(),'active':_0x2d5b00,'navigation':Config['get']('artBrowser',_0x18b35f(0x1cc)),'img':encodeURL(_0x3f6d31),'width':Math['round'](_0xe9e482*_0x1f727a),'height':Math[_0x18b35f(0x1d4)](_0x5c74f9*_0x1f727a),'padding':Config[_0x18b35f(0x1d7)](_0x18b35f(0x1d0),_0x18b35f(0x215)),'backgroundColor':Config['get']('artBrowser',_0x18b35f(0x286)),'tokenVision':Config['get'](_0x18b35f(0x1d0),'isSceneTokenVision'),'fogExploration':Config[_0x18b35f(0x1d7)]('artBrowser',_0x18b35f(0x1c4)),'gridDistance':Config['getMetricNumberDistance']({'configGroup':_0x18b35f(0x1d0),'originalValue':0x5,'originalUnit':'ft','configKey':_0x18b35f(0x257)}),'gridUnits':Config[_0x18b35f(0x26d)]({'configGroup':_0x18b35f(0x1d0),'originalUnit':'ft','configKey':'isSceneGridMetric'})},_0x38947d=await Scene[_0x18b35f(0x1dc)](_0x46275c,{'renderSheet':Config[_0x18b35f(0x1d7)](_0x18b35f(0x1d0),'isDisplaySheetCreatedScene')});if(_0x2d5b00)canvas[_0x18b35f(0x23e)]();break;}}}static async[_0x56adf3(0x1e7)]({url:_0x532c6e}){const _0x12ae53=_0x56adf3;switch(Config['get'](_0x12ae53(0x1d0),_0x12ae53(0x20c))){case ConfigConsts[_0x12ae53(0x1f4)]:{if(await this[_0x12ae53(0x1e1)](_0x532c6e)){const _0x1d4232=await UtilImage['pLoadImage'](_0x532c6e);return{'image':_0x1d4232,'url':_0x532c6e};}return this[_0x12ae53(0x265)]({'url':_0x532c6e});}case ConfigConsts[_0x12ae53(0x25f)]:{return this['_pDoLoadAndPlaceImage_pDoLoadViaBackend']({'url':_0x532c6e});}case ConfigConsts[_0x12ae53(0x262)]:{if(await this[_0x12ae53(0x1e1)](_0x532c6e)){const _0x52ea8c=await UtilImage[_0x12ae53(0x1e8)](_0x532c6e);return{'image':_0x52ea8c,'url':_0x532c6e};}return null;}}}static async['_pDoLoadAndPlaceImage_pDoLoadViaBackend']({url:_0x509777}){const _0x3a8096=_0x56adf3;if(await Config[_0x3a8096(0x264)]){if(Config[_0x3a8096(0x1d7)](_0x3a8096(0x1d0),_0x3a8096(0x20c))!==ConfigConsts[_0x3a8096(0x25f)])console['warn'](...LGT,_0x3a8096(0x20b)+_0x509777+_0x3a8096(0x25c));try{const _0x693aff=await this[_0x3a8096(0x1e9)](_0x509777);return void _0x693aff,_0x693aff;}catch(_0x41f4d8){console[_0x3a8096(0x1f5)](...LGT,'Failed\x20to\x20load\x20image!',_0x41f4d8),ui[_0x3a8096(0x200)][_0x3a8096(0x1f5)]('Failed\x20to\x20load\x20image!\x20'+VeCt[_0x3a8096(0x1d2)]);return;}}new Dialog({'title':'Art\x20Browserâ€”Backend\x20Mod\x20Required','content':'<div>\x0a\x09\x09\x09\x09\x09<p>The\x20image\x20you\x20dropped\x20could\x20not\x20be\x20loaded,\x20likely\x20due\x20to\x20CORS\x20blocking.\x20CORS\x20blocking\x20is\x20a\x20browser\x20security\x20feature\x20which\x20prevents\x20potentially\x20harmful\x20content\x20from\x20being\x20loaded\x20from\x20other\x20websites.</p>\x0a\x09\x09\x09\x09\x09<p>Unfortunately,\x20this\x20security\x20feature\x20also\x20blocks\x20images.\x20In\x20order\x20to\x20work\x20around\x20this,\x20you\x20can\x20install\x20the\x20'+(Config[_0x3a8096(0x1d7)]('ui','isStreamerMode')?SharedConsts[_0x3a8096(0x210)]:SharedConsts[_0x3a8096(0x23c)])+_0x3a8096(0x240),'buttons':{'one':{'icon':_0x3a8096(0x21e),'label':_0x3a8096(0x1f9)}}})[_0x3a8096(0x1ff)](!![]);}static async[_0x56adf3(0x1e1)](_0x57f5b7){const _0x48358a=_0x56adf3;let _0x414614;try{_0x414614=new URL(_0x57f5b7);}catch(_0x5a24dd){}if(_0x414614&&ArtBrowserApp['_BLOCKED_HOSTS'][_0x414614[_0x48358a(0x1c6)]])return![];try{const _0x8f5f6e=await fetch(_0x57f5b7);return await _0x8f5f6e['blob'](),!![];}catch(_0x3d755e){if(_0x414614)ArtBrowserApp[_0x48358a(0x205)][_0x414614[_0x48358a(0x1c6)]]=!![];return![];}}static async[_0x56adf3(0x220)](_0x8ba1a3){const _0x4a2fbc=_0x56adf3,_0x472aab=await fetch(Config['backendEndpoint'],{'method':_0x4a2fbc(0x268),'headers':{'Content-Type':_0x4a2fbc(0x214)},'body':JSON[_0x4a2fbc(0x246)]({'type':_0x4a2fbc(0x22f),'url':_0x8ba1a3,'directoryPath':Config[_0x4a2fbc(0x1d7)](_0x4a2fbc(0x1d0),_0x4a2fbc(0x27d))})}),_0x477a17=await _0x472aab[_0x4a2fbc(0x1cb)]();return _0x477a17['path'];}static async[_0x56adf3(0x1e9)](_0x5c2202){const _0x42904e=_0x56adf3,_0x457c32=await this[_0x42904e(0x220)](_0x5c2202),_0x5bb9a8=await UtilImage[_0x42904e(0x1e8)](_0x457c32);return{'url':_0x457c32,'image':_0x5bb9a8};}async['close'](..._0x5f3af3){const _0xc5c140=_0x56adf3;await super[_0xc5c140(0x1fe)](..._0x5f3af3),UtilHooks[_0xc5c140(0x25e)](UtilHooks['HK_CONFIG_UPDATE'],this[_0xc5c140(0x251)]),ArtBrowserApp[_0xc5c140(0x207)]=null;}}ArtBrowserApp[_0x56adf3(0x205)]={},ArtBrowserApp[_0x56adf3(0x207)]=null,ArtBrowserApp['_ID_HIDE_TOKEN_BUTTON']=_0x56adf3(0x226),ArtBrowserApp['_ID_HIDE_TILE_BUTTON']='plutonium__art__hide-tile-button',ArtBrowserApp[_0x56adf3(0x22c)]=_0x56adf3(0x27a),ArtBrowserApp['_ID_HIDE_MAIN_BUTTON']=_0x56adf3(0x1e3),ArtBrowserApp[_0x56adf3(0x259)]=_0x56adf3(0x263),ArtBrowserApp[_0x56adf3(0x24d)]='Art\x20Browser';export{ArtBrowserApp};