const _0x4579da=_0x537b;(function(_0x3833a2,_0x553f37){const _0x5e5c7e=_0x537b,_0x15616d=_0x3833a2();while(!![]){try{const _0x137336=-parseInt(_0x5e5c7e(0x147))/0x1+-parseInt(_0x5e5c7e(0x13b))/0x2+parseInt(_0x5e5c7e(0x13e))/0x3*(-parseInt(_0x5e5c7e(0x156))/0x4)+parseInt(_0x5e5c7e(0x155))/0x5*(-parseInt(_0x5e5c7e(0x14b))/0x6)+-parseInt(_0x5e5c7e(0x158))/0x7*(parseInt(_0x5e5c7e(0x122))/0x8)+-parseInt(_0x5e5c7e(0x12e))/0x9*(-parseInt(_0x5e5c7e(0x13a))/0xa)+parseInt(_0x5e5c7e(0x10c))/0xb;if(_0x137336===_0x553f37)break;else _0x15616d['push'](_0x15616d['shift']());}catch(_0x45e22f){_0x15616d['push'](_0x15616d['shift']());}}}(_0x9058,0xb0ca6));import{ImportListCreature}from'./ImportListCreature.js';import{MixinUserChooseImporter}from'./ImportList.js';import{UtilGameSettings}from'./UtilGameSettings.js';function _0x537b(_0x5b1b21,_0x12a4fa){const _0x9058f4=_0x9058();return _0x537b=function(_0x537b98,_0x4dc929){_0x537b98=_0x537b98-0xdd;let _0x533e65=_0x9058f4[_0x537b98];return _0x533e65;},_0x537b(_0x5b1b21,_0x12a4fa);}import{Config}from'./Config.js';import{Util}from'./Util.js';function _0x9058(){const _0x30611e=['pGetUserBoolean','DND5E','data','_isActorTransformed','allowPolymorphing','folder','The\x20temp\x20folder\x20\x22','_pSendPlayerDeleteTempActorRequest','isGM','Cancel','warn','creatures-actorPolymorpher','register','DND5E.PolymorphWildShape','getCurrentImportableSheetDocumentMeta','userId','localize','children','input','Creatures','with','<i\x20class=\x22fas\x20fa-fw\x20fa-pastafarianism\x22></i>','transformOptions','This\x20actor\x20does\x20not\x20appear\x20to\x20be\x20transformed.\x20Are\x20you\x20sure\x20you\x20want\x20to\x20delete\x20this\x20actor,\x20which\x20may\x20be\x20an\x20original\x20actor?','50637180GQkdZm','<i\x20class=\x22fas\x20fa-fw\x20fa-paw\x22></i>','MODULE_NAME','_doFakeActorDrop','buttonsAdditional','This\x20actor\x20does\x20not\x20appear\x20to\x20be\x20transformedâ€”this\x20may\x20be\x20a\x20bug!','users','i18n','Select','escapeQuotes','data-plut-poly-temp-actor-delete','tools','transformTokens','collection','get','Creature','[data-plut-poly-actor-delete]','getSafe','Are\x20You\x20Sure?','systems/dnd5e/templates/apps/polymorph-prompt.html','instance','data-message-id','10794952GWCpwP','ChatMessage','ACTOR_CREATE','isToken','Customize\x20and\x20Select...','Select\x20Source\x20(Polymorphing\x20Actor\x20\x22','Fvtt','_init_player','length','flags','utils','init','9jKwAoi','Actor','actor','dialog','polymorphSettings','notifications','Open\x20Polymorpher\x20Targeting\x20Current\x20Sheet','preInit','[data-message-id]','.sheet.actor','minimumRolePolymorph','Open\x20Polymorpher\x20Targeting\x20Player\x20Character','2869990ZKpwqI','1403864mQKFhJ','btn-run-mods','data-plut-poly-actor-delete','209910voGdIx','ImportList','tempFolderName','_pSendPlayerUndoTransformationRequest','filter','_preInit_registerKeybinds','attr','import','<p>','947480JKsqnY','Select\x20Creature','dnd5e','transformInto','18SFuvbr','content','\x22>Delete</button></div>','contents','name','[data-plut-poly-temp-actor-delete]','<i\x20class=\x22fas\x20fa-fw\x20fa-times\x22></i>','actorPolymorpher','_init_gm','system-wide\x20player\x20polymorphing\x20is\x20disabled','662990NQYoRn','44ixHgNV','_pDeleteRequestMessage','7pFQWwJ','<i\x20class=\x22fas\x20fa-fw\x20fa-check\x22></i>','set','sounds/notify.wav','can','Open\x20List','\x22\x20contains\x20more\x20contents\x20than\x20expected.<br>Delete\x20it\x20anyway?','delete','ActorPolymorpher__openForCharacter','notfications','pGetUserChoice','pHandleButtonClick','_pOpen','settings','each','body','DND5E.Polymorph','Configure\x20and\x20Open\x20List','keybindings','closest','.\x22\x20Proceed?</p><div><button\x20data-plut-poly-actor-delete=\x22','create','Delete\x20Temp\x20Folder?','user','\x20has\x20transformed\x20back\x20into\x20their\x20original\x20form,\x20and\x20requests\x20you\x20delete\x20their\x20temporary\x20polymorphed\x20actor\x20\x22','click','getData','map','currentTarget'];_0x9058=function(){return _0x30611e;};return _0x9058();}import{SharedConsts}from'../shared/SharedConsts.js';import{UtilKeybinding}from'./UtilKeybinding.js';class ActorPolymorpher{static[_0x4579da(0x135)](){const _0x4a6204=_0x4579da;this[_0x4a6204(0x143)]();}static[_0x4579da(0x143)](){const _0x21d111=_0x4579da,_0x51b87e=()=>{const _0x292324=_0x537b,_0x3cf725=UtilKeybinding['getPlayerActor']({'minRole':Config[_0x292324(0x11a)](_0x292324(0x117),_0x292324(0x138))});if(!_0x3cf725)return!![];return this['_pOpen']({'actor':_0x3cf725}),!![];},_0x2a5976=()=>{const _0x1c366d=_0x537b,_0x4b68c4=UtilKeybinding[_0x1c366d(0x102)]({'isRequireActor':!![],'isRequireOwnership':!![],'minRole':Config[_0x1c366d(0x11a)](_0x1c366d(0x117),_0x1c366d(0x138))});if(!_0x4b68c4?.['actor'])return!![];return this[_0x1c366d(0xe3)]({..._0x4b68c4}),!![];};game[_0x21d111(0xe9)][_0x21d111(0x100)](SharedConsts[_0x21d111(0x10e)],_0x21d111(0xdf),{'name':_0x21d111(0x139),'editable':[],'onDown':()=>_0x51b87e()}),game[_0x21d111(0xe9)][_0x21d111(0x100)](SharedConsts[_0x21d111(0x10e)],'ActorPolymorpher__openForCurrentSheet',{'name':_0x21d111(0x134),'editable':[],'onDown':()=>_0x2a5976()});}static[_0x4579da(0x12d)](){const _0x299629=_0x4579da;if(game[_0x299629(0xee)]['isGM'])this[_0x299629(0x153)]();else this['_init_player']();}static[_0x4579da(0xf7)](_0xe2e846){const _0x12ba17=_0x4579da;if(MiscUtil['get'](_0xe2e846[_0x12ba17(0xf6)][_0x12ba17(0x12b)],_0x12ba17(0x149),'originalActor'))return!![];if(MiscUtil['get'](_0xe2e846[_0x12ba17(0xf6)][_0x12ba17(0x12b)],_0x12ba17(0x149),_0x12ba17(0x10a)))return!![];return![];}static['_pSendPlayerUndoTransformationRequest']({actorId:_0x337b8a}){const _0xe33e43=_0x4579da,_0x798246=CONFIG[_0xe33e43(0x12f)]['collection'][_0xe33e43(0x120)][_0xe33e43(0x11a)](_0x337b8a);return ChatMessage[_0xe33e43(0xec)]({'sound':'sounds/notify.wav','content':_0xe33e43(0x146)+game[_0xe33e43(0xee)][_0xe33e43(0x14f)]+_0xe33e43(0xef)+_0x798246[_0xe33e43(0x14f)][_0xe33e43(0x115)]()+_0xe33e43(0xeb)+_0x337b8a+'\x22>Delete</button></div>','user':game[_0xe33e43(0x103)],'type':0x4,'whisper':game['users'][_0xe33e43(0x14e)][_0xe33e43(0x142)](_0x5b0de9=>_0x5b0de9['isGM'])['map'](_0x3c8f0b=>_0x3c8f0b['id'])});}static[_0x4579da(0xfb)]({actorId:_0x344dbb}){const _0x1b8d9c=_0x4579da,_0x42925d=CONFIG[_0x1b8d9c(0x12f)][_0x1b8d9c(0x119)][_0x1b8d9c(0x120)][_0x1b8d9c(0x11a)](_0x344dbb);return ChatMessage[_0x1b8d9c(0xec)]({'sound':_0x1b8d9c(0x15b),'content':_0x1b8d9c(0x146)+game['user'][_0x1b8d9c(0x14f)]+'\x20requests\x20you\x20delete\x20their\x20temporary\x20polymorph\x20template\x20actor\x20\x22'+_0x42925d[_0x1b8d9c(0x14f)][_0x1b8d9c(0x115)]()+'.\x22\x20Proceed?</p><div><button\x20data-plut-poly-temp-actor-delete=\x22'+_0x344dbb+_0x1b8d9c(0x14d),'user':game[_0x1b8d9c(0x103)],'type':0x4,'whisper':game[_0x1b8d9c(0x112)][_0x1b8d9c(0x14e)][_0x1b8d9c(0x142)](_0x5a106b=>_0x5a106b[_0x1b8d9c(0xfc)])[_0x1b8d9c(0xf2)](_0xea62f4=>_0xea62f4['id'])});}static async[_0x4579da(0x157)]({ele:_0x3f193b}){const _0x5148b1=_0x4579da,_0x3e2b3d=$(_0x3f193b)[_0x5148b1(0xea)](_0x5148b1(0x136))['attr'](_0x5148b1(0x121));if(!_0x3e2b3d)return;const _0x484dbd=CONFIG[_0x5148b1(0x123)][_0x5148b1(0x119)]['instance']['get'](_0x3e2b3d);if(_0x484dbd)await _0x484dbd['delete']();}static[_0x4579da(0x129)](){const _0x187bd2=_0x4579da;$(document[_0x187bd2(0xe6)])['on'](_0x187bd2(0xf0),'.restore-transformation',_0x5d36d5=>{const _0x1be02f=_0x187bd2,_0x5e5e2b=$(_0x5d36d5[_0x1be02f(0xf3)])[_0x1be02f(0xea)](_0x1be02f(0x137))['attr']('id')['replace']('actor-',''),_0x1ed128=CONFIG[_0x1be02f(0x12f)][_0x1be02f(0x119)][_0x1be02f(0x120)]['get'](_0x5e5e2b);if(!this['_isActorTransformed'](_0x1ed128)){const _0x4b920a=_0x1be02f(0x111);console[_0x1be02f(0xfe)](_0x4b920a),ui[_0x1be02f(0xe0)]['warn'](_0x4b920a);}this[_0x1be02f(0x141)]({'actorId':_0x5e5e2b});});}static[_0x4579da(0x153)](){const _0xfbfae3=_0x4579da;$(document[_0xfbfae3(0xe6)])['on'](_0xfbfae3(0xf0),_0xfbfae3(0x11c),async _0x1eef18=>{const _0x5c4103=_0xfbfae3,_0x54c1ff=$(_0x1eef18['currentTarget'])['attr'](_0x5c4103(0x13d)),_0x43e5a1=CONFIG[_0x5c4103(0x12f)][_0x5c4103(0x119)][_0x5c4103(0x120)]['get'](_0x54c1ff);if(!_0x43e5a1)return ui['notifications'][_0x5c4103(0xfe)]('Actor\x20\x22'+_0x54c1ff+'\x22\x20not\x20found!');if(!this[_0x5c4103(0xf7)](_0x43e5a1)){const _0x804e89=await InputUiUtil[_0x5c4103(0xf4)]({'title':_0x5c4103(0x11e),'htmlDescription':_0x5c4103(0x10b)});if(!_0x804e89)return;}await _0x43e5a1['delete'](),ui[_0x5c4103(0x133)]['info']('Deleted\x20actor\x20\x22'+_0x43e5a1[_0x5c4103(0x14f)]+'\x22'),await this[_0x5c4103(0x157)]({'ele':_0x1eef18[_0x5c4103(0xf3)]});})['on'](_0xfbfae3(0xf0),_0xfbfae3(0x150),async _0x463b53=>{const _0x4364ca=_0xfbfae3,_0x48cd20=$(_0x463b53[_0x4364ca(0xf3)])[_0x4364ca(0x144)](_0x4364ca(0x116)),_0x57ff97=CONFIG['Actor'][_0x4364ca(0x119)]['instance'][_0x4364ca(0x11a)](_0x48cd20);if(!_0x57ff97)return ui[_0x4364ca(0x133)]['warn']('Actor\x20\x22'+_0x48cd20+'\x22\x20not\x20found!');await _0x57ff97[_0x4364ca(0xde)](),ui['notifications']['info']('Deleted\x20actor\x20\x22'+_0x57ff97['name']+'\x22'),await this[_0x4364ca(0x157)]({'ele':_0x463b53['currentTarget']});});}static async[_0x4579da(0xe2)](_0x144f4e,_0x3d35a5,_0xf016a4,_0x42aff4){const _0x64ac4b=_0x4579da;return this[_0x64ac4b(0xe3)]({'actor':_0x3d35a5[_0x64ac4b(0x130)]});}static async[_0x4579da(0xe3)]({actor:_0x53ccc1}){const _0x1a126e=_0x4579da;if(!game['user'][_0x1a126e(0xfc)]){const _0x40e12f=[game[_0x1a126e(0xee)][_0x1a126e(0x15c)](_0x1a126e(0x124))?'':'you\x20lack\x20actor\x20creation\x20permissions',UtilGameSettings[_0x1a126e(0x11d)](_0x1a126e(0x149),_0x1a126e(0xf8))?'':_0x1a126e(0x154)][_0x1a126e(0x142)](Boolean);if(_0x40e12f[_0x1a126e(0x12a)])return ui[_0x1a126e(0x133)][_0x1a126e(0xfe)]('Cannot\x20polymorph:\x20'+_0x40e12f['join'](';\x20'));}const _0x1949ad=await ActorPolymorpher[_0x1a126e(0x13f)][_0x1a126e(0xe1)]({'id':_0x1a126e(0xff),'name':_0x1a126e(0x107),'singleName':_0x1a126e(0x11b),'wizardTitleWindow':_0x1a126e(0x127)+_0x53ccc1[_0x1a126e(0x14f)]+'\x22)','wizardTitlePanel3':_0x1a126e(0xe8),'wizardTitleButtonOpenImporter':_0x1a126e(0x15d)},_0x1a126e(0x152));if(_0x1949ad==null)return;try{await this[_0x1a126e(0x10f)](_0x53ccc1,_0x1949ad);}catch(_0x30b234){console['error'](_0x30b234);}if(Util[_0x1a126e(0x128)]['canUserCreateFolders']()){if(_0x1949ad[_0x1a126e(0xf9)][_0x1a126e(0x105)][_0x1a126e(0x12a)]||_0x1949ad['folder'][_0x1a126e(0x14c)]['length']>0x1){const _0x25c151=await InputUiUtil[_0x1a126e(0xf4)]({'title':_0x1a126e(0xed),'htmlDescription':_0x1a126e(0xfa)+Config['get'](_0x1a126e(0x145),_0x1a126e(0x140))+_0x1a126e(0xdd)});if(!_0x25c151)return;}await _0x1949ad[_0x1a126e(0xf9)][_0x1a126e(0xde)]({'deleteSubfolders':!![],'deleteContents':!![]});return;}this[_0x1a126e(0xfb)]({'actorId':_0x1949ad['id']});}static async['_doFakeActorDrop'](_0xf32a1f,_0x224850){const _0x18b982=_0x4579da,_0x54dcaf=_0x3e898e=>{const _0xfc4fe3=_0x537b,_0x9699d3={};_0x3e898e['find'](_0xfc4fe3(0x106))[_0xfc4fe3(0xe5)]((_0x7e991a,_0x309dd8)=>{const _0x2caee4=_0xfc4fe3;_0x9699d3[_0x309dd8[_0x2caee4(0x14f)]]=_0x309dd8['checked'];});const _0x429dfe=foundry[_0xfc4fe3(0x12c)]['mergeObject'](UtilGameSettings[_0xfc4fe3(0x11d)](_0xfc4fe3(0x149),_0xfc4fe3(0x132))||{},_0x9699d3);return game[_0xfc4fe3(0xe4)][_0xfc4fe3(0x15a)]('dnd5e',_0xfc4fe3(0x132),_0x429dfe),_0x429dfe;};return new Dialog({'title':game[_0x18b982(0x113)]['localize']('DND5E.PolymorphPromptTitle'),'content':{'options':UtilGameSettings[_0x18b982(0x11d)](_0x18b982(0x149),_0x18b982(0x132)),'i18n':CONFIG[_0x18b982(0xf5)]['polymorphSettings'],'isToken':_0xf32a1f[_0x18b982(0x125)]},'default':'accept','buttons':{'accept':{'icon':_0x18b982(0x159),'label':game['i18n']['localize']('DND5E.PolymorphAcceptSettings'),'callback':_0x3f4e9b=>_0xf32a1f[_0x18b982(0x14a)](_0x224850,_0x54dcaf(_0x3f4e9b))},'wildshape':{'icon':_0x18b982(0x10d),'label':game[_0x18b982(0x113)][_0x18b982(0x104)](_0x18b982(0x101)),'callback':_0x4f0bb3=>_0xf32a1f[_0x18b982(0x14a)](_0x224850,{'keepBio':!![],'keepClass':!![],'keepMental':!![],'mergeSaves':!![],'mergeSkills':!![],'transformTokens':_0x54dcaf(_0x4f0bb3)[_0x18b982(0x118)]})},'polymorph':{'icon':_0x18b982(0x109),'label':game['i18n'][_0x18b982(0x104)](_0x18b982(0xe7)),'callback':_0x54f07e=>_0xf32a1f[_0x18b982(0x14a)](_0x224850,{'transformTokens':_0x54dcaf(_0x54f07e)[_0x18b982(0x118)]})},'cancel':{'icon':_0x18b982(0x151),'label':game['i18n'][_0x18b982(0x104)](_0x18b982(0xfd))}}},{'classes':[_0x18b982(0x131),_0x18b982(0x149)],'width':0x258,'template':_0x18b982(0x11f)})['render'](!![]);}}ActorPolymorpher[_0x4579da(0x13f)]=class extends MiscUtil['mix'](ImportListCreature)[_0x4579da(0x108)](MixinUserChooseImporter){constructor(_0xef8440){const _0x1afb0b=_0x4579da;super(_0xef8440,{'title':_0x1afb0b(0x148)},{'titleButtonRun':_0x1afb0b(0x114),'isNotDroppable':![]},{'isForceImportToTempDirectory':!![]});}[_0x4579da(0xf1)](){const _0x4e60a6=_0x4579da,_0x12b495=super[_0x4e60a6(0xf1)]();return _0x12b495[_0x4e60a6(0x110)]=[{'name':_0x4e60a6(0x13c),'text':_0x4e60a6(0x126)}],_0x12b495;}};export{ActorPolymorpher};