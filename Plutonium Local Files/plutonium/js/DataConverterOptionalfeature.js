const _0x23c36b=_0x3182;(function(_0x52d95f,_0x50c5ae){const _0x216ad9=_0x3182,_0x3ecf87=_0x52d95f();while(!![]){try{const _0x10a802=-parseInt(_0x216ad9(0x7d))/0x1*(-parseInt(_0x216ad9(0xbd))/0x2)+parseInt(_0x216ad9(0x8c))/0x3+-parseInt(_0x216ad9(0x83))/0x4*(-parseInt(_0x216ad9(0x87))/0x5)+-parseInt(_0x216ad9(0xbe))/0x6*(parseInt(_0x216ad9(0x98))/0x7)+parseInt(_0x216ad9(0x8e))/0x8+parseInt(_0x216ad9(0xc5))/0x9+-parseInt(_0x216ad9(0xca))/0xa;if(_0x10a802===_0x50c5ae)break;else _0x3ecf87['push'](_0x3ecf87['shift']());}catch(_0x5ef496){_0x3ecf87['push'](_0x3ecf87['shift']());}}}(_0x4792,0x4c280));import{UtilApplications}from'./UtilApplications.js';import{SharedConsts}from'../shared/SharedConsts.js';function _0x4792(){const _0x28508e=['552158LnsyNA','66ecAvaA','img','get','setFirstSection','_pGetEffectsSideLoaded','_getData_getConsume','actor','5264829fbwVQT','mutEffectsDisabledTransfer','MODULE_NAME_FAKE','Fighting\x20Style:\x20','init','6418790NnsVAi','name','_getRequirementsString','importOptionalFeature','_getOptionalFeatureFlags','getSrdCompendiumEntity','pGetInitOptionalFeatureFeatureLoadeds','filterValues','srd','_pGetDataSideLoaded','_IMG_FALLBACK','permissions','getCleanEntityName','prerequisite','1ConUMI','getExpandedEffects','</i></p>','_FEATURE_TYPES','data','copy','602152KRCggP','push','\x0a\x09\x09\x09\x09','mutActorUpdate','5SIqTCI','requirements','PG_OPT_FEATURES','_pGetFlagsSideLoaded','_pGetSaveImagePath','544200gCCOQG','source','12592DZAchP','pMutActorUpdateOptionalFeature','type','pGetOptionalFeatureSideData','_pGetDescriptionValue','_SIDE_LOAD_OPTS','_pGetPreloadSideData','/media/icon/skills.svg','_pGetOptionalFeatureItem_fromSrd','hover','153209JgQOSF','optionalfeature','utils','set','defaultPermission','effects','isAddPermission','setImplSideData','_pGetOptionalFeatureItem_other','getPrerequisiteHtml','modules/','pInitOptionalFeatureLoadeds','<div>\x0a\x09\x09\x09\x09','activation','has','pGetOptionalFeatureItem','isActorItem','permission','render','_SIDE_DATA','FS:F','\x0a\x09\x09\x09</div>','pGetWithDescriptionPlugins','_foundryData','foundryOptionalfeature','_pIsInSrd','_getCompendiumAliases','special','_pGetSideLoadedMatch','featureType','getSourceWithPagePart','_pGetEffectsRawSideLoaded_','FS:B','URL_TO_HASH_BUILDER','pGetSideLoadedMatch','pCacheAndGet','Metamagic:\x20'];_0x4792=function(){return _0x28508e;};return _0x4792();}import{Config}from'./Config.js';import{Vetools}from'./Vetools.js';import{UtilCompendium}from'./UtilCompendium.js';import{UtilActiveEffects}from'./UtilActiveEffects.js';function _0x3182(_0x3a3177,_0x42bb89){const _0x479218=_0x4792();return _0x3182=function(_0x318272,_0x440b67){_0x318272=_0x318272-0x79;let _0x4bf0c8=_0x479218[_0x318272];return _0x4bf0c8;},_0x3182(_0x3a3177,_0x42bb89);}import{DataConverterFeature}from'./DataConverterFeature.js';import{PageFilterClassesFoundry}from'./UtilCharactermancerClass.js';import{UtilDataConverter}from'./UtilDataConverter.js';import{DataConverter}from'./DataConverter.js';class DataConverterOptionalfeature extends DataConverterFeature{static [_0x23c36b(0x93)]={'propBrew':_0x23c36b(0xb0),'fnLoadJson':async()=>this[_0x23c36b(0x94)](),'propJson':_0x23c36b(0x99)};static [_0x23c36b(0x79)]=_0x23c36b(0xa2)+SharedConsts['MODULE_NAME']+_0x23c36b(0x95);static[_0x23c36b(0xc9)](){const _0x13a538=_0x23c36b;PageFilterClassesFoundry[_0x13a538(0x9f)](_0x13a538(0x99),this);}static async['pGetDereferencedOptionalFeatureFeatureItem'](_0x29ccd3){const _0x4ecd8b=_0x23c36b;if(_0x29ccd3['entries'])return MiscUtil['copy'](_0x29ccd3);const _0x1fa8a6=UrlUtil[_0x4ecd8b(0xb9)][UrlUtil[_0x4ecd8b(0x89)]](_0x29ccd3);return Renderer[_0x4ecd8b(0x97)][_0x4ecd8b(0xbb)](UrlUtil[_0x4ecd8b(0x89)],_0x29ccd3[_0x4ecd8b(0x8d)],_0x1fa8a6,{'isCopy':!![]});}static async[_0x23c36b(0xd0)](_0x174f82,{actor:actor=null}={}){const _0x4a5dcc=_0x23c36b,_0x1d2e86={'optionalfeature':_0x174f82[_0x4a5dcc(0xcb)]+'|'+_0x174f82['source']};return await PageFilterClassesFoundry[_0x4a5dcc(0xa3)]({'optionalfeature':_0x1d2e86,'raw':_0x174f82,'actor':actor}),_0x1d2e86;}static async[_0x23c36b(0xa7)](_0x45272b,_0x2f807c){const _0x71eee4=_0x23c36b;_0x2f807c=_0x2f807c||{};if(_0x2f807c[_0x71eee4(0xc4)])_0x2f807c['isActorItem']=!![];let _0x54fda5;return await this[_0x71eee4(0xb1)](_0x45272b,_0x2f807c)?_0x54fda5=this[_0x71eee4(0x96)](_0x45272b,_0x2f807c):_0x54fda5=this[_0x71eee4(0xa0)](_0x45272b,_0x2f807c),_0x54fda5;}static async[_0x23c36b(0xb1)](_0x1177a3){const _0x4a7bf7=_0x23c36b,_0x4405cd=await UtilCompendium[_0x4a7bf7(0xcf)](_0x4a7bf7(0x99),_0x1177a3,{'fnGetAliases':this[_0x4a7bf7(0xb2)]});return!!_0x4405cd;}static async[_0x23c36b(0x96)](_0x587d30,_0x4c11dd){const _0x4fc54b=_0x23c36b,_0x3dc48a=await UtilCompendium[_0x4fc54b(0xcf)]('optionalfeature',_0x587d30,{'fnGetAliases':this['_getCompendiumAliases']}),_0x12ce5a=await this[_0x4fc54b(0x92)](_0x587d30),_0x5bf10c=this['_getData_getConsume']({'ent':_0x587d30,'actor':_0x4c11dd['actor']}),_0x45c728=_0x5bf10c?.['type']&&!_0x3dc48a[_0x4fc54b(0x81)]?.[_0x4fc54b(0xa5)]?.['type']?_0x4fc54b(0xb3):_0x3dc48a[_0x4fc54b(0x81)]?.['activation']?.[_0x4fc54b(0x90)],_0x436a40=await this[_0x4fc54b(0xd3)](_0x587d30),_0x4c518a=await this['_pGetFlagsSideLoaded'](_0x587d30),_0x41842b=[...MiscUtil[_0x4fc54b(0x82)](_0x3dc48a[_0x4fc54b(0x9d)]||[]),..._0x4c11dd[_0x4fc54b(0xa8)]?[]:await this['_pGetEffectsSideLoaded']({'ent':feature,'img':_0x3dc48a[_0x4fc54b(0xbf)]})||[]];DataConverter[_0x4fc54b(0xc6)](_0x41842b,_0x4fc54b(0xcd));const _0x499250={'name':UtilApplications[_0x4fc54b(0x7b)](UtilDataConverter['getNameWithSourcePart'](_0x587d30,{'isActorItem':_0x4c11dd[_0x4fc54b(0xa8)]})),'type':_0x3dc48a[_0x4fc54b(0x90)],'data':{..._0x3dc48a['data'],'activation':{'type':_0x45c728},'source':UtilDataConverter[_0x4fc54b(0xb6)](_0x587d30),'description':{'value':_0x12ce5a,'chat':'','unidentified':''},'requirements':this[_0x4fc54b(0xcc)](_0x587d30),'consume':_0x5bf10c,..._0x436a40},'permission':{'default':0x0},'img':await this[_0x4fc54b(0x8b)](_0x587d30,{'propCompendium':_0x4fc54b(0x99)}),'flags':{...this['_getOptionalFeatureFlags'](_0x587d30,_0x4c11dd),..._0x4c518a},'effects':_0x41842b};if(_0x4c11dd[_0x4fc54b(0x9c)]!=null)_0x499250['permission']={'default':_0x4c11dd[_0x4fc54b(0x9c)]};else{if(_0x4c11dd[_0x4fc54b(0x9e)])_0x499250['permission']={'default':Config[_0x4fc54b(0xc0)](_0x4fc54b(0xcd),_0x4fc54b(0x7a))};}return _0x499250;}static async[_0x23c36b(0xa0)](_0x3134f3,_0x350cfc){const _0x11dd02=_0x23c36b,_0x297c60=await this[_0x11dd02(0x92)](_0x3134f3),_0x531b8a=this[_0x11dd02(0xc3)]({'ent':_0x3134f3,'actor':_0x350cfc['actor']}),_0x48c640=await this[_0x11dd02(0x8b)](_0x3134f3,{'propCompendium':_0x11dd02(0x99)}),_0x2456d8=await this[_0x11dd02(0xd3)](_0x3134f3),_0x2bf95e=await this[_0x11dd02(0x8a)](_0x3134f3),_0xef0bfb=_0x350cfc['isActorItem']?[]:await this[_0x11dd02(0xc2)]({'ent':_0x3134f3,'img':_0x48c640});DataConverter[_0x11dd02(0xc6)](_0xef0bfb,_0x11dd02(0xcd));const _0xfdf066={'name':UtilApplications[_0x11dd02(0x7b)](UtilDataConverter['getNameWithSourcePart'](_0x3134f3,{'isActorItem':_0x350cfc['isActorItem']})),'data':{'source':UtilDataConverter[_0x11dd02(0xb6)](_0x3134f3),'description':{'value':_0x297c60,'chat':'','unidentified':''},'activation':{'type':_0x531b8a?.['type']?'special':'','cost':null,'condition':''},'duration':{'value':0x0,'units':''},'target':{'value':0x0,'units':'','type':''},'range':{'value':0x0,'long':0x0,'units':null},'uses':{'value':0x0,'max':0x0,'per':''},'ability':'','actionType':'','attackBonus':null,'chatFlavor':'','critical':{'threshold':null,'damage':''},'damage':{'parts':[],'versatile':''},'formula':'','save':{'ability':'','dc':null},'requirements':this[_0x11dd02(0xcc)](_0x3134f3),'consume':_0x531b8a,'recharge':{'value':0x0,'charged':!![]},..._0x2456d8},'permission':{'default':0x0},'type':'feat','img':_0x48c640,'flags':{...this[_0x11dd02(0xce)](_0x3134f3,_0x350cfc),..._0x2bf95e},'effects':_0xef0bfb};if(_0x350cfc[_0x11dd02(0x9c)]!=null)_0xfdf066[_0x11dd02(0xa9)]={'default':_0x350cfc[_0x11dd02(0x9c)]};else{if(_0x350cfc[_0x11dd02(0x9e)])_0xfdf066[_0x11dd02(0xa9)]={'default':Config[_0x11dd02(0xc0)](_0x11dd02(0xcd),_0x11dd02(0x7a))};}return _0xfdf066;}static['_pGetDescriptionValue'](_0x261a0f){const _0x458daf=_0x23c36b;if(!Config[_0x458daf(0xc0)](_0x458daf(0xcd),'isImportDescription'))return'';return UtilDataConverter[_0x458daf(0xae)](()=>{const _0x1c2d10=_0x458daf,_0x20d760=Renderer[_0x1c2d10(0x9a)][_0x1c2d10(0xa1)](_0x261a0f[_0x1c2d10(0x7c)]);return _0x1c2d10(0xa4)+(_0x20d760?'<p><i>'+_0x20d760+_0x1c2d10(0x7f):'')+_0x1c2d10(0x85)+Renderer[_0x1c2d10(0xc0)]()[_0x1c2d10(0xc1)](!![])[_0x1c2d10(0xaa)]({'entries':_0x261a0f['entries']},0x2)+_0x1c2d10(0xad);});}static[_0x23c36b(0xcc)](_0x10c8f5){const _0x3a78bb=_0x23c36b;return _0x10c8f5[_0x3a78bb(0xaf)]?.[_0x3a78bb(0x88)]||Renderer[_0x3a78bb(0x9a)][_0x3a78bb(0xa1)](_0x10c8f5[_0x3a78bb(0x7c)],{'isTextOnly':!![],'isSkipPrefix':!![]});}static['_getOptionalFeatureFlags'](_0x5d6c93,_0x395b93){const _0x4765b9=_0x23c36b;_0x395b93=_0x395b93||{};const _0x366d8e={[SharedConsts[_0x4765b9(0xc7)]]:{'page':UrlUtil[_0x4765b9(0x89)],'source':_0x5d6c93[_0x4765b9(0x8d)],'hash':UrlUtil[_0x4765b9(0xb9)][UrlUtil[_0x4765b9(0x89)]](_0x5d6c93)}};return _0x395b93['isAddDataFlags']&&(_0x366d8e[SharedConsts[_0x4765b9(0xc7)]]['propDroppable']=_0x4765b9(0x99),_0x366d8e[SharedConsts['MODULE_NAME_FAKE']][_0x4765b9(0xd1)]=_0x395b93[_0x4765b9(0xd1)]),_0x366d8e;}static async[_0x23c36b(0x8f)](_0x1d637c,_0x581a80,_0x5b4f39,_0x502b60){const _0x5c3835=_0x23c36b,_0x3f8cd2=await this[_0x5c3835(0xba)](_0x5b4f39);this[_0x5c3835(0x86)](_0x1d637c,_0x581a80,_0x5b4f39,{'sideData':_0x3f8cd2});}static async[_0x23c36b(0x94)](){const _0x1c97bf=_0x23c36b;if(!this[_0x1c97bf(0xab)])this[_0x1c97bf(0xab)]=await Vetools[_0x1c97bf(0x91)]();return this[_0x1c97bf(0xab)];}static async[_0x23c36b(0xba)](_0x17ec7f){const _0x531eaa=_0x23c36b;return this[_0x531eaa(0xb4)](_0x17ec7f,this[_0x531eaa(0x93)]);}static async['pHasOptionalFeatureSideLoadedEffects'](_0x44701c,_0x1a26ec){const _0x326ab3=_0x23c36b;return(await this[_0x326ab3(0xb7)](_0x1a26ec,this[_0x326ab3(0x93)]))?.['length']>0x0;}static async['pGetOptionalFeatureItemEffects'](_0x5e1cb1,_0x58d140,_0x384c7e,{additionalData:_0x2f695a,img:_0x4fc2ae}={}){const _0x1de5d6=_0x23c36b,_0x2d4b0e=await this[_0x1de5d6(0xb7)](_0x58d140,this[_0x1de5d6(0x93)]);return UtilActiveEffects[_0x1de5d6(0x7e)](_0x2d4b0e||[],{'actor':_0x5e1cb1,'sheetItem':_0x384c7e,'parentName':_0x58d140[_0x1de5d6(0xcb)],'additionalData':_0x2f695a,'img':_0x4fc2ae});}static[_0x23c36b(0xb2)](_0x463000){const _0x6925a2=_0x23c36b;if(!_0x463000[_0x6925a2(0xcb)]||!_0x463000[_0x6925a2(0xd2)])return[];const _0x4e13ad=[];for(const [_0x25f220,_0x3afbf8]of DataConverterOptionalfeature[_0x6925a2(0x80)]['entries']()){if(_0x463000[_0x6925a2(0xb5)]['some'](_0x3e3c7d=>_0x25f220[_0x6925a2(0xa6)](_0x3e3c7d)))_0x4e13ad[_0x6925a2(0x84)](_0x3afbf8(_0x463000));}return _0x4e13ad;}}DataConverterOptionalfeature['_FEATURE_TYPES']=new Map(),DataConverterOptionalfeature['_FEATURE_TYPES'][_0x23c36b(0x9b)](new Set(['EI']),_0x1e2b9b=>'Invocation:\x20'+_0x1e2b9b[_0x23c36b(0xcb)]),DataConverterOptionalfeature['_FEATURE_TYPES'][_0x23c36b(0x9b)](new Set(['MM']),_0x46688b=>_0x23c36b(0xbc)+_0x46688b['name']),DataConverterOptionalfeature[_0x23c36b(0x80)][_0x23c36b(0x9b)](new Set([_0x23c36b(0xac),_0x23c36b(0xb8),'FS:P','FS:R']),_0x47eb22=>_0x23c36b(0xc8)+_0x47eb22[_0x23c36b(0xcb)]);export{DataConverterOptionalfeature};