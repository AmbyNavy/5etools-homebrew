function _0xbf9a(_0x49ed17,_0x472cd9){const _0x525831=_0x5258();return _0xbf9a=function(_0xbf9afc,_0x2c9c0e){_0xbf9afc=_0xbf9afc-0x9d;let _0x48e4fb=_0x525831[_0xbf9afc];return _0x48e4fb;},_0xbf9a(_0x49ed17,_0x472cd9);}const _0x637391=_0xbf9a;(function(_0x51e620,_0x9ddeb9){const _0x207e38=_0xbf9a,_0x3b3c81=_0x51e620();while(!![]){try{const _0x1ee13b=parseInt(_0x207e38(0xf1))/0x1*(parseInt(_0x207e38(0xd3))/0x2)+parseInt(_0x207e38(0xe8))/0x3+-parseInt(_0x207e38(0xba))/0x4*(parseInt(_0x207e38(0xc4))/0x5)+-parseInt(_0x207e38(0xc1))/0x6+-parseInt(_0x207e38(0x9e))/0x7+parseInt(_0x207e38(0x105))/0x8*(parseInt(_0x207e38(0xaf))/0x9)+-parseInt(_0x207e38(0xa1))/0xa*(-parseInt(_0x207e38(0xd0))/0xb);if(_0x1ee13b===_0x9ddeb9)break;else _0x3b3c81['push'](_0x3b3c81['shift']());}catch(_0xa5e1bf){_0x3b3c81['push'](_0x3b3c81['shift']());}}}(_0x5258,0x8192e));import{UtilList2}from'./UtilList2.js';function _0x5258(){const _0x541295=['.search','Folder','Deleting...','_pDoPruneFolders','_namePlural','Scene','type','_sidebarTab','2207550BgxuJz','item','actor','init','fa-trash','_rows','_activateListeners_initBtnPrune','values','items','1ggiPbT','[name=btn-toggle-summary]','its','data','sidebar','activateTab','_activateListeners_doBindSelectAll','ascSortLower','add','Deleted\x20','filterBox','<h3>Are\x20you\x20sure?</h3><p>','[name=btn-filter]','[name=\x22cb-select-all\x22]','children','checked','get','path','...','scene','18104EQSZNh','_handleFilterChange','_pDoDelete','actors','scenes','Unknown\x20collection\x20\x22','close','tool-','info','\x20and\x20','Task','Deleting\x20','Failed\x20to\x20delete\x20','val','RollTable','journal\x20entries','_documentClass','[name=\x22btn-prune\x22]','click','.veapp__list','STR_SEE_CONSOLE','journal','2236458alacdw','[name=\x22btn-reset\x22]','filter','30pjcbym','pGetConfirmation','contents','_folderType','_collectionName','pRunTasks','then','card\x20stack','_nameSingle','prop','\x20folder','ele','_sortNamePathRows','map','1116rbItCb','content','rolltable','absorbFnBindListeners','find','bindSelectAllCheckbox','\x20data\x20will\x20be\x20permanently\x20deleted.</p>','Delete\x20Folders','getValues','length','_activateListeners_listAbsorbGetData','4ShNERB','name','absorbFnGetData','macro','Actor','_pageFilter','_$btnReset','5391738zYMBAM','has','notifications','1860595RFGVxW','addToFilters','_list','_listSortNamePathRows','cards','unknown','EVNT_VALCHANGE','warn','_activateListeners_pInitListAndFilters','Item','collection','macros','1978999hAcAxS','tables','deleteDocuments','1129562YcZInx','Please\x20select\x20something\x20to\x20delete!','_collection','_getSelectedIds','_gameProp','doAbsorbItems','Cards','instance','toDisplay','_mapEntitiesToRows','Delete','render','forEach'];_0x5258=function(){return _0x541295;};return _0x5258();}import{UtilApplications}from'./UtilApplications.js';import{Util}from'./Util.js';class BaseCollectionTool extends Application{static[_0x637391(0xad)](_0x41c6c5,_0x324141){const _0x3a8e1e=_0x637391;if(_0x41c6c5[_0x3a8e1e(0x102)]==null&&_0x324141[_0x3a8e1e(0x102)]==null)return SortUtil[_0x3a8e1e(0xf8)](_0x41c6c5['name'],_0x324141[_0x3a8e1e(0xbb)]);if(_0x41c6c5[_0x3a8e1e(0x102)]!=null&&_0x324141[_0x3a8e1e(0x102)]==null)return-0x1;if(_0x41c6c5[_0x3a8e1e(0x102)]==null&&_0x324141[_0x3a8e1e(0x102)]!=null)return 0x1;return SortUtil['ascSortLower'](_0x41c6c5[_0x3a8e1e(0x102)],_0x324141[_0x3a8e1e(0x102)])||SortUtil['ascSortLower'](_0x41c6c5[_0x3a8e1e(0xbb)],_0x324141['name']);}static[_0x637391(0xc7)](_0x5c301e,_0x3aa30a,_0x4c651b){const _0x1ed42c=_0x637391,_0x5622c1={'name':_0x5c301e[_0x1ed42c(0xbb)],'path':_0x5c301e[_0x1ed42c(0xef)][_0x1ed42c(0x102)]},_0x5abdf3={'name':_0x3aa30a[_0x1ed42c(0xbb)],'path':_0x3aa30a[_0x1ed42c(0xef)][_0x1ed42c(0x102)]};return BaseCollectionTool['_sortNamePathRows'](_0x5622c1,_0x5abdf3);}constructor(_0x292987,_0x5d8211){const _0x4c437f=_0x637391;super(_0x292987),this['_collectionName']=_0x5d8211,this[_0x4c437f(0x115)]=null,this[_0x4c437f(0xd5)]=null,this[_0x4c437f(0xe7)]=null,this[_0x4c437f(0xd7)]=null,this[_0x4c437f(0xa4)]=null,this[_0x4c437f(0xa9)]=null,this['_namePlural']=null;switch(_0x5d8211){case'scene':{this['_documentClass']=Scene,this[_0x4c437f(0xd5)]=CONFIG['Scene'][_0x4c437f(0xce)]['instance'],this[_0x4c437f(0xe7)]=_0x4c437f(0x109),this[_0x4c437f(0xd7)]=_0x4c437f(0x109),this[_0x4c437f(0xa4)]=_0x4c437f(0xe5),this[_0x4c437f(0xa9)]=_0x4c437f(0x104),this[_0x4c437f(0xe4)]=_0x4c437f(0x109);break;}case _0x4c437f(0xea):{this[_0x4c437f(0x115)]=Actor,this[_0x4c437f(0xd5)]=CONFIG[_0x4c437f(0xbe)][_0x4c437f(0xce)]['instance'],this['_sidebarTab']=_0x4c437f(0x108),this['_gameProp']=_0x4c437f(0x108),this[_0x4c437f(0xa4)]='Actor',this[_0x4c437f(0xa9)]=_0x4c437f(0xea),this[_0x4c437f(0xe4)]=_0x4c437f(0x108);break;}case'item':{this[_0x4c437f(0x115)]=Item,this['_collection']=CONFIG[_0x4c437f(0xcd)]['collection']['instance'],this[_0x4c437f(0xe7)]=_0x4c437f(0xf0),this[_0x4c437f(0xd7)]=_0x4c437f(0xf0),this[_0x4c437f(0xa4)]=_0x4c437f(0xcd),this[_0x4c437f(0xa9)]=_0x4c437f(0xe9),this[_0x4c437f(0xe4)]=_0x4c437f(0xf0);break;}case'journal':{this['_documentClass']=JournalEntry,this[_0x4c437f(0xd5)]=CONFIG['JournalEntry'][_0x4c437f(0xce)][_0x4c437f(0xda)],this[_0x4c437f(0xe7)]='journal',this[_0x4c437f(0xd7)]=_0x4c437f(0x9d),this[_0x4c437f(0xa4)]='JournalEntry',this[_0x4c437f(0xa9)]='journal\x20entry',this['_namePlural']=_0x4c437f(0x114);break;}case _0x4c437f(0xb1):{this[_0x4c437f(0x115)]=RollTable,this[_0x4c437f(0xd5)]=CONFIG[_0x4c437f(0x113)][_0x4c437f(0xce)][_0x4c437f(0xda)],this[_0x4c437f(0xe7)]=_0x4c437f(0xd1),this[_0x4c437f(0xd7)]=_0x4c437f(0xd1),this[_0x4c437f(0xa4)]='RollTable',this[_0x4c437f(0xa9)]='table',this['_namePlural']=_0x4c437f(0xd1);break;}case _0x4c437f(0xbd):{this['_documentClass']=Macro,this[_0x4c437f(0xd5)]=CONFIG['Macro'][_0x4c437f(0xce)][_0x4c437f(0xda)],this[_0x4c437f(0xe7)]=null,this[_0x4c437f(0xd7)]=_0x4c437f(0xcf),this[_0x4c437f(0xa4)]=null,this[_0x4c437f(0xa9)]=_0x4c437f(0xbd),this['_namePlural']=_0x4c437f(0xcf);break;}case _0x4c437f(0xc8):{this[_0x4c437f(0x115)]=Cards,this[_0x4c437f(0xd5)]=CONFIG['Cards'][_0x4c437f(0xce)][_0x4c437f(0xda)],this[_0x4c437f(0xe7)]=_0x4c437f(0xc8),this[_0x4c437f(0xd7)]=_0x4c437f(0xc8),this[_0x4c437f(0xa4)]=_0x4c437f(0xd9),this[_0x4c437f(0xa9)]=_0x4c437f(0xa8),this[_0x4c437f(0xe4)]='card\x20stacks';break;}default:throw new Error(_0x4c437f(0x10a)+_0x5d8211+'\x22');}}[_0x637391(0xdc)](){const _0x59f55b=_0x637391;return this[_0x59f55b(0xd5)][_0x59f55b(0xa3)]['map']((_0x46f28b,_0xb6f949)=>{const _0x27acd4=_0x59f55b,_0x53e335=UtilApplications['getFolderPath'](_0x46f28b,{'isAddTrailingSlash':!![]});return{'path':_0x53e335,'name':_0x46f28b[_0x27acd4(0xbb)],'displayName':''+(_0x53e335||'')+_0x46f28b['name'],'id':_0x46f28b['id'],'type':MiscUtil[_0x27acd4(0x101)](_0x46f28b,'data',_0x27acd4(0xe6))||_0x27acd4(0xc9),'ix':_0xb6f949};})['sort'](BaseCollectionTool[_0x59f55b(0xad)]);}[_0x637391(0x106)](){const _0x3eced1=_0x637391,_0x240db6=this['_pageFilter'][_0x3eced1(0xfb)][_0x3eced1(0xb7)]();this['_list'][_0x3eced1(0xa0)](_0x5d15c9=>this[_0x3eced1(0xbf)][_0x3eced1(0xdb)](_0x240db6,this['_rows'][_0x5d15c9['ix']]));}['_activateListeners_initBtnReset'](_0x309422){const _0x2671b3=_0x637391;this[_0x2671b3(0xc0)]=_0x309422[_0x2671b3(0xb3)](_0x2671b3(0x9f))[_0x2671b3(0x117)](()=>{const _0x2a50e4=_0x2671b3;_0x309422[_0x2a50e4(0xb3)](_0x2a50e4(0xe0))[_0x2a50e4(0x112)]('');if(this[_0x2a50e4(0xc6)])this['_list']['reset']();});}[_0x637391(0xb9)](_0x9e1faa){const _0x2a0b53=_0x637391;return UtilList2[_0x2a0b53(0xbc)](_0x9e1faa);}[_0x637391(0xf7)](_0x33d536){const _0x113246=_0x637391;ListUiUtil[_0x113246(0xb4)](_0x33d536,this[_0x113246(0xc6)]);}[_0x637391(0xcc)](_0x5dd6fa){const _0x2adedf=_0x637391;return this['_$iptSearch']=_0x5dd6fa['find'](_0x2adedf(0xe0)),this[_0x2adedf(0xc6)]=new List({'$iptSearch':this['_$iptSearch'],'$wrpList':_0x5dd6fa[_0x2adedf(0xb3)](_0x2adedf(0x118)),'fnSort':BaseCollectionTool[_0x2adedf(0xc7)]}),SortUtil['initBtnSortHandlers'](_0x5dd6fa[_0x2adedf(0xb3)]('[data-name=\x22wrp-btns-sort\x22]'),this['_list']),this[_0x2adedf(0xf7)](_0x5dd6fa[_0x2adedf(0xb3)](_0x2adedf(0xfe))),this[_0x2adedf(0xbf)]['pInitFilterBox']({'$iptSearch':this['_$iptSearch'],'$btnReset':this[_0x2adedf(0xc0)],'$btnOpen':_0x5dd6fa[_0x2adedf(0xb3)](_0x2adedf(0xfd)),'$btnToggleSummaryHidden':_0x5dd6fa[_0x2adedf(0xb3)](_0x2adedf(0xf2)),'$wrpMiniPills':_0x5dd6fa[_0x2adedf(0xb3)]('.fltr__mini-view'),'namespace':_0x2adedf(0x10c)+this[_0x2adedf(0xa5)]})[_0x2adedf(0xa7)](()=>{const _0x59b782=_0x2adedf;this[_0x59b782(0xed)][_0x59b782(0xdf)](_0x2fd2b2=>this[_0x59b782(0xbf)][_0x59b782(0xc5)](_0x2fd2b2)),this[_0x59b782(0xc6)][_0x59b782(0xd8)](this[_0x59b782(0xed)],{'fnGetName':_0x101851=>_0x101851[_0x59b782(0xbb)],'fnGetValues':_0xba6513=>({'id':_0xba6513['id'],'path':_0xba6513[_0x59b782(0x102)]}),'fnGetData':this['_activateListeners_listAbsorbGetData']['bind'](this),'fnBindListeners':_0x5e2661=>UtilList2[_0x59b782(0xb2)](this['_list'],_0x5e2661)}),this[_0x59b782(0xc6)][_0x59b782(0xeb)](),this[_0x59b782(0xbf)]['trimState'](),this[_0x59b782(0xbf)][_0x59b782(0xfb)][_0x59b782(0xde)](),this[_0x59b782(0xbf)][_0x59b782(0xfb)]['on'](FilterBox[_0x59b782(0xca)],this['_handleFilterChange']['bind'](this)),this[_0x59b782(0x106)]();});}['_getSelectedIds'](){const _0x4a3d25=_0x637391;return this['_list']['items']['filter'](_0x2d6a45=>$(_0x2d6a45[_0x4a3d25(0xac)])['find']('input')[_0x4a3d25(0xaa)](_0x4a3d25(0x100)))[_0x4a3d25(0xae)](_0xf2baf2=>({'name':_0xf2baf2[_0x4a3d25(0xbb)],'id':_0xf2baf2[_0x4a3d25(0xef)]['id']}));}[_0x637391(0xee)](_0x35077a){const _0x265eec=_0x637391;_0x35077a[_0x265eec(0xb3)](_0x265eec(0x116))[_0x265eec(0x117)](async()=>{const _0x45ee1a=_0x265eec,_0x149a66=await UtilApplications[_0x45ee1a(0xa2)]({'title':_0x45ee1a(0xb6),'content':'<h3>Are\x20you\x20sure?</h3><p>Any\x20empty\x20folders\x20will\x20be\x20permanently\x20deleted.</p>','confirmText':_0x45ee1a(0xdd),'faIcon':_0x45ee1a(0xec)});if(!_0x149a66)return;await this[_0x45ee1a(0xe3)]();});}async[_0x637391(0x107)](_0x4068c9){const _0x3237a3=_0x637391;if(!this[_0x3237a3(0xc6)])return;let _0x565fac=this[_0x3237a3(0xd6)]();if(!_0x565fac['length'])return ui['notifications'][_0x3237a3(0xcb)](_0x3237a3(0xd4));const _0x214fdb=this['_collectionName']['uppercaseFirst'](),_0x1abdb6=_0x565fac['length']!==0x1?'s':'',_0x4dd226=await UtilApplications[_0x3237a3(0xa2)]({'title':'Delete\x20'+_0x214fdb+_0x1abdb6,'content':_0x3237a3(0xfc)+_0x565fac[_0x3237a3(0xb8)]+'\x20'+_0x214fdb+_0x1abdb6+_0x3237a3(0x10e)+(_0x1abdb6?'their':_0x3237a3(0xf3))+_0x3237a3(0xb5),'confirmText':_0x3237a3(0xdd),'faIcon':_0x3237a3(0xec)});if(!_0x4dd226)return;this[_0x3237a3(0x10b)]();if(this['_sidebarTab'])ui[_0x3237a3(0xf5)][_0x3237a3(0xf6)](this[_0x3237a3(0xe7)]);if(_0x4068c9[_0x3237a3(0xaa)](_0x3237a3(0x100))){const _0x28f661=await this[_0x3237a3(0xe3)](_0x565fac[_0x3237a3(0xae)](({id:_0x21a14a})=>_0x21a14a));_0x565fac=_0x565fac[_0x3237a3(0xa0)](({id:_0x1c611c})=>!_0x28f661['has'](_0x1c611c));}const _0x2db0ed=new Util[(_0x3237a3(0x10f))](_0x565fac[_0x3237a3(0xb8)],()=>this[_0x3237a3(0x115)][_0x3237a3(0xd2)](_0x565fac[_0x3237a3(0xae)](({id:_0x341ed3})=>_0x341ed3)));await UtilApplications[_0x3237a3(0xa6)]([_0x2db0ed],{'titleInitial':_0x3237a3(0xe2),'titleComplete':'Delete\x20Complete','fnGetRowRunningText':_0x2d3e24=>_0x3237a3(0x110)+_0x2d3e24+'\x20'+(_0x2d3e24===0x1?this[_0x3237a3(0xa9)]:this[_0x3237a3(0xe4)])+_0x3237a3(0x103),'fnGetRowSuccessText':_0x1621e0=>_0x3237a3(0xfa)+_0x1621e0+'\x20'+(_0x1621e0===0x1?this['_nameSingle']:this[_0x3237a3(0xe4)])+'.','fnGetRowErrorText':_0x322663=>_0x3237a3(0x111)+_0x322663+'\x20'+(_0x322663===0x1?this[_0x3237a3(0xa9)]:this[_0x3237a3(0xe4)])+'!\x20'+VeCt[_0x3237a3(0x119)]});if(_0x4068c9['prop'](_0x3237a3(0x100)))await this[_0x3237a3(0xe3)]();game[this[_0x3237a3(0xd7)]][_0x3237a3(0xde)]();}async[_0x637391(0xe3)](_0x4bb5f4){const _0xebea6a=_0x637391,_0x5c8641=()=>CONFIG[_0xebea6a(0xe1)][_0xebea6a(0xce)]['instance'][_0xebea6a(0xa3)][_0xebea6a(0xa0)](_0x2be5dc=>_0x2be5dc[_0xebea6a(0xf4)][_0xebea6a(0xe6)]===this[_0xebea6a(0xa4)]),_0x16f289=_0x4bb5f4?new Set(_0x4bb5f4):null,_0x69d4c6=new Set();let _0xf49e7c=0x0,_0x204460=null,_0x56304b=_0x5c8641()[_0xebea6a(0xb8)];do{let _0x6f75e3;_0x16f289?_0x6f75e3=_0x5c8641()[_0xebea6a(0xa0)](_0x5f04f4=>{const _0x756220=_0xebea6a;if(!_0x5f04f4[_0x756220(0xff)]||!_0x5f04f4[_0x756220(0xff)][_0x756220(0xb8)]){if(!_0x5f04f4['content'][_0x756220(0xb8)])return!![];const _0x4b56ac=_0x5f04f4['content'][_0x756220(0xae)](_0x1a84fc=>_0x1a84fc['id'])[_0x756220(0xa0)](_0x41b3e9=>_0x16f289[_0x756220(0xc2)](_0x41b3e9));if(_0x4b56ac[_0x756220(0xb8)]===_0x5f04f4[_0x756220(0xb0)]['length'])return _0x4b56ac[_0x756220(0xdf)](_0x391384=>_0x69d4c6[_0x756220(0xf9)](_0x391384)),!![];}return![];}):_0x6f75e3=_0x5c8641()[_0xebea6a(0xa0)](_0x34de8f=>!_0x34de8f[_0xebea6a(0xb0)]['length']&&(!_0x34de8f[_0xebea6a(0xff)]||!_0x34de8f[_0xebea6a(0xff)][_0xebea6a(0xb8)]));for(const _0x1ae033 of _0x6f75e3){await _0x1ae033['delete']({'deleteSubfolders':!![],'deleteContents':!![]}),_0xf49e7c++;}_0x204460=_0x56304b,_0x56304b=_0x5c8641()[_0xebea6a(0xb8)];}while(_0x56304b!==_0x204460);if(_0xf49e7c)ui[_0xebea6a(0xc3)][_0xebea6a(0x10d)](_0xebea6a(0xfa)+_0xf49e7c+_0xebea6a(0xab)+(_0xf49e7c===0x1?'':'s')+'.');return _0x69d4c6;}}export{BaseCollectionTool};