const _0x1ed095=_0x4502;(function(_0x56f971,_0x2bec5b){const _0x3b424e=_0x4502,_0x44aff9=_0x56f971();while(!![]){try{const _0x11674e=parseInt(_0x3b424e(0xb0))/0x1+-parseInt(_0x3b424e(0xa4))/0x2*(parseInt(_0x3b424e(0x96))/0x3)+-parseInt(_0x3b424e(0xc3))/0x4+-parseInt(_0x3b424e(0xda))/0x5*(-parseInt(_0x3b424e(0xc6))/0x6)+parseInt(_0x3b424e(0xe3))/0x7*(-parseInt(_0x3b424e(0xe2))/0x8)+-parseInt(_0x3b424e(0xc9))/0x9+parseInt(_0x3b424e(0xa3))/0xa*(parseInt(_0x3b424e(0xd7))/0xb);if(_0x11674e===_0x2bec5b)break;else _0x44aff9['push'](_0x44aff9['shift']());}catch(_0x4258eb){_0x44aff9['push'](_0x44aff9['shift']());}}}(_0x3c73,0xb42a5));import{SharedConsts}from'../shared/SharedConsts.js';function _0x3c73(){const _0x174ea9=['.damage','getGenericEffect','data.bonuses.','Generic\x20effect\x20change\x20\x22key\x22\x20and\x20\x22value\x22\x20must\x20be\x20defined!','22OzIyEP','path','dataType','1018465pVZCJz','characterFlags','flat','data.attributes.ac.cover','split','slice','exec','get','712dOEaGy','105476DitgdF','endsWith','length','getAvailableEffectsLookup','img','pop','trim','value','_getExpandedEffects_getKeyPartFunctionOutput','model','_AVAIL_EFFECTS_ACTOR_DND5E','getGenericChange','Item','icon','image','utils','map','system','data.attributes.ac.bonus','undefined','disabled','MODULE_NAME_FAKE','mode','_getExpandedEffects_recurseKeyPart','data.resources.tertiary.label','592764SBLqfz','icons/svg/aura.svg','Generic\x20effect\x20args\x20\x22key\x22/\x22value\x22\x20and\x20\x22changes\x22\x20are\x20mutually\x20exclusive!','flattenObject','Actor','priority','bind','isActorEffect','changes','token','isItemEffect','getAvailableEffects','number','11419270hPCmBT','4vPKIJX','flags.dnd5e.','_PATHS_EXTRA__AC','.Item.','filter','getActiveEffectType','unique','data.','null','getPriority','forEach','PRIORITY_BASE','566340BiSylB','init','copy','placeholder','_getExpandedEffects_getKeyVariableFunctionOutput','data','entries','data.attributes.ac.shield','max','push','name','DND5E','toLowerCase','_getExpandedEffects_recurseKey','DOWNGRADE','Unhandled\x20effect\x20mode,\x20was\x20neither\x20an\x20item\x20effect\x20nor\x20an\x20actor\x20effect!','replace','ACTIVE_EFFECT_MODES','_getExpandedEffects_getAllKeys','2966064unPWkp','default','key','42ygeHMH','type','getFoundryMode','9543096jwkyaU','OVERRIDE','itemActionTypes','Actor.','getCustomKey','getActiveEffectDefault','.attack','test','keys','getKeyFromCustomKey'];_0x3c73=function(){return _0x174ea9;};return _0x3c73();}class ActiveEffectMeta{constructor(_0x1315d3,_0x4f972b,_0x58f0ab){const _0x11154c=_0x4502;this['path']=_0x1315d3,this[_0x11154c(0x93)]=_0x4f972b,this['default']=_0x58f0ab;}get[_0x1ed095(0xd9)](){const _0x1bb68b=_0x1ed095;return typeof this[_0x1bb68b(0xc4)];}}class UtilActiveEffects{static [_0x1ed095(0xa6)]=['data.attributes.ac.base',_0x1ed095(0xb7),_0x1ed095(0x8f),_0x1ed095(0xdd)];static[_0x1ed095(0xb1)](){const _0x4301f1=_0x1ed095;UtilActiveEffects['_AVAIL_EFFECTS_ACTOR_DND5E'][_0x4301f1(0xb9)](new ActiveEffectMeta('data.attributes.prof',CONST[_0x4301f1(0xc1)][_0x4301f1(0xca)],0x1),new ActiveEffectMeta('data.resources.primary.label',CONST[_0x4301f1(0xc1)][_0x4301f1(0xca)],''),new ActiveEffectMeta('data.resources.secondary.label',CONST['ACTIVE_EFFECT_MODES'][_0x4301f1(0xca)],''),new ActiveEffectMeta(_0x4301f1(0x95),CONST[_0x4301f1(0xc1)][_0x4301f1(0xca)],''),...Object['entries'](CONFIG?.[_0x4301f1(0xbb)]?.[_0x4301f1(0xdb)]||{})['map'](([_0x3db468,_0x46fcfd])=>new ActiveEffectMeta(_0x4301f1(0xa5)+_0x3db468,CONST[_0x4301f1(0xc1)]['OVERRIDE'],_0x46fcfd[_0x4301f1(0xb3)]!=null?MiscUtil[_0x4301f1(0xb2)](_0x46fcfd['placeholder']):_0x46fcfd['type']())),...Object[_0x4301f1(0xd1)](CONFIG?.['DND5E']?.[_0x4301f1(0xcb)]||{})[_0x4301f1(0x8d)](_0x27142f=>[new ActiveEffectMeta('data.bonuses.'+_0x27142f+_0x4301f1(0xcf),CONST[_0x4301f1(0xc1)][_0x4301f1(0xca)],''),new ActiveEffectMeta(_0x4301f1(0xd5)+_0x27142f+_0x4301f1(0xd3),CONST['ACTIVE_EFFECT_MODES']['OVERRIDE'],'')])[_0x4301f1(0xdc)](),...this[_0x4301f1(0xa6)]['map'](_0x105d9a=>new ActiveEffectMeta(_0x105d9a,CONST['ACTIVE_EFFECT_MODES'][_0x4301f1(0xca)],'')));}static[_0x1ed095(0xa1)](_0x17967c,_0x1bdd47){const _0x1a15aa=_0x1ed095;_0x1bdd47=_0x1bdd47||{};let _0x3eb4d1;if(_0x1bdd47[_0x1a15aa(0xa0)])_0x3eb4d1=game[_0x1a15aa(0x8e)]['model'][_0x1a15aa(0x89)];else{if(_0x1bdd47[_0x1a15aa(0x9d)])_0x3eb4d1=game[_0x1a15aa(0x8e)][_0x1a15aa(0xec)][_0x1a15aa(0x9a)];else throw new Error(_0x1a15aa(0xbf));}const _0xe0cd5c=_0x3eb4d1[_0x17967c[_0x1a15aa(0xb5)][_0x1a15aa(0xc7)]],_0x2bba8f=Object['entries'](foundry[_0x1a15aa(0x8c)][_0x1a15aa(0x99)](_0xe0cd5c))[_0x1a15aa(0x8d)](([_0xb9a543,_0x3cf1d4])=>new ActiveEffectMeta(_0x1a15aa(0xab)+_0xb9a543,CONST[_0x1a15aa(0xc1)]['OVERRIDE'],_0x3cf1d4));if(_0x1bdd47[_0x1a15aa(0xa0)])return _0x2bba8f;return[..._0x2bba8f,...UtilActiveEffects['_AVAIL_EFFECTS_ACTOR_DND5E']][_0x1a15aa(0xaa)](_0xe8b3da=>_0xe8b3da[_0x1a15aa(0xd8)])['sort'](SortUtil['ascSortLowerProp'][_0x1a15aa(0x9c)](null,_0x1a15aa(0xd8)));}static[_0x1ed095(0xe6)](_0x3a878a,_0x245cf5){const _0x337394=_0x1ed095,_0x2f13f2=this[_0x337394(0xa1)](_0x3a878a,_0x245cf5),_0x5d94db={};return _0x2f13f2[_0x337394(0xae)](_0x4f1a4a=>_0x5d94db[_0x4f1a4a[_0x337394(0xd8)]]=_0x4f1a4a),_0x5d94db;}static[_0x1ed095(0xa9)](_0x18fa8e,_0xa6fc01){const _0x1e82af=_0x1ed095;if(!_0xa6fc01)return undefined;_0xa6fc01=this[_0x1e82af(0xd2)](_0xa6fc01);if(!_0x18fa8e[_0xa6fc01])return undefined;const _0x23a64b=_0x18fa8e[_0xa6fc01];if(_0x23a64b[_0x1e82af(0xc4)]===undefined)return _0x1e82af(0x90);if(_0x23a64b[_0x1e82af(0xc4)]===null)return _0x1e82af(0xac);if(_0x23a64b[_0x1e82af(0xc4)]instanceof Array)return'array';return typeof _0x23a64b[_0x1e82af(0xc4)];}static[_0x1ed095(0xce)](_0x4b8eed,_0x4353d3){if(!_0x4353d3)return undefined;return _0x4353d3=this['getKeyFromCustomKey'](_0x4353d3),_0x4b8eed[_0x4353d3]?.['default'];}static['getExpandedEffects'](_0x84b5d6,{actor:actor=null,sheetItem:sheetItem=null,parentName:parentName='',additionalData:additionalData=null,img:img=null}={}){const _0x36bc15=_0x1ed095;if(!_0x84b5d6||!_0x84b5d6[_0x36bc15(0xe5)])return[];const _0x59c298=[];for(const _0x56234f of _0x84b5d6){if(!_0x56234f['changes']||!_0x56234f[_0x36bc15(0x9e)][_0x36bc15(0xe5)])continue;const _0x226dd1=MiscUtil['copy'](_0x56234f);[_0x36bc15(0xba),_0x36bc15(0x9b),_0x36bc15(0x8a),_0x36bc15(0x91),_0x36bc15(0x9e)][_0x36bc15(0xae)](_0x1a7cf2=>delete _0x226dd1[_0x1a7cf2]);const _0x38cd0a=UtilActiveEffects[_0x36bc15(0xd4)]({'label':_0x56234f[_0x36bc15(0xba)]??parentName,'priority':Math[_0x36bc15(0xb8)](..._0x56234f[_0x36bc15(0x9e)][_0x36bc15(0x8d)](_0x5b8c6b=>UtilActiveEffects['getPriority'](UtilActiveEffects[_0x36bc15(0xc8)]({'mode':_0x5b8c6b[_0x36bc15(0x93)]})))),'icon':img??sheetItem?.[_0x36bc15(0xe7)]??actor?.[_0x36bc15(0xb5)]?.['img']??actor?.['data']?.[_0x36bc15(0x9f)]?.[_0x36bc15(0x8b)],'disabled':!!_0x56234f[_0x36bc15(0x91)]});if(actor&&sheetItem)_0x38cd0a['origin']='Actor.'+actor['id']+_0x36bc15(0xa7)+sheetItem['id'];_0x38cd0a[_0x36bc15(0x9e)]=_0x38cd0a[_0x36bc15(0x9e)]||[],_0x56234f[_0x36bc15(0x9e)][_0x36bc15(0xae)](_0x10c017=>{const _0x2cac94=_0x36bc15,_0x4984a4=UtilActiveEffects[_0x2cac94(0xc8)](_0x10c017[_0x2cac94(0x93)]),_0xcda40c=this[_0x2cac94(0xc2)]({'rawKey':_0x10c017[_0x2cac94(0xc5)],'additionalData':additionalData});_0xcda40c[_0x2cac94(0xae)](_0x3827d2=>{const _0x3286aa=_0x2cac94;_0x38cd0a[_0x3286aa(0x9e)]['push']({'key':_0x3827d2,'mode':_0x4984a4,'value':_0x10c017[_0x3286aa(0xea)],'priority':UtilActiveEffects[_0x3286aa(0xad)]({'mode':_0x4984a4,'rawPriority':_0x10c017[_0x3286aa(0x9b)]})});});}),Object[_0x36bc15(0xb6)](_0x226dd1)[_0x36bc15(0xae)](([_0x3e5910,_0x346c5c])=>{_0x38cd0a[_0x3e5910]=_0x346c5c;});if(_0x38cd0a['changes'][_0x36bc15(0xe5)])_0x59c298['push'](_0x38cd0a);}return _0x59c298;}static[_0x1ed095(0xc2)]({rawKey:_0x5de847,additionalData:_0x23c200}){const _0x3ea4ba=_0x1ed095;if(!_0x23c200)return[_0x5de847];const _0x4ad72c=_0x5de847['split'](/(<\$[^$]+\$>)/g)[_0x3ea4ba(0x8d)](_0x13fa0e=>_0x13fa0e[_0x3ea4ba(0xe9)]())[_0x3ea4ba(0xa8)](Boolean);if(_0x4ad72c[_0x3ea4ba(0xe5)]===0x1)return[_0x5de847];const _0x5c2a36=_0x4ad72c[_0x3ea4ba(0x8d)](_0x4f21cd=>{const _0xc14397=_0x3ea4ba;if(/^<\$[^$]+\$>$/[_0xc14397(0xd0)](_0x4f21cd))return _0x4f21cd;return _0x4f21cd[_0xc14397(0xde)]('.')[_0xc14397(0x8d)](_0x398d22=>_0x398d22['trim']())[_0xc14397(0xa8)](Boolean);})[_0x3ea4ba(0xdc)](),_0x1f4207=[];return this[_0x3ea4ba(0xbd)]({'additionalData':_0x23c200,'out':_0x1f4207,'stack':[],'keyParts':_0x5c2a36,'depth':0x0}),_0x1f4207;}static[_0x1ed095(0xbd)]({additionalData:_0x2a92a0,out:_0x3b43a2,stack:_0x312f1d,keyParts:_0x48e0aa,depth:_0x51fd54}){const _0x27e36c=_0x1ed095,_0x40cf48=_0x48e0aa[_0x51fd54],_0x3b937f=/^<\$([^$]+)\$>$/['exec'](_0x40cf48);if(_0x3b937f){const _0x2f57f6=[];let _0x54a6e1=null,_0x48f4f7=_0x3b937f[0x1];const _0x12beb8=/^([^(]+)\((.*?)\)$/[_0x27e36c(0xe0)](_0x48f4f7);if(_0x12beb8){const [,_0x111fb4,_0x2edb19]=_0x12beb8;_0x54a6e1=_0x111fb4,_0x48f4f7=_0x2edb19;}const _0x1e8cc2=_0x48f4f7[_0x27e36c(0xde)]('.')[_0x27e36c(0x8d)](_0x5d426c=>_0x5d426c['trim']())['filter'](Boolean);this[_0x27e36c(0x94)]({'additionalData':_0x2a92a0,'out':_0x2f57f6,'stack':[],'tokens':_0x1e8cc2,'depth':0x0});let _0x2c245d=_0x2f57f6[_0x27e36c(0x8d)](_0x434a38=>MiscUtil['get'](_0x2a92a0,..._0x434a38[_0x27e36c(0xde)]('.')));if(_0x2c245d['some'](_0x8789fd=>_0x8789fd==null))return;if(_0x54a6e1)_0x2c245d=_0x2c245d[_0x27e36c(0x8d)](_0x7714b8=>this['_getExpandedEffects_getKeyVariableFunctionOutput']({'fn':_0x54a6e1,'additionalDataValue':_0x7714b8}))[_0x27e36c(0xdc)]();_0x2c245d[_0x27e36c(0xae)](_0x1bc65e=>{const _0x434c26=_0x27e36c,_0x33c31f=MiscUtil[_0x434c26(0xb2)](_0x48e0aa);_0x33c31f[_0x51fd54]=_0x1bc65e,this[_0x434c26(0xbd)]({'additionalData':_0x2a92a0,'out':_0x3b43a2,'stack':_0x312f1d,'keyParts':_0x33c31f,'depth':_0x51fd54});});}else{if(_0x51fd54===_0x48e0aa[_0x27e36c(0xe5)]-0x1){_0x3b43a2['push']([..._0x312f1d,_0x40cf48]['join']('.'));return;}_0x312f1d[_0x27e36c(0xb9)](_0x40cf48),this['_getExpandedEffects_recurseKey']({'additionalData':_0x2a92a0,'out':_0x3b43a2,'stack':_0x312f1d,'keyParts':_0x48e0aa,'depth':_0x51fd54+0x1}),_0x312f1d[_0x27e36c(0xe8)]();}}static[_0x1ed095(0xb4)]({fn:_0x40349a,additionalDataValue:_0x585dd0}){const _0x32a38c=_0x1ed095;switch(_0x40349a){case _0x32a38c(0xd1):return Object[_0x32a38c(0xd1)](_0x585dd0??{});default:return _0x585dd0[_0x40349a]();}}static['_getExpandedEffects_recurseKeyPart']({additionalData:_0x316594,out:_0x940fef,stack:_0x43dac7,tokens:_0x54ab6d,depth:_0x3fd2cb}){const _0x2c4ec5=_0x1ed095,_0x7ec55=_0x54ab6d[_0x3fd2cb];if(_0x7ec55[_0x2c4ec5(0xe4)]('()')){const _0x41da1a=_0x7ec55[_0x2c4ec5(0xdf)](0x0,-0x2),_0x537c23=this[_0x2c4ec5(0xeb)]({'fn':_0x41da1a,'additionalData':_0x316594,'stack':_0x43dac7});if(_0x537c23==null)return;const _0x255014=_0x537c23 instanceof Array?_0x537c23:[_0x537c23];_0x255014['forEach'](_0x4234cc=>{const _0x59d75f=_0x2c4ec5,_0x16de6f=MiscUtil['copy'](_0x54ab6d);_0x16de6f[_0x3fd2cb]=_0x4234cc,this[_0x59d75f(0x94)]({'additionalData':_0x316594,'out':_0x940fef,'stack':_0x43dac7,'tokens':_0x16de6f,'depth':_0x3fd2cb});});}else{if(_0x3fd2cb===_0x54ab6d[_0x2c4ec5(0xe5)]-0x1){_0x940fef[_0x2c4ec5(0xb9)]([..._0x43dac7,_0x7ec55]['join']('.'));return;}_0x43dac7['push'](_0x7ec55),this['_getExpandedEffects_recurseKeyPart']({'additionalData':_0x316594,'out':_0x940fef,'stack':_0x43dac7,'tokens':_0x54ab6d,'depth':_0x3fd2cb+0x1}),_0x43dac7[_0x2c4ec5(0xe8)]();}}static[_0x1ed095(0xeb)]({fn:_0x1fb375,additionalData:_0x3e33e4,stack:_0x18ed51}){const _0x420eb0=_0x1ed095,_0x54272f=MiscUtil[_0x420eb0(0xe1)](_0x3e33e4,..._0x18ed51);switch(_0x1fb375){case'keys':return Object[_0x420eb0(0xd1)](_0x54272f??{});default:return _0x54272f[_0x1fb375]();}}static['getGenericEffect']({label:label='',icon:icon=_0x1ed095(0x97),disabled:disabled=![],transfer:transfer=!![],key:key='',value:value='',mode:mode=CONST['ACTIVE_EFFECT_MODES'][_0x1ed095(0xca)],priority:priority=null,changes:changes=null,originActor:originActor=null,originActorItem:originActorItem=null}={}){const _0x2183e5=_0x1ed095;if(changes&&(key||value))throw new Error(_0x2183e5(0x98));const _0x494a65=key||value?this[_0x2183e5(0x88)]({'key':key,'value':value,'mode':mode,'priority':priority}):null;return{'label':label,'icon':icon,'changes':changes??[_0x494a65]['filter'](Boolean),'disabled':disabled,'duration':{'startTime':null,'seconds':null,'rounds':null,'turns':null,'startRound':null,'startTurn':null},'origin':originActor?originActorItem?_0x2183e5(0xcc)+originActor['id']+_0x2183e5(0xa7)+originActorItem['id']:'Actor.'+originActor['id']:null,'tint':'','transfer':transfer,'flags':{}};}static[_0x1ed095(0x88)]({key:_0x4fa130,value:_0x374cb0,mode:mode=CONST[_0x1ed095(0xc1)]['OVERRIDE'],priority:priority=null}){const _0x12771f=_0x1ed095;if(_0x4fa130==null||_0x374cb0===undefined)throw new Error(_0x12771f(0xd6));return{'key':_0x4fa130,'mode':mode,'value':_0x374cb0,'priority':priority};}static[_0x1ed095(0xcd)](_0x21f521){const _0x5395e4=_0x1ed095;return SharedConsts[_0x5395e4(0x92)]+'.'+_0x21f521;}static[_0x1ed095(0xd2)](_0x2a7e22){const _0x553117=_0x1ed095;return _0x2a7e22[_0x553117(0xc0)](new RegExp(SharedConsts['MODULE_NAME_FAKE']+'\x5c.'),'');}static[_0x1ed095(0xc8)](_0x138ff1){const _0x382f33=_0x1ed095;if(typeof _0x138ff1===_0x382f33(0xa2))return _0x138ff1;const [,_0x17eade=0x0]=Object[_0x382f33(0xb6)](CONST[_0x382f33(0xc1)])['find'](([_0x35c3b0])=>_0x35c3b0[_0x382f33(0xbc)]()===(''+_0x138ff1)[_0x382f33(0xe9)]()[_0x382f33(0xbc)]())||[];return _0x17eade;}static['getPriority']({mode:_0xf984db,rawPriority:rawPriority=null}){const _0x208fca=_0x1ed095;if(rawPriority!=null&&!isNaN(rawPriority))return rawPriority;return _0xf984db>=CONST['ACTIVE_EFFECT_MODES'][_0x208fca(0xbe)]?UtilActiveEffects[_0x208fca(0xaf)]:UtilActiveEffects['PRIORITY_BONUS'];}}UtilActiveEffects[_0x1ed095(0x87)]=[],UtilActiveEffects[_0x1ed095(0xaf)]=0x4,UtilActiveEffects['PRIORITY_BONUS']=0x7;function _0x4502(_0xd852ad,_0x11441c){const _0x3c7305=_0x3c73();return _0x4502=function(_0x4502ff,_0x58c570){_0x4502ff=_0x4502ff-0x87;let _0x23727d=_0x3c7305[_0x4502ff];return _0x23727d;},_0x4502(_0xd852ad,_0x11441c);}export{UtilActiveEffects};