const _0x2d8ae0=_0xdb48;(function(_0x1ad9a3,_0x2873d7){const _0x27b373=_0xdb48,_0x29ba32=_0x1ad9a3();while(!![]){try{const _0x26d8b4=-parseInt(_0x27b373(0x155))/0x1+parseInt(_0x27b373(0x167))/0x2*(-parseInt(_0x27b373(0x173))/0x3)+-parseInt(_0x27b373(0x14e))/0x4+parseInt(_0x27b373(0x166))/0x5+parseInt(_0x27b373(0x171))/0x6*(-parseInt(_0x27b373(0x174))/0x7)+-parseInt(_0x27b373(0x15e))/0x8*(parseInt(_0x27b373(0x15f))/0x9)+parseInt(_0x27b373(0x14f))/0xa*(parseInt(_0x27b373(0x159))/0xb);if(_0x26d8b4===_0x2873d7)break;else _0x29ba32['push'](_0x29ba32['shift']());}catch(_0x45b2c1){_0x29ba32['push'](_0x29ba32['shift']());}}}(_0x45c9,0x6764f));function _0x45c9(){const _0x2dd934=['diff','\x20with\x20id\x20\x22','_source','pUpdateDocument','set','utils','get','Non-diff\x20and\x20non-recursive\x20temporary\x20document\x20updates\x20are\x20unsupported!','raw','12mTmmrk','ImportedEmbeddedDocument','454188VkzOFB','732704LZsvfJ','pCreateEmbeddedDocuments','createEmbeddedDocuments','create','_id','2348644sluAgn','22214470onAmxb','find','randomID','\x22\x20not\x20found\x20in\x20parent\x20document!','mergeObject','Update\x20had\x20no\x20\x22_id\x22!','101624BzbKAz','Number\x20of\x20returned\x20items\x20did\x20not\x20match\x20number\x20of\x20input\x20items!','name','isTempDocument','11tITjgh','update','collection','recursive','embed','696GhYjMI','69543OJKfvl','length','metadata','forEach','effects','data','map','1133110pVvVyX','6ZkhrWr'];_0x45c9=function(){return _0x2dd934;};return _0x45c9();}function _0xdb48(_0x4a3b1e,_0x27582b){const _0x45c96e=_0x45c9();return _0xdb48=function(_0xdb4851,_0x2de27f){_0xdb4851=_0xdb4851-0x14d;let _0x9981ca=_0x45c96e[_0xdb4851];return _0x9981ca;},_0xdb48(_0x4a3b1e,_0x27582b);}class UtilDocuments{static async[_0x2d8ae0(0x16b)](_0x5e3075,_0x22b7de,{isTemporary:isTemporary=![]}={},_0x18f540){const _0x28eaac=_0x2d8ae0;if(this['isTempDocument']({'doc':_0x5e3075,'isTemporary':isTemporary})){if(_0x18f540?.[_0x28eaac(0x168)]===![]||_0x18f540?.[_0x28eaac(0x15c)]===![])throw new Error(_0x28eaac(0x16f));return foundry[_0x28eaac(0x16d)][_0x28eaac(0x153)](_0x5e3075[_0x28eaac(0x164)],_0x22b7de),_0x5e3075;}return _0x5e3075[_0x28eaac(0x15a)](_0x22b7de,_0x18f540);}static[_0x2d8ae0(0x158)]({isTemporary:_0xc9616d,doc:_0x55c4b7}){return _0xc9616d||_0x55c4b7['id']==null;}static async[_0x2d8ae0(0x175)](_0x6e7f93,_0x14fa45,{isTemporary:isTemporary=![],propData:propData=null,ClsEmbed:_0x300de0,embedName:embedName=null},_0x26160d={}){const _0x3c8b50=_0x2d8ae0;if(!_0x14fa45?.[_0x3c8b50(0x160)])return[];propData=propData||_0x300de0[_0x3c8b50(0x161)][_0x3c8b50(0x15b)],embedName=embedName||_0x300de0['name'];let _0x21304e;this[_0x3c8b50(0x158)]({'doc':_0x6e7f93,'isTemporary':isTemporary})?(_0x21304e=await _0x300de0[_0x3c8b50(0x177)](_0x14fa45,{'temporary':!![]}),_0x21304e[_0x3c8b50(0x162)](_0x38ede6=>{const _0x3a3a07=_0x3c8b50;_0x38ede6[_0x3a3a07(0x164)][_0x3a3a07(0x14d)]=_0x38ede6[_0x3a3a07(0x164)][_0x3a3a07(0x14d)]||foundry['utils'][_0x3a3a07(0x151)](),_0x38ede6[_0x3a3a07(0x164)][_0x3a3a07(0x16a)][_0x3a3a07(0x14d)]=_0x38ede6[_0x3a3a07(0x164)]['_source'][_0x3a3a07(0x14d)]||_0x38ede6['data'][_0x3a3a07(0x14d)],_0x6e7f93[propData][_0x3a3a07(0x16c)](_0x38ede6['id'],_0x38ede6),(_0x38ede6[_0x3a3a07(0x163)]||[])[_0x3a3a07(0x162)](_0x58bfbb=>{const _0x349509=_0x3a3a07;_0x58bfbb['data'][_0x349509(0x14d)]=_0x58bfbb['data']['_id']||foundry[_0x349509(0x16d)]['randomID'](),_0x58bfbb[_0x349509(0x164)][_0x349509(0x16a)][_0x349509(0x14d)]=_0x58bfbb[_0x349509(0x164)][_0x349509(0x16a)]['_id']||_0x58bfbb['data'][_0x349509(0x14d)],_0x6e7f93[_0x349509(0x163)]['set'](_0x58bfbb['id'],_0x58bfbb);});})):_0x21304e=await _0x6e7f93[_0x3c8b50(0x176)](embedName,_0x14fa45,{..._0x26160d});if(_0x14fa45['length']!==_0x21304e[_0x3c8b50(0x160)])throw new Error(_0x3c8b50(0x156));return _0x14fa45['map']((_0x2dbe4c,_0x26ac23)=>new UtilDocuments[(_0x3c8b50(0x172))]({'raw':_0x2dbe4c,'document':_0x21304e[_0x26ac23]}));}static async['pUpdateEmbeddedDocuments'](_0x561ddd,_0x2d3dff,{isTemporary:isTemporary=![],propData:propData=null,ClsEmbed:_0x1026db,embedName:embedName=null},_0x5245d9={}){const _0x4b4eca=_0x2d8ae0;if(!_0x2d3dff?.[_0x4b4eca(0x160)])return[];propData=propData||_0x1026db[_0x4b4eca(0x161)][_0x4b4eca(0x15b)],embedName=embedName||_0x1026db[_0x4b4eca(0x157)];let _0x1ef175;if(this[_0x4b4eca(0x158)]({'doc':_0x561ddd,'isTemporary':isTemporary})){const _0x1fb1f1=_0x2d3dff[_0x4b4eca(0x165)](_0x1a4c1a=>{const _0x22abbc=_0x4b4eca;if(!_0x1a4c1a[_0x22abbc(0x14d)])throw new Error(_0x22abbc(0x154));const _0x55fce2=_0x561ddd[propData]['get'](_0x1a4c1a[_0x22abbc(0x14d)]);if(!_0x55fce2)throw new Error(embedName+_0x22abbc(0x169)+_0x1a4c1a[_0x22abbc(0x14d)]+_0x22abbc(0x152));return{'update':_0x1a4c1a,'embed':_0x55fce2};});_0x1fb1f1[_0x4b4eca(0x162)](({update:_0x2e4199,embed:_0x588baf})=>{const _0x547636=_0x4b4eca;foundry[_0x547636(0x16d)][_0x547636(0x153)](_0x588baf[_0x547636(0x164)],MiscUtil['copy'](_0x2e4199)),foundry[_0x547636(0x16d)][_0x547636(0x153)](_0x588baf[_0x547636(0x164)]['_source'],MiscUtil['copy'](_0x2e4199));}),_0x1ef175=_0x1fb1f1[_0x4b4eca(0x165)](_0x5d22b2=>_0x5d22b2[_0x4b4eca(0x15d)]);}else{const _0x3f5ec2=await _0x561ddd['updateEmbeddedDocuments'](embedName,_0x2d3dff,{..._0x5245d9});_0x2d3dff['length']===_0x3f5ec2[_0x4b4eca(0x160)]?_0x1ef175=_0x3f5ec2:_0x1ef175=_0x2d3dff[_0x4b4eca(0x165)](({_id:_0x44c0fa})=>_0x2d3dff[_0x4b4eca(0x150)](_0x8b066c=>_0x8b066c['id']===_0x44c0fa)||_0x561ddd[propData][_0x4b4eca(0x16e)](_0x44c0fa));}if(_0x2d3dff[_0x4b4eca(0x160)]!==_0x1ef175[_0x4b4eca(0x160)])throw new Error('Number\x20of\x20returned\x20items\x20did\x20not\x20match\x20number\x20of\x20input\x20items!');return _0x2d3dff[_0x4b4eca(0x165)]((_0x10e909,_0x4638a0)=>new UtilDocuments[(_0x4b4eca(0x172))]({'raw':_0x10e909,'document':_0x1ef175[_0x4638a0],'isUpdate':!![]}));}}UtilDocuments['ImportedEmbeddedDocument']=class{constructor({raw:_0x30bf89,document:_0x4d1f54,isUpdate:isUpdate=![]}){const _0x56cadb=_0x2d8ae0;this[_0x56cadb(0x170)]=_0x30bf89,this['document']=_0x4d1f54,this['isUpdate']=isUpdate;}};export{UtilDocuments};